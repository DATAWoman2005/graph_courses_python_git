{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Connected to .venv (Python 3.12.6)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a4d2b8e0-9fa1-4b6b-9856-44f5d280988e",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "pd.options.mode.copy_on_write = True"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c5804841-e943-44cd-8e89-9c33c5aaf998",
   "metadata": {},
   "outputs": [
    {
     "ename": "SyntaxError",
     "evalue": "invalid syntax (<ipython-input-2-1edc7a05d703>, line 1)",
     "output_type": "error",
     "traceback": [
      "\u001b[1;36m  Cell \u001b[1;32mIn[2], line 1\u001b[1;36m\u001b[0m\n\u001b[1;33m    counties pd.read_csv(\"intro_to_quarto/data/us_counties_data.csv\")\u001b[0m\n\u001b[1;37m             ^\u001b[0m\n\u001b[1;31mSyntaxError\u001b[0m\u001b[1;31m:\u001b[0m invalid syntax\n"
     ]
    }
   ],
   "source": [
    "counties pd.read_csv(\"intro_to_quarto/data/us_counties_data.csv\")\n",
    "counties"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "998b332c-446e-4a04-a81c-7d4b1fde718a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>state</th>\n",
       "      <th>county</th>\n",
       "      <th>pop_20</th>\n",
       "      <th>area_sq_miles</th>\n",
       "      <th>hh_inc_21</th>\n",
       "      <th>econ_type</th>\n",
       "      <th>unemp_20</th>\n",
       "      <th>foreign_born_num</th>\n",
       "      <th>pop_change_2010_2020</th>\n",
       "      <th>pct_emp_change_2010_2021</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AL</td>\n",
       "      <td>Autauga, AL</td>\n",
       "      <td>58877.0</td>\n",
       "      <td>594.456107</td>\n",
       "      <td>66444.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>5.4</td>\n",
       "      <td>1241.0</td>\n",
       "      <td>7.758700</td>\n",
       "      <td>9.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AL</td>\n",
       "      <td>Baldwin, AL</td>\n",
       "      <td>233140.0</td>\n",
       "      <td>1589.836014</td>\n",
       "      <td>65658.0</td>\n",
       "      <td>Recreation</td>\n",
       "      <td>6.2</td>\n",
       "      <td>7938.0</td>\n",
       "      <td>27.159356</td>\n",
       "      <td>28.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AL</td>\n",
       "      <td>Barbour, AL</td>\n",
       "      <td>25180.0</td>\n",
       "      <td>885.008019</td>\n",
       "      <td>38649.0</td>\n",
       "      <td>Manufacturing</td>\n",
       "      <td>7.8</td>\n",
       "      <td>659.0</td>\n",
       "      <td>-8.136359</td>\n",
       "      <td>-13.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>AL</td>\n",
       "      <td>Bibb, AL</td>\n",
       "      <td>22223.0</td>\n",
       "      <td>622.469570</td>\n",
       "      <td>48454.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>7.3</td>\n",
       "      <td>245.0</td>\n",
       "      <td>-2.714379</td>\n",
       "      <td>4.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AL</td>\n",
       "      <td>Blount, AL</td>\n",
       "      <td>59081.0</td>\n",
       "      <td>644.890667</td>\n",
       "      <td>56894.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>4.6</td>\n",
       "      <td>2650.0</td>\n",
       "      <td>3.161090</td>\n",
       "      <td>9.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3221</th>\n",
       "      <td>PR</td>\n",
       "      <td>Vega Baja, PR</td>\n",
       "      <td>54322.0</td>\n",
       "      <td>45.847734</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-8.796219</td>\n",
       "      <td>-0.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3222</th>\n",
       "      <td>PR</td>\n",
       "      <td>Vieques, PR</td>\n",
       "      <td>8242.0</td>\n",
       "      <td>50.788416</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-11.310612</td>\n",
       "      <td>-12.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3223</th>\n",
       "      <td>PR</td>\n",
       "      <td>Villalba, PR</td>\n",
       "      <td>22044.0</td>\n",
       "      <td>35.636678</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-15.264833</td>\n",
       "      <td>-1.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3224</th>\n",
       "      <td>PR</td>\n",
       "      <td>Yabucoa, PR</td>\n",
       "      <td>30364.0</td>\n",
       "      <td>55.214614</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-19.807069</td>\n",
       "      <td>0.1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3225</th>\n",
       "      <td>PR</td>\n",
       "      <td>Yauco, PR</td>\n",
       "      <td>34062.0</td>\n",
       "      <td>67.711484</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-18.721309</td>\n",
       "      <td>-5.3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3226 rows Ã— 10 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     state         county    pop_20  area_sq_miles  hh_inc_21       econ_type  \\\n",
       "0       AL    Autauga, AL   58877.0     594.456107    66444.0  Nonspecialized   \n",
       "1       AL    Baldwin, AL  233140.0    1589.836014    65658.0      Recreation   \n",
       "2       AL    Barbour, AL   25180.0     885.008019    38649.0   Manufacturing   \n",
       "3       AL       Bibb, AL   22223.0     622.469570    48454.0  Nonspecialized   \n",
       "4       AL     Blount, AL   59081.0     644.890667    56894.0  Nonspecialized   \n",
       "...    ...            ...       ...            ...        ...             ...   \n",
       "3221    PR  Vega Baja, PR   54322.0      45.847734        NaN             NaN   \n",
       "3222    PR    Vieques, PR    8242.0      50.788416        NaN             NaN   \n",
       "3223    PR   Villalba, PR   22044.0      35.636678        NaN             NaN   \n",
       "3224    PR    Yabucoa, PR   30364.0      55.214614        NaN             NaN   \n",
       "3225    PR      Yauco, PR   34062.0      67.711484        NaN             NaN   \n",
       "\n",
       "      unemp_20  foreign_born_num  pop_change_2010_2020  \\\n",
       "0          5.4            1241.0              7.758700   \n",
       "1          6.2            7938.0             27.159356   \n",
       "2          7.8             659.0             -8.136359   \n",
       "3          7.3             245.0             -2.714379   \n",
       "4          4.6            2650.0              3.161090   \n",
       "...        ...               ...                   ...   \n",
       "3221       NaN               NaN             -8.796219   \n",
       "3222       NaN               NaN            -11.310612   \n",
       "3223       NaN               NaN            -15.264833   \n",
       "3224       NaN               NaN            -19.807069   \n",
       "3225       NaN               NaN            -18.721309   \n",
       "\n",
       "      pct_emp_change_2010_2021  \n",
       "0                          9.0  \n",
       "1                         28.2  \n",
       "2                        -13.9  \n",
       "3                          4.2  \n",
       "4                          9.0  \n",
       "...                        ...  \n",
       "3221                      -0.9  \n",
       "3222                     -12.0  \n",
       "3223                      -1.2  \n",
       "3224                       0.1  \n",
       "3225                      -5.3  \n",
       "\n",
       "[3226 rows x 10 columns]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "counties = pd.read_csv(\"intro_to_quarto/data/us_counties_data.csv\")\n",
    "counties"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fd5a79f1-6131-4a16-9b42-11b70151cda9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>state</th>\n",
       "      <th>county</th>\n",
       "      <th>pop_20</th>\n",
       "      <th>area_sq_miles</th>\n",
       "      <th>hh_inc_21</th>\n",
       "      <th>econ_type</th>\n",
       "      <th>unemp_20</th>\n",
       "      <th>foreign_born_num</th>\n",
       "      <th>pop_change_2010_2020</th>\n",
       "      <th>pct_emp_change_2010_2021</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AL</td>\n",
       "      <td>Autauga, AL</td>\n",
       "      <td>58877.0</td>\n",
       "      <td>594.456107</td>\n",
       "      <td>66444.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>5.4</td>\n",
       "      <td>1241.0</td>\n",
       "      <td>7.758700</td>\n",
       "      <td>9.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AL</td>\n",
       "      <td>Baldwin, AL</td>\n",
       "      <td>233140.0</td>\n",
       "      <td>1589.836014</td>\n",
       "      <td>65658.0</td>\n",
       "      <td>Recreation</td>\n",
       "      <td>6.2</td>\n",
       "      <td>7938.0</td>\n",
       "      <td>27.159356</td>\n",
       "      <td>28.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AL</td>\n",
       "      <td>Barbour, AL</td>\n",
       "      <td>25180.0</td>\n",
       "      <td>885.008019</td>\n",
       "      <td>38649.0</td>\n",
       "      <td>Manufacturing</td>\n",
       "      <td>7.8</td>\n",
       "      <td>659.0</td>\n",
       "      <td>-8.136359</td>\n",
       "      <td>-13.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>AL</td>\n",
       "      <td>Bibb, AL</td>\n",
       "      <td>22223.0</td>\n",
       "      <td>622.469570</td>\n",
       "      <td>48454.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>7.3</td>\n",
       "      <td>245.0</td>\n",
       "      <td>-2.714379</td>\n",
       "      <td>4.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AL</td>\n",
       "      <td>Blount, AL</td>\n",
       "      <td>59081.0</td>\n",
       "      <td>644.890667</td>\n",
       "      <td>56894.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>4.6</td>\n",
       "      <td>2650.0</td>\n",
       "      <td>3.161090</td>\n",
       "      <td>9.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3221</th>\n",
       "      <td>PR</td>\n",
       "      <td>Vega Baja, PR</td>\n",
       "      <td>54322.0</td>\n",
       "      <td>45.847734</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-8.796219</td>\n",
       "      <td>-0.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3222</th>\n",
       "      <td>PR</td>\n",
       "      <td>Vieques, PR</td>\n",
       "      <td>8242.0</td>\n",
       "      <td>50.788416</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-11.310612</td>\n",
       "      <td>-12.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3223</th>\n",
       "      <td>PR</td>\n",
       "      <td>Villalba, PR</td>\n",
       "      <td>22044.0</td>\n",
       "      <td>35.636678</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-15.264833</td>\n",
       "      <td>-1.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3224</th>\n",
       "      <td>PR</td>\n",
       "      <td>Yabucoa, PR</td>\n",
       "      <td>30364.0</td>\n",
       "      <td>55.214614</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-19.807069</td>\n",
       "      <td>0.1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3225</th>\n",
       "      <td>PR</td>\n",
       "      <td>Yauco, PR</td>\n",
       "      <td>34062.0</td>\n",
       "      <td>67.711484</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-18.721309</td>\n",
       "      <td>-5.3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3226 rows Ã— 10 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     state         county    pop_20  area_sq_miles  hh_inc_21       econ_type  \\\n",
       "0       AL    Autauga, AL   58877.0     594.456107    66444.0  Nonspecialized   \n",
       "1       AL    Baldwin, AL  233140.0    1589.836014    65658.0      Recreation   \n",
       "2       AL    Barbour, AL   25180.0     885.008019    38649.0   Manufacturing   \n",
       "3       AL       Bibb, AL   22223.0     622.469570    48454.0  Nonspecialized   \n",
       "4       AL     Blount, AL   59081.0     644.890667    56894.0  Nonspecialized   \n",
       "...    ...            ...       ...            ...        ...             ...   \n",
       "3221    PR  Vega Baja, PR   54322.0      45.847734        NaN             NaN   \n",
       "3222    PR    Vieques, PR    8242.0      50.788416        NaN             NaN   \n",
       "3223    PR   Villalba, PR   22044.0      35.636678        NaN             NaN   \n",
       "3224    PR    Yabucoa, PR   30364.0      55.214614        NaN             NaN   \n",
       "3225    PR      Yauco, PR   34062.0      67.711484        NaN             NaN   \n",
       "\n",
       "      unemp_20  foreign_born_num  pop_change_2010_2020  \\\n",
       "0          5.4            1241.0              7.758700   \n",
       "1          6.2            7938.0             27.159356   \n",
       "2          7.8             659.0             -8.136359   \n",
       "3          7.3             245.0             -2.714379   \n",
       "4          4.6            2650.0              3.161090   \n",
       "...        ...               ...                   ...   \n",
       "3221       NaN               NaN             -8.796219   \n",
       "3222       NaN               NaN            -11.310612   \n",
       "3223       NaN               NaN            -15.264833   \n",
       "3224       NaN               NaN            -19.807069   \n",
       "3225       NaN               NaN            -18.721309   \n",
       "\n",
       "      pct_emp_change_2010_2021  \n",
       "0                          9.0  \n",
       "1                         28.2  \n",
       "2                        -13.9  \n",
       "3                          4.2  \n",
       "4                          9.0  \n",
       "...                        ...  \n",
       "3221                      -0.9  \n",
       "3222                     -12.0  \n",
       "3223                      -1.2  \n",
       "3224                       0.1  \n",
       "3225                      -5.3  \n",
       "\n",
       "[3226 rows x 10 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "pd.options.mode.copy_on_write = True\n",
    "\n",
    "counties = pd.read_csv(\"intro_to_quarto/data/us_counties_data.csv\")\n",
    "counties"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9a59e158-5b0d-40e0-89ca-d64667727abf",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>area_sq_miles</th>\n",
       "      <th>pop_20</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Autauga, AL</td>\n",
       "      <td>594.456107</td>\n",
       "      <td>58877.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Baldwin, AL</td>\n",
       "      <td>1589.836014</td>\n",
       "      <td>233140.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Barbour, AL</td>\n",
       "      <td>885.008019</td>\n",
       "      <td>25180.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bibb, AL</td>\n",
       "      <td>622.469570</td>\n",
       "      <td>22223.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Blount, AL</td>\n",
       "      <td>644.890667</td>\n",
       "      <td>59081.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3221</th>\n",
       "      <td>Vega Baja, PR</td>\n",
       "      <td>45.847734</td>\n",
       "      <td>54322.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3222</th>\n",
       "      <td>Vieques, PR</td>\n",
       "      <td>50.788416</td>\n",
       "      <td>8242.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3223</th>\n",
       "      <td>Villalba, PR</td>\n",
       "      <td>35.636678</td>\n",
       "      <td>22044.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3224</th>\n",
       "      <td>Yabucoa, PR</td>\n",
       "      <td>55.214614</td>\n",
       "      <td>30364.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3225</th>\n",
       "      <td>Yauco, PR</td>\n",
       "      <td>67.711484</td>\n",
       "      <td>34062.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3226 rows Ã— 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             county  area_sq_miles    pop_20\n",
       "0       Autauga, AL     594.456107   58877.0\n",
       "1       Baldwin, AL    1589.836014  233140.0\n",
       "2       Barbour, AL     885.008019   25180.0\n",
       "3          Bibb, AL     622.469570   22223.0\n",
       "4        Blount, AL     644.890667   59081.0\n",
       "...             ...            ...       ...\n",
       "3221  Vega Baja, PR      45.847734   54322.0\n",
       "3222    Vieques, PR      50.788416    8242.0\n",
       "3223   Villalba, PR      35.636678   22044.0\n",
       "3224    Yabucoa, PR      55.214614   30364.0\n",
       "3225      Yauco, PR      67.711484   34062.0\n",
       "\n",
       "[3226 rows x 3 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "area_df = counties[[\"county\", \"area_sq_miles\", \"pop_20\"]]\n",
    "area_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9a6bb242-79b5-4987-b628-b30b72732061",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       1539.641317\n",
       "1       4117.675277\n",
       "2       2292.170769\n",
       "3       1612.196187\n",
       "4       1670.266829\n",
       "           ...     \n",
       "3221     118.745630\n",
       "3222     131.541998\n",
       "3223      92.298997\n",
       "3224     143.005851\n",
       "3225     175.372743\n",
       "Name: area_sq_miles, Length: 3226, dtype: float64"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "area_df[\"area_sq_miles\"]* 2.59"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "46d5973a-3294-4a18-8589-68fa27fe6fa3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>area_sq_miles</th>\n",
       "      <th>pop_20</th>\n",
       "      <th>area_sq_km</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Autauga, AL</td>\n",
       "      <td>594.456107</td>\n",
       "      <td>58877.0</td>\n",
       "      <td>1539.641317</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Baldwin, AL</td>\n",
       "      <td>1589.836014</td>\n",
       "      <td>233140.0</td>\n",
       "      <td>4117.675277</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Barbour, AL</td>\n",
       "      <td>885.008019</td>\n",
       "      <td>25180.0</td>\n",
       "      <td>2292.170769</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bibb, AL</td>\n",
       "      <td>622.469570</td>\n",
       "      <td>22223.0</td>\n",
       "      <td>1612.196187</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Blount, AL</td>\n",
       "      <td>644.890667</td>\n",
       "      <td>59081.0</td>\n",
       "      <td>1670.266829</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3221</th>\n",
       "      <td>Vega Baja, PR</td>\n",
       "      <td>45.847734</td>\n",
       "      <td>54322.0</td>\n",
       "      <td>118.745630</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3222</th>\n",
       "      <td>Vieques, PR</td>\n",
       "      <td>50.788416</td>\n",
       "      <td>8242.0</td>\n",
       "      <td>131.541998</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3223</th>\n",
       "      <td>Villalba, PR</td>\n",
       "      <td>35.636678</td>\n",
       "      <td>22044.0</td>\n",
       "      <td>92.298997</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3224</th>\n",
       "      <td>Yabucoa, PR</td>\n",
       "      <td>55.214614</td>\n",
       "      <td>30364.0</td>\n",
       "      <td>143.005851</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3225</th>\n",
       "      <td>Yauco, PR</td>\n",
       "      <td>67.711484</td>\n",
       "      <td>34062.0</td>\n",
       "      <td>175.372743</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3226 rows Ã— 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             county  area_sq_miles    pop_20   area_sq_km\n",
       "0       Autauga, AL     594.456107   58877.0  1539.641317\n",
       "1       Baldwin, AL    1589.836014  233140.0  4117.675277\n",
       "2       Barbour, AL     885.008019   25180.0  2292.170769\n",
       "3          Bibb, AL     622.469570   22223.0  1612.196187\n",
       "4        Blount, AL     644.890667   59081.0  1670.266829\n",
       "...             ...            ...       ...          ...\n",
       "3221  Vega Baja, PR      45.847734   54322.0   118.745630\n",
       "3222    Vieques, PR      50.788416    8242.0   131.541998\n",
       "3223   Villalba, PR      35.636678   22044.0    92.298997\n",
       "3224    Yabucoa, PR      55.214614   30364.0   143.005851\n",
       "3225      Yauco, PR      67.711484   34062.0   175.372743\n",
       "\n",
       "[3226 rows x 4 columns]"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "area_df[\"area_sq_km\"] = area_df[\"area_sq_miles\"]* 2.59\n",
    "area_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4ddb0602-919d-470b-a073-50503ca0f73e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>area_sq_miles</th>\n",
       "      <th>pop_20</th>\n",
       "      <th>area_sq_km</th>\n",
       "      <th>area_hectares</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Autauga, AL</td>\n",
       "      <td>594.456107</td>\n",
       "      <td>58877.0</td>\n",
       "      <td>1539.641317</td>\n",
       "      <td>153964.131747</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Baldwin, AL</td>\n",
       "      <td>1589.836014</td>\n",
       "      <td>233140.0</td>\n",
       "      <td>4117.675277</td>\n",
       "      <td>411767.527703</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Barbour, AL</td>\n",
       "      <td>885.008019</td>\n",
       "      <td>25180.0</td>\n",
       "      <td>2292.170769</td>\n",
       "      <td>229217.076910</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bibb, AL</td>\n",
       "      <td>622.469570</td>\n",
       "      <td>22223.0</td>\n",
       "      <td>1612.196187</td>\n",
       "      <td>161219.618663</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Blount, AL</td>\n",
       "      <td>644.890667</td>\n",
       "      <td>59081.0</td>\n",
       "      <td>1670.266829</td>\n",
       "      <td>167026.682869</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3221</th>\n",
       "      <td>Vega Baja, PR</td>\n",
       "      <td>45.847734</td>\n",
       "      <td>54322.0</td>\n",
       "      <td>118.745630</td>\n",
       "      <td>11874.563017</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3222</th>\n",
       "      <td>Vieques, PR</td>\n",
       "      <td>50.788416</td>\n",
       "      <td>8242.0</td>\n",
       "      <td>131.541998</td>\n",
       "      <td>13154.199846</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3223</th>\n",
       "      <td>Villalba, PR</td>\n",
       "      <td>35.636678</td>\n",
       "      <td>22044.0</td>\n",
       "      <td>92.298997</td>\n",
       "      <td>9229.899664</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3224</th>\n",
       "      <td>Yabucoa, PR</td>\n",
       "      <td>55.214614</td>\n",
       "      <td>30364.0</td>\n",
       "      <td>143.005851</td>\n",
       "      <td>14300.585058</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3225</th>\n",
       "      <td>Yauco, PR</td>\n",
       "      <td>67.711484</td>\n",
       "      <td>34062.0</td>\n",
       "      <td>175.372743</td>\n",
       "      <td>17537.274254</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3226 rows Ã— 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             county  area_sq_miles    pop_20   area_sq_km  area_hectares\n",
       "0       Autauga, AL     594.456107   58877.0  1539.641317  153964.131747\n",
       "1       Baldwin, AL    1589.836014  233140.0  4117.675277  411767.527703\n",
       "2       Barbour, AL     885.008019   25180.0  2292.170769  229217.076910\n",
       "3          Bibb, AL     622.469570   22223.0  1612.196187  161219.618663\n",
       "4        Blount, AL     644.890667   59081.0  1670.266829  167026.682869\n",
       "...             ...            ...       ...          ...            ...\n",
       "3221  Vega Baja, PR      45.847734   54322.0   118.745630   11874.563017\n",
       "3222    Vieques, PR      50.788416    8242.0   131.541998   13154.199846\n",
       "3223   Villalba, PR      35.636678   22044.0    92.298997    9229.899664\n",
       "3224    Yabucoa, PR      55.214614   30364.0   143.005851   14300.585058\n",
       "3225      Yauco, PR      67.711484   34062.0   175.372743   17537.274254\n",
       "\n",
       "[3226 rows x 5 columns]"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# New var with area in sq km\n",
    "area_df[\"area_sq_km\"] = area_df[\"area_sq_miles\"]* 2.59\n",
    "# New var with area in hectares\n",
    "area_df[\"area_hectares\"] = area_df[\"area_sq_km\"] * 100\n",
    "area_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "653de52c-bf5e-4778-b03a-24b04708ae60",
   "metadata": {},
   "outputs": [],
   "source": [
    "area_df[\"area_acres\"] = area_df[\"area_sq_miles\"] * 640"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4710acd7-fe94-44d6-a231-505b4c836ab2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>area_sq_miles</th>\n",
       "      <th>pop_20</th>\n",
       "      <th>area_sq_km</th>\n",
       "      <th>area_hectares</th>\n",
       "      <th>area_acres</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Autauga, AL</td>\n",
       "      <td>594.456107</td>\n",
       "      <td>58877.0</td>\n",
       "      <td>1539.641317</td>\n",
       "      <td>153964.131747</td>\n",
       "      <td>3.804519e+05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Baldwin, AL</td>\n",
       "      <td>1589.836014</td>\n",
       "      <td>233140.0</td>\n",
       "      <td>4117.675277</td>\n",
       "      <td>411767.527703</td>\n",
       "      <td>1.017495e+06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Barbour, AL</td>\n",
       "      <td>885.008019</td>\n",
       "      <td>25180.0</td>\n",
       "      <td>2292.170769</td>\n",
       "      <td>229217.076910</td>\n",
       "      <td>5.664051e+05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bibb, AL</td>\n",
       "      <td>622.469570</td>\n",
       "      <td>22223.0</td>\n",
       "      <td>1612.196187</td>\n",
       "      <td>161219.618663</td>\n",
       "      <td>3.983805e+05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Blount, AL</td>\n",
       "      <td>644.890667</td>\n",
       "      <td>59081.0</td>\n",
       "      <td>1670.266829</td>\n",
       "      <td>167026.682869</td>\n",
       "      <td>4.127300e+05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3221</th>\n",
       "      <td>Vega Baja, PR</td>\n",
       "      <td>45.847734</td>\n",
       "      <td>54322.0</td>\n",
       "      <td>118.745630</td>\n",
       "      <td>11874.563017</td>\n",
       "      <td>2.934255e+04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3222</th>\n",
       "      <td>Vieques, PR</td>\n",
       "      <td>50.788416</td>\n",
       "      <td>8242.0</td>\n",
       "      <td>131.541998</td>\n",
       "      <td>13154.199846</td>\n",
       "      <td>3.250459e+04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3223</th>\n",
       "      <td>Villalba, PR</td>\n",
       "      <td>35.636678</td>\n",
       "      <td>22044.0</td>\n",
       "      <td>92.298997</td>\n",
       "      <td>9229.899664</td>\n",
       "      <td>2.280747e+04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3224</th>\n",
       "      <td>Yabucoa, PR</td>\n",
       "      <td>55.214614</td>\n",
       "      <td>30364.0</td>\n",
       "      <td>143.005851</td>\n",
       "      <td>14300.585058</td>\n",
       "      <td>3.533735e+04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3225</th>\n",
       "      <td>Yauco, PR</td>\n",
       "      <td>67.711484</td>\n",
       "      <td>34062.0</td>\n",
       "      <td>175.372743</td>\n",
       "      <td>17537.274254</td>\n",
       "      <td>4.333535e+04</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3226 rows Ã— 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             county  area_sq_miles    pop_20   area_sq_km  area_hectares  \\\n",
       "0       Autauga, AL     594.456107   58877.0  1539.641317  153964.131747   \n",
       "1       Baldwin, AL    1589.836014  233140.0  4117.675277  411767.527703   \n",
       "2       Barbour, AL     885.008019   25180.0  2292.170769  229217.076910   \n",
       "3          Bibb, AL     622.469570   22223.0  1612.196187  161219.618663   \n",
       "4        Blount, AL     644.890667   59081.0  1670.266829  167026.682869   \n",
       "...             ...            ...       ...          ...            ...   \n",
       "3221  Vega Baja, PR      45.847734   54322.0   118.745630   11874.563017   \n",
       "3222    Vieques, PR      50.788416    8242.0   131.541998   13154.199846   \n",
       "3223   Villalba, PR      35.636678   22044.0    92.298997    9229.899664   \n",
       "3224    Yabucoa, PR      55.214614   30364.0   143.005851   14300.585058   \n",
       "3225      Yauco, PR      67.711484   34062.0   175.372743   17537.274254   \n",
       "\n",
       "        area_acres  \n",
       "0     3.804519e+05  \n",
       "1     1.017495e+06  \n",
       "2     5.664051e+05  \n",
       "3     3.983805e+05  \n",
       "4     4.127300e+05  \n",
       "...            ...  \n",
       "3221  2.934255e+04  \n",
       "3222  3.250459e+04  \n",
       "3223  2.280747e+04  \n",
       "3224  3.533735e+04  \n",
       "3225  4.333535e+04  \n",
       "\n",
       "[3226 rows x 6 columns]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "area_df[\"area_acres\"] = area_df[\"area_sq_miles\"] * 640\n",
    "area_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fb489a28-910c-45fa-9fbe-968fec0e6254",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       1539.6\n",
       "1       4117.7\n",
       "2       2292.2\n",
       "3       1612.2\n",
       "4       1670.3\n",
       "         ...  \n",
       "3221     118.7\n",
       "3222     131.5\n",
       "3223      92.3\n",
       "3224     143.0\n",
       "3225     175.4\n",
       "Name: area_sq_km, Length: 3226, dtype: float64"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "area_df[\"area_sq_km\"].round(1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5683c88e-12dd-4f3f-a2fa-d059abe0efc7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>area_sq_miles</th>\n",
       "      <th>pop_20</th>\n",
       "      <th>area_sq_km</th>\n",
       "      <th>area_hectares</th>\n",
       "      <th>area_acres</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Autauga, AL</td>\n",
       "      <td>594.456107</td>\n",
       "      <td>58877.0</td>\n",
       "      <td>1539.641317</td>\n",
       "      <td>153964.131747</td>\n",
       "      <td>3.804519e+05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Baldwin, AL</td>\n",
       "      <td>1589.836014</td>\n",
       "      <td>233140.0</td>\n",
       "      <td>4117.675277</td>\n",
       "      <td>411767.527703</td>\n",
       "      <td>1.017495e+06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Barbour, AL</td>\n",
       "      <td>885.008019</td>\n",
       "      <td>25180.0</td>\n",
       "      <td>2292.170769</td>\n",
       "      <td>229217.076910</td>\n",
       "      <td>5.664051e+05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bibb, AL</td>\n",
       "      <td>622.469570</td>\n",
       "      <td>22223.0</td>\n",
       "      <td>1612.196187</td>\n",
       "      <td>161219.618663</td>\n",
       "      <td>3.983805e+05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Blount, AL</td>\n",
       "      <td>644.890667</td>\n",
       "      <td>59081.0</td>\n",
       "      <td>1670.266829</td>\n",
       "      <td>167026.682869</td>\n",
       "      <td>4.127300e+05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3221</th>\n",
       "      <td>Vega Baja, PR</td>\n",
       "      <td>45.847734</td>\n",
       "      <td>54322.0</td>\n",
       "      <td>118.745630</td>\n",
       "      <td>11874.563017</td>\n",
       "      <td>2.934255e+04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3222</th>\n",
       "      <td>Vieques, PR</td>\n",
       "      <td>50.788416</td>\n",
       "      <td>8242.0</td>\n",
       "      <td>131.541998</td>\n",
       "      <td>13154.199846</td>\n",
       "      <td>3.250459e+04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3223</th>\n",
       "      <td>Villalba, PR</td>\n",
       "      <td>35.636678</td>\n",
       "      <td>22044.0</td>\n",
       "      <td>92.298997</td>\n",
       "      <td>9229.899664</td>\n",
       "      <td>2.280747e+04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3224</th>\n",
       "      <td>Yabucoa, PR</td>\n",
       "      <td>55.214614</td>\n",
       "      <td>30364.0</td>\n",
       "      <td>143.005851</td>\n",
       "      <td>14300.585058</td>\n",
       "      <td>3.533735e+04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3225</th>\n",
       "      <td>Yauco, PR</td>\n",
       "      <td>67.711484</td>\n",
       "      <td>34062.0</td>\n",
       "      <td>175.372743</td>\n",
       "      <td>17537.274254</td>\n",
       "      <td>4.333535e+04</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3226 rows Ã— 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             county  area_sq_miles    pop_20   area_sq_km  area_hectares  \\\n",
       "0       Autauga, AL     594.456107   58877.0  1539.641317  153964.131747   \n",
       "1       Baldwin, AL    1589.836014  233140.0  4117.675277  411767.527703   \n",
       "2       Barbour, AL     885.008019   25180.0  2292.170769  229217.076910   \n",
       "3          Bibb, AL     622.469570   22223.0  1612.196187  161219.618663   \n",
       "4        Blount, AL     644.890667   59081.0  1670.266829  167026.682869   \n",
       "...             ...            ...       ...          ...            ...   \n",
       "3221  Vega Baja, PR      45.847734   54322.0   118.745630   11874.563017   \n",
       "3222    Vieques, PR      50.788416    8242.0   131.541998   13154.199846   \n",
       "3223   Villalba, PR      35.636678   22044.0    92.298997    9229.899664   \n",
       "3224    Yabucoa, PR      55.214614   30364.0   143.005851   14300.585058   \n",
       "3225      Yauco, PR      67.711484   34062.0   175.372743   17537.274254   \n",
       "\n",
       "        area_acres  \n",
       "0     3.804519e+05  \n",
       "1     1.017495e+06  \n",
       "2     5.664051e+05  \n",
       "3     3.983805e+05  \n",
       "4     4.127300e+05  \n",
       "...            ...  \n",
       "3221  2.934255e+04  \n",
       "3222  3.250459e+04  \n",
       "3223  2.280747e+04  \n",
       "3224  3.533735e+04  \n",
       "3225  4.333535e+04  \n",
       "\n",
       "[3226 rows x 6 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "area_df[\"area_acres\"].round(1)\n",
    "area_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b02ac93f-79dc-4f83-8d3e-4835f8bc0ff2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>area_sq_miles</th>\n",
       "      <th>pop_20</th>\n",
       "      <th>area_sq_km</th>\n",
       "      <th>area_hectares</th>\n",
       "      <th>area_acres</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Autauga, AL</td>\n",
       "      <td>594.456107</td>\n",
       "      <td>58877.0</td>\n",
       "      <td>1539.641317</td>\n",
       "      <td>153964.131747</td>\n",
       "      <td>380451.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Baldwin, AL</td>\n",
       "      <td>1589.836014</td>\n",
       "      <td>233140.0</td>\n",
       "      <td>4117.675277</td>\n",
       "      <td>411767.527703</td>\n",
       "      <td>1017495.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Barbour, AL</td>\n",
       "      <td>885.008019</td>\n",
       "      <td>25180.0</td>\n",
       "      <td>2292.170769</td>\n",
       "      <td>229217.076910</td>\n",
       "      <td>566405.1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bibb, AL</td>\n",
       "      <td>622.469570</td>\n",
       "      <td>22223.0</td>\n",
       "      <td>1612.196187</td>\n",
       "      <td>161219.618663</td>\n",
       "      <td>398380.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Blount, AL</td>\n",
       "      <td>644.890667</td>\n",
       "      <td>59081.0</td>\n",
       "      <td>1670.266829</td>\n",
       "      <td>167026.682869</td>\n",
       "      <td>412730.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3221</th>\n",
       "      <td>Vega Baja, PR</td>\n",
       "      <td>45.847734</td>\n",
       "      <td>54322.0</td>\n",
       "      <td>118.745630</td>\n",
       "      <td>11874.563017</td>\n",
       "      <td>29342.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3222</th>\n",
       "      <td>Vieques, PR</td>\n",
       "      <td>50.788416</td>\n",
       "      <td>8242.0</td>\n",
       "      <td>131.541998</td>\n",
       "      <td>13154.199846</td>\n",
       "      <td>32504.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3223</th>\n",
       "      <td>Villalba, PR</td>\n",
       "      <td>35.636678</td>\n",
       "      <td>22044.0</td>\n",
       "      <td>92.298997</td>\n",
       "      <td>9229.899664</td>\n",
       "      <td>22807.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3224</th>\n",
       "      <td>Yabucoa, PR</td>\n",
       "      <td>55.214614</td>\n",
       "      <td>30364.0</td>\n",
       "      <td>143.005851</td>\n",
       "      <td>14300.585058</td>\n",
       "      <td>35337.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3225</th>\n",
       "      <td>Yauco, PR</td>\n",
       "      <td>67.711484</td>\n",
       "      <td>34062.0</td>\n",
       "      <td>175.372743</td>\n",
       "      <td>17537.274254</td>\n",
       "      <td>43335.3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3226 rows Ã— 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             county  area_sq_miles    pop_20   area_sq_km  area_hectares  \\\n",
       "0       Autauga, AL     594.456107   58877.0  1539.641317  153964.131747   \n",
       "1       Baldwin, AL    1589.836014  233140.0  4117.675277  411767.527703   \n",
       "2       Barbour, AL     885.008019   25180.0  2292.170769  229217.076910   \n",
       "3          Bibb, AL     622.469570   22223.0  1612.196187  161219.618663   \n",
       "4        Blount, AL     644.890667   59081.0  1670.266829  167026.682869   \n",
       "...             ...            ...       ...          ...            ...   \n",
       "3221  Vega Baja, PR      45.847734   54322.0   118.745630   11874.563017   \n",
       "3222    Vieques, PR      50.788416    8242.0   131.541998   13154.199846   \n",
       "3223   Villalba, PR      35.636678   22044.0    92.298997    9229.899664   \n",
       "3224    Yabucoa, PR      55.214614   30364.0   143.005851   14300.585058   \n",
       "3225      Yauco, PR      67.711484   34062.0   175.372743   17537.274254   \n",
       "\n",
       "      area_acres  \n",
       "0       380451.9  \n",
       "1      1017495.0  \n",
       "2       566405.1  \n",
       "3       398380.5  \n",
       "4       412730.0  \n",
       "...          ...  \n",
       "3221     29342.5  \n",
       "3222     32504.6  \n",
       "3223     22807.5  \n",
       "3224     35337.4  \n",
       "3225     43335.3  \n",
       "\n",
       "[3226 rows x 6 columns]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "area_df[\"area_acres\"] = area_df[\"area_acres\"].round(1)\n",
    "area_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a2052d6d-9d77-44df-b21f-5dba7010ef57",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "'pop_20]'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3805\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3804\u001b[0m \u001b[39mtry\u001b[39;00m:\n\u001b[1;32m-> 3805\u001b[0m     \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_engine\u001b[39m.\u001b[39;49mget_loc(casted_key)\n\u001b[0;32m   3806\u001b[0m \u001b[39mexcept\u001b[39;00m \u001b[39mKeyError\u001b[39;00m \u001b[39mas\u001b[39;00m err:\n",
      "File \u001b[1;32mindex.pyx:167\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mindex.pyx:196\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7081\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7089\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "\u001b[1;31mKeyError\u001b[0m: 'pop_20]'",
      "\nThe above exception was the direct cause of the following exception:\n",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\pandas_transform_variables.qmd:1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m area_df[\u001b[39m\"\u001b[39m\u001b[39mpop_per_sq_km\u001b[39m\u001b[39m\"\u001b[39m] \u001b[39m=\u001b[39m area_df[\u001b[39m\"\u001b[39;49m\u001b[39mpop_20]\u001b[39;49m\u001b[39m\"\u001b[39;49m] \u001b[39m/\u001b[39m area_df[\u001b[39m\"\u001b[39m\u001b[39marea_sq_km\u001b[39m\u001b[39m\"\u001b[39m]\n\u001b[0;32m      2\u001b[0m area_df\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\frame.py:4102\u001b[0m, in \u001b[0;36mDataFrame.__getitem__\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   4100\u001b[0m \u001b[39mif\u001b[39;00m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mcolumns\u001b[39m.\u001b[39mnlevels \u001b[39m>\u001b[39m \u001b[39m1\u001b[39m:\n\u001b[0;32m   4101\u001b[0m     \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_getitem_multilevel(key)\n\u001b[1;32m-> 4102\u001b[0m indexer \u001b[39m=\u001b[39m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mcolumns\u001b[39m.\u001b[39;49mget_loc(key)\n\u001b[0;32m   4103\u001b[0m \u001b[39mif\u001b[39;00m is_integer(indexer):\n\u001b[0;32m   4104\u001b[0m     indexer \u001b[39m=\u001b[39m [indexer]\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3812\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3807\u001b[0m     \u001b[39mif\u001b[39;00m \u001b[39misinstance\u001b[39m(casted_key, \u001b[39mslice\u001b[39m) \u001b[39mor\u001b[39;00m (\n\u001b[0;32m   3808\u001b[0m         \u001b[39misinstance\u001b[39m(casted_key, abc\u001b[39m.\u001b[39mIterable)\n\u001b[0;32m   3809\u001b[0m         \u001b[39mand\u001b[39;00m \u001b[39many\u001b[39m(\u001b[39misinstance\u001b[39m(x, \u001b[39mslice\u001b[39m) \u001b[39mfor\u001b[39;00m x \u001b[39min\u001b[39;00m casted_key)\n\u001b[0;32m   3810\u001b[0m     ):\n\u001b[0;32m   3811\u001b[0m         \u001b[39mraise\u001b[39;00m InvalidIndexError(key)\n\u001b[1;32m-> 3812\u001b[0m     \u001b[39mraise\u001b[39;00m \u001b[39mKeyError\u001b[39;00m(key) \u001b[39mfrom\u001b[39;00m \u001b[39merr\u001b[39;00m\n\u001b[0;32m   3813\u001b[0m \u001b[39mexcept\u001b[39;00m \u001b[39mTypeError\u001b[39;00m:\n\u001b[0;32m   3814\u001b[0m     \u001b[39m# If we have a listlike key, _check_indexing_error will raise\u001b[39;00m\n\u001b[0;32m   3815\u001b[0m     \u001b[39m#  InvalidIndexError. Otherwise we fall through and re-raise\u001b[39;00m\n\u001b[0;32m   3816\u001b[0m     \u001b[39m#  the TypeError.\u001b[39;00m\n\u001b[0;32m   3817\u001b[0m     \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_check_indexing_error(key)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'pop_20]'"
     ]
    }
   ],
   "source": [
    "area_df[\"pop_per_sq_km\"] = area_df[\"pop_20]\"] / area_df[\"area_sq_km\"]\n",
    "area_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "98eba93c-6a5e-4fbe-9370-6ac8c9faad54",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>area_sq_miles</th>\n",
       "      <th>pop_20</th>\n",
       "      <th>area_sq_km</th>\n",
       "      <th>area_hectares</th>\n",
       "      <th>area_acres</th>\n",
       "      <th>pop_per_sq_km</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Autauga, AL</td>\n",
       "      <td>594.456107</td>\n",
       "      <td>58877.0</td>\n",
       "      <td>1539.641317</td>\n",
       "      <td>153964.131747</td>\n",
       "      <td>380451.9</td>\n",
       "      <td>38.240725</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Baldwin, AL</td>\n",
       "      <td>1589.836014</td>\n",
       "      <td>233140.0</td>\n",
       "      <td>4117.675277</td>\n",
       "      <td>411767.527703</td>\n",
       "      <td>1017495.0</td>\n",
       "      <td>56.619326</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Barbour, AL</td>\n",
       "      <td>885.008019</td>\n",
       "      <td>25180.0</td>\n",
       "      <td>2292.170769</td>\n",
       "      <td>229217.076910</td>\n",
       "      <td>566405.1</td>\n",
       "      <td>10.985220</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bibb, AL</td>\n",
       "      <td>622.469570</td>\n",
       "      <td>22223.0</td>\n",
       "      <td>1612.196187</td>\n",
       "      <td>161219.618663</td>\n",
       "      <td>398380.5</td>\n",
       "      <td>13.784303</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Blount, AL</td>\n",
       "      <td>644.890667</td>\n",
       "      <td>59081.0</td>\n",
       "      <td>1670.266829</td>\n",
       "      <td>167026.682869</td>\n",
       "      <td>412730.0</td>\n",
       "      <td>35.372193</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3221</th>\n",
       "      <td>Vega Baja, PR</td>\n",
       "      <td>45.847734</td>\n",
       "      <td>54322.0</td>\n",
       "      <td>118.745630</td>\n",
       "      <td>11874.563017</td>\n",
       "      <td>29342.5</td>\n",
       "      <td>457.465255</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3222</th>\n",
       "      <td>Vieques, PR</td>\n",
       "      <td>50.788416</td>\n",
       "      <td>8242.0</td>\n",
       "      <td>131.541998</td>\n",
       "      <td>13154.199846</td>\n",
       "      <td>32504.6</td>\n",
       "      <td>62.656795</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3223</th>\n",
       "      <td>Villalba, PR</td>\n",
       "      <td>35.636678</td>\n",
       "      <td>22044.0</td>\n",
       "      <td>92.298997</td>\n",
       "      <td>9229.899664</td>\n",
       "      <td>22807.5</td>\n",
       "      <td>238.832499</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3224</th>\n",
       "      <td>Yabucoa, PR</td>\n",
       "      <td>55.214614</td>\n",
       "      <td>30364.0</td>\n",
       "      <td>143.005851</td>\n",
       "      <td>14300.585058</td>\n",
       "      <td>35337.4</td>\n",
       "      <td>212.326977</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3225</th>\n",
       "      <td>Yauco, PR</td>\n",
       "      <td>67.711484</td>\n",
       "      <td>34062.0</td>\n",
       "      <td>175.372743</td>\n",
       "      <td>17537.274254</td>\n",
       "      <td>43335.3</td>\n",
       "      <td>194.226306</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3226 rows Ã— 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             county  area_sq_miles    pop_20   area_sq_km  area_hectares  \\\n",
       "0       Autauga, AL     594.456107   58877.0  1539.641317  153964.131747   \n",
       "1       Baldwin, AL    1589.836014  233140.0  4117.675277  411767.527703   \n",
       "2       Barbour, AL     885.008019   25180.0  2292.170769  229217.076910   \n",
       "3          Bibb, AL     622.469570   22223.0  1612.196187  161219.618663   \n",
       "4        Blount, AL     644.890667   59081.0  1670.266829  167026.682869   \n",
       "...             ...            ...       ...          ...            ...   \n",
       "3221  Vega Baja, PR      45.847734   54322.0   118.745630   11874.563017   \n",
       "3222    Vieques, PR      50.788416    8242.0   131.541998   13154.199846   \n",
       "3223   Villalba, PR      35.636678   22044.0    92.298997    9229.899664   \n",
       "3224    Yabucoa, PR      55.214614   30364.0   143.005851   14300.585058   \n",
       "3225      Yauco, PR      67.711484   34062.0   175.372743   17537.274254   \n",
       "\n",
       "      area_acres  pop_per_sq_km  \n",
       "0       380451.9      38.240725  \n",
       "1      1017495.0      56.619326  \n",
       "2       566405.1      10.985220  \n",
       "3       398380.5      13.784303  \n",
       "4       412730.0      35.372193  \n",
       "...          ...            ...  \n",
       "3221     29342.5     457.465255  \n",
       "3222     32504.6      62.656795  \n",
       "3223     22807.5     238.832499  \n",
       "3224     35337.4     212.326977  \n",
       "3225     43335.3     194.226306  \n",
       "\n",
       "[3226 rows x 7 columns]"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "area_df[\"pop_per_sq_km\"] = area_df[\"pop_20\"] / area_df[\"area_sq_km\"]\n",
    "area_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fb408412-2ef7-46fa-950d-52939cedcebb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>area_sq_miles</th>\n",
       "      <th>pop_20</th>\n",
       "      <th>area_sq_km</th>\n",
       "      <th>area_hectares</th>\n",
       "      <th>area_acres</th>\n",
       "      <th>pop_per_sq_km</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Autauga, AL</td>\n",
       "      <td>594.456107</td>\n",
       "      <td>58877.0</td>\n",
       "      <td>1539.641317</td>\n",
       "      <td>153964.131747</td>\n",
       "      <td>380451.9</td>\n",
       "      <td>38.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Baldwin, AL</td>\n",
       "      <td>1589.836014</td>\n",
       "      <td>233140.0</td>\n",
       "      <td>4117.675277</td>\n",
       "      <td>411767.527703</td>\n",
       "      <td>1017495.0</td>\n",
       "      <td>56.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Barbour, AL</td>\n",
       "      <td>885.008019</td>\n",
       "      <td>25180.0</td>\n",
       "      <td>2292.170769</td>\n",
       "      <td>229217.076910</td>\n",
       "      <td>566405.1</td>\n",
       "      <td>11.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bibb, AL</td>\n",
       "      <td>622.469570</td>\n",
       "      <td>22223.0</td>\n",
       "      <td>1612.196187</td>\n",
       "      <td>161219.618663</td>\n",
       "      <td>398380.5</td>\n",
       "      <td>13.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Blount, AL</td>\n",
       "      <td>644.890667</td>\n",
       "      <td>59081.0</td>\n",
       "      <td>1670.266829</td>\n",
       "      <td>167026.682869</td>\n",
       "      <td>412730.0</td>\n",
       "      <td>35.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3221</th>\n",
       "      <td>Vega Baja, PR</td>\n",
       "      <td>45.847734</td>\n",
       "      <td>54322.0</td>\n",
       "      <td>118.745630</td>\n",
       "      <td>11874.563017</td>\n",
       "      <td>29342.5</td>\n",
       "      <td>457.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3222</th>\n",
       "      <td>Vieques, PR</td>\n",
       "      <td>50.788416</td>\n",
       "      <td>8242.0</td>\n",
       "      <td>131.541998</td>\n",
       "      <td>13154.199846</td>\n",
       "      <td>32504.6</td>\n",
       "      <td>62.7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3223</th>\n",
       "      <td>Villalba, PR</td>\n",
       "      <td>35.636678</td>\n",
       "      <td>22044.0</td>\n",
       "      <td>92.298997</td>\n",
       "      <td>9229.899664</td>\n",
       "      <td>22807.5</td>\n",
       "      <td>238.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3224</th>\n",
       "      <td>Yabucoa, PR</td>\n",
       "      <td>55.214614</td>\n",
       "      <td>30364.0</td>\n",
       "      <td>143.005851</td>\n",
       "      <td>14300.585058</td>\n",
       "      <td>35337.4</td>\n",
       "      <td>212.3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3225</th>\n",
       "      <td>Yauco, PR</td>\n",
       "      <td>67.711484</td>\n",
       "      <td>34062.0</td>\n",
       "      <td>175.372743</td>\n",
       "      <td>17537.274254</td>\n",
       "      <td>43335.3</td>\n",
       "      <td>194.2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3226 rows Ã— 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             county  area_sq_miles    pop_20   area_sq_km  area_hectares  \\\n",
       "0       Autauga, AL     594.456107   58877.0  1539.641317  153964.131747   \n",
       "1       Baldwin, AL    1589.836014  233140.0  4117.675277  411767.527703   \n",
       "2       Barbour, AL     885.008019   25180.0  2292.170769  229217.076910   \n",
       "3          Bibb, AL     622.469570   22223.0  1612.196187  161219.618663   \n",
       "4        Blount, AL     644.890667   59081.0  1670.266829  167026.682869   \n",
       "...             ...            ...       ...          ...            ...   \n",
       "3221  Vega Baja, PR      45.847734   54322.0   118.745630   11874.563017   \n",
       "3222    Vieques, PR      50.788416    8242.0   131.541998   13154.199846   \n",
       "3223   Villalba, PR      35.636678   22044.0    92.298997    9229.899664   \n",
       "3224    Yabucoa, PR      55.214614   30364.0   143.005851   14300.585058   \n",
       "3225      Yauco, PR      67.711484   34062.0   175.372743   17537.274254   \n",
       "\n",
       "      area_acres  pop_per_sq_km  \n",
       "0       380451.9           38.2  \n",
       "1      1017495.0           56.6  \n",
       "2       566405.1           11.0  \n",
       "3       398380.5           13.8  \n",
       "4       412730.0           35.4  \n",
       "...          ...            ...  \n",
       "3221     29342.5          457.5  \n",
       "3222     32504.6           62.7  \n",
       "3223     22807.5          238.8  \n",
       "3224     35337.4          212.3  \n",
       "3225     43335.3          194.2  \n",
       "\n",
       "[3226 rows x 7 columns]"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "area_df[\"pop_per_sq_km\"] = (area_df[\"pop_20\"] / area_df[\"area_sq_km\"]).round(1)\n",
    "area_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f69fc13c-cc7e-4d7e-8c67-341dd1e7c4d2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>area_sq_miles</th>\n",
       "      <th>pop_20</th>\n",
       "      <th>area_sq_km</th>\n",
       "      <th>area_hectares</th>\n",
       "      <th>area_acres</th>\n",
       "      <th>pop_per_sq_km</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Autauga, AL</td>\n",
       "      <td>594.456107</td>\n",
       "      <td>58877.0</td>\n",
       "      <td>1539.641317</td>\n",
       "      <td>153964.131747</td>\n",
       "      <td>380451.9</td>\n",
       "      <td>38.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Baldwin, AL</td>\n",
       "      <td>1589.836014</td>\n",
       "      <td>233140.0</td>\n",
       "      <td>4117.675277</td>\n",
       "      <td>411767.527703</td>\n",
       "      <td>1017495.0</td>\n",
       "      <td>56.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Barbour, AL</td>\n",
       "      <td>885.008019</td>\n",
       "      <td>25180.0</td>\n",
       "      <td>2292.170769</td>\n",
       "      <td>229217.076910</td>\n",
       "      <td>566405.1</td>\n",
       "      <td>11.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bibb, AL</td>\n",
       "      <td>622.469570</td>\n",
       "      <td>22223.0</td>\n",
       "      <td>1612.196187</td>\n",
       "      <td>161219.618663</td>\n",
       "      <td>398380.5</td>\n",
       "      <td>13.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Blount, AL</td>\n",
       "      <td>644.890667</td>\n",
       "      <td>59081.0</td>\n",
       "      <td>1670.266829</td>\n",
       "      <td>167026.682869</td>\n",
       "      <td>412730.0</td>\n",
       "      <td>35.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3221</th>\n",
       "      <td>Vega Baja, PR</td>\n",
       "      <td>45.847734</td>\n",
       "      <td>54322.0</td>\n",
       "      <td>118.745630</td>\n",
       "      <td>11874.563017</td>\n",
       "      <td>29342.5</td>\n",
       "      <td>457.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3222</th>\n",
       "      <td>Vieques, PR</td>\n",
       "      <td>50.788416</td>\n",
       "      <td>8242.0</td>\n",
       "      <td>131.541998</td>\n",
       "      <td>13154.199846</td>\n",
       "      <td>32504.6</td>\n",
       "      <td>62.7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3223</th>\n",
       "      <td>Villalba, PR</td>\n",
       "      <td>35.636678</td>\n",
       "      <td>22044.0</td>\n",
       "      <td>92.298997</td>\n",
       "      <td>9229.899664</td>\n",
       "      <td>22807.5</td>\n",
       "      <td>238.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3224</th>\n",
       "      <td>Yabucoa, PR</td>\n",
       "      <td>55.214614</td>\n",
       "      <td>30364.0</td>\n",
       "      <td>143.005851</td>\n",
       "      <td>14300.585058</td>\n",
       "      <td>35337.4</td>\n",
       "      <td>212.3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3225</th>\n",
       "      <td>Yauco, PR</td>\n",
       "      <td>67.711484</td>\n",
       "      <td>34062.0</td>\n",
       "      <td>175.372743</td>\n",
       "      <td>17537.274254</td>\n",
       "      <td>43335.3</td>\n",
       "      <td>194.2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3226 rows Ã— 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             county  area_sq_miles    pop_20   area_sq_km  area_hectares  \\\n",
       "0       Autauga, AL     594.456107   58877.0  1539.641317  153964.131747   \n",
       "1       Baldwin, AL    1589.836014  233140.0  4117.675277  411767.527703   \n",
       "2       Barbour, AL     885.008019   25180.0  2292.170769  229217.076910   \n",
       "3          Bibb, AL     622.469570   22223.0  1612.196187  161219.618663   \n",
       "4        Blount, AL     644.890667   59081.0  1670.266829  167026.682869   \n",
       "...             ...            ...       ...          ...            ...   \n",
       "3221  Vega Baja, PR      45.847734   54322.0   118.745630   11874.563017   \n",
       "3222    Vieques, PR      50.788416    8242.0   131.541998   13154.199846   \n",
       "3223   Villalba, PR      35.636678   22044.0    92.298997    9229.899664   \n",
       "3224    Yabucoa, PR      55.214614   30364.0   143.005851   14300.585058   \n",
       "3225      Yauco, PR      67.711484   34062.0   175.372743   17537.274254   \n",
       "\n",
       "      area_acres  pop_per_sq_km  \n",
       "0       380451.9           38.2  \n",
       "1      1017495.0           56.6  \n",
       "2       566405.1           11.0  \n",
       "3       398380.5           13.8  \n",
       "4       412730.0           35.4  \n",
       "...          ...            ...  \n",
       "3221     29342.5          457.5  \n",
       "3222     32504.6           62.7  \n",
       "3223     22807.5          238.8  \n",
       "3224     35337.4          212.3  \n",
       "3225     43335.3          194.2  \n",
       "\n",
       "[3226 rows x 7 columns]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "area_df[\"pop_per_sq_km\"] = (area_df[\"pop_20\"] / area_df[\"area_sq_km\"]).round(1)\n",
    "area_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b5bd3e7f-fe67-439b-b35e-cb482d53df27",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>area_sq_miles</th>\n",
       "      <th>pop_20</th>\n",
       "      <th>area_sq_km</th>\n",
       "      <th>area_hectares</th>\n",
       "      <th>area_acres</th>\n",
       "      <th>pop_per_sq_km</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1863</th>\n",
       "      <td>New York, NY</td>\n",
       "      <td>22.656266</td>\n",
       "      <td>1687834.0</td>\n",
       "      <td>58.679729</td>\n",
       "      <td>5867.972888</td>\n",
       "      <td>14500.0</td>\n",
       "      <td>28763.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1856</th>\n",
       "      <td>Kings, NY</td>\n",
       "      <td>69.376570</td>\n",
       "      <td>2727393.0</td>\n",
       "      <td>179.685318</td>\n",
       "      <td>17968.531752</td>\n",
       "      <td>44401.0</td>\n",
       "      <td>15178.7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1835</th>\n",
       "      <td>Bronx, NY</td>\n",
       "      <td>42.171860</td>\n",
       "      <td>1466438.0</td>\n",
       "      <td>109.225117</td>\n",
       "      <td>10922.511706</td>\n",
       "      <td>26990.0</td>\n",
       "      <td>13425.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1873</th>\n",
       "      <td>Queens, NY</td>\n",
       "      <td>108.724075</td>\n",
       "      <td>2395791.0</td>\n",
       "      <td>281.595355</td>\n",
       "      <td>28159.535469</td>\n",
       "      <td>69583.4</td>\n",
       "      <td>8507.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>228</th>\n",
       "      <td>San Francisco, CA</td>\n",
       "      <td>46.914151</td>\n",
       "      <td>870014.0</td>\n",
       "      <td>121.507652</td>\n",
       "      <td>12150.765197</td>\n",
       "      <td>30025.1</td>\n",
       "      <td>7160.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>91</th>\n",
       "      <td>Prince of Wales-Outer Ketchikan, AK</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>94</th>\n",
       "      <td>Skagway-Hoonah-Angoon, AK</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>96</th>\n",
       "      <td>Valdez-Cordova, AK</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>98</th>\n",
       "      <td>Wrangell-Petersburg, AK</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2921</th>\n",
       "      <td>Bedford, VA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3226 rows Ã— 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                   county  area_sq_miles     pop_20  \\\n",
       "1863                         New York, NY      22.656266  1687834.0   \n",
       "1856                            Kings, NY      69.376570  2727393.0   \n",
       "1835                            Bronx, NY      42.171860  1466438.0   \n",
       "1873                           Queens, NY     108.724075  2395791.0   \n",
       "228                     San Francisco, CA      46.914151   870014.0   \n",
       "...                                   ...            ...        ...   \n",
       "91    Prince of Wales-Outer Ketchikan, AK            NaN        NaN   \n",
       "94              Skagway-Hoonah-Angoon, AK            NaN        NaN   \n",
       "96                     Valdez-Cordova, AK            NaN        NaN   \n",
       "98                Wrangell-Petersburg, AK            NaN        NaN   \n",
       "2921                          Bedford, VA            NaN        NaN   \n",
       "\n",
       "      area_sq_km  area_hectares  area_acres  pop_per_sq_km  \n",
       "1863   58.679729    5867.972888     14500.0        28763.5  \n",
       "1856  179.685318   17968.531752     44401.0        15178.7  \n",
       "1835  109.225117   10922.511706     26990.0        13425.8  \n",
       "1873  281.595355   28159.535469     69583.4         8507.9  \n",
       "228   121.507652   12150.765197     30025.1         7160.2  \n",
       "...          ...            ...         ...            ...  \n",
       "91           NaN            NaN         NaN            NaN  \n",
       "94           NaN            NaN         NaN            NaN  \n",
       "96           NaN            NaN         NaN            NaN  \n",
       "98           NaN            NaN         NaN            NaN  \n",
       "2921         NaN            NaN         NaN            NaN  \n",
       "\n",
       "[3226 rows x 7 columns]"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "area_df[\"pop_per_sq_km\"] = (area_df[\"pop_20\"] / area_df[\"area_sq_km\"]).round(1)\n",
    "area_df = area_df.sort_values(by=\"pop_per_sq_km\", ascending=False)\n",
    "area_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a66bc049-465c-4173-b4c4-279a8a3139fb",
   "metadata": {},
   "outputs": [],
   "source": [
    "percent_foreign_born = counties[\"foreign_born_num\"] * 100"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "af78a0aa-1b26-49de-8bb6-933c38e74d36",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       124100.0\n",
       "1       793800.0\n",
       "2        65900.0\n",
       "3        24500.0\n",
       "4       265000.0\n",
       "          ...   \n",
       "3221         NaN\n",
       "3222         NaN\n",
       "3223         NaN\n",
       "3224         NaN\n",
       "3225         NaN\n",
       "Name: foreign_born_num, Length: 3226, dtype: float64"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "percent_foreign_born = counties[\"foreign_born_num\"] * 100\n",
    "percent_foreign_born"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f09c1e29-25f0-4838-ad82-ed19010b2d9e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0                                                            124100.0\n",
       "1                                                            793800.0\n",
       "2                                                             65900.0\n",
       "3                                                             24500.0\n",
       "4                                                            265000.0\n",
       "                                          ...                        \n",
       "3222                                                              NaN\n",
       "3223                                                              NaN\n",
       "3224                                                              NaN\n",
       "3225                                                              NaN\n",
       "foreign_born_num    0       124100.0\n",
       "1       793800.0\n",
       "2        659...\n",
       "Name: foreign_born_num, Length: 3227, dtype: object"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "percent_foreign_born[\"foreign_born_num\"] = counties[\"foreign_born_num\"] * 100\n",
    "percent_foreign_born"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eb82a4cd-2be0-40ce-8fc9-6faa5c7d27af",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       124100.0\n",
       "1       793800.0\n",
       "2        65900.0\n",
       "3        24500.0\n",
       "4       265000.0\n",
       "          ...   \n",
       "3221         NaN\n",
       "3222         NaN\n",
       "3223         NaN\n",
       "3224         NaN\n",
       "3225         NaN\n",
       "Name: foreign_born_num, Length: 3226, dtype: float64"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "percent_foreign_born = counties[\"foreign_born_num\"] * 100\n",
    "percent_foreign_born"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6a6edbe4-bfdd-46b5-8f0e-58e752ec0b55",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       1241.0\n",
       "1       7938.0\n",
       "2        659.0\n",
       "3        245.0\n",
       "4       2650.0\n",
       "         ...  \n",
       "3221       NaN\n",
       "3222       NaN\n",
       "3223       NaN\n",
       "3224       NaN\n",
       "3225       NaN\n",
       "Name: foreign_born_num, Length: 3226, dtype: float64"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "percent_foreign_born = counties[\"foreign_born_num\"] \n",
    "percent_foreign_born"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6740eb58-c2b4-4474-bc78-1508e925456e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       124100.0\n",
       "1       793800.0\n",
       "2        65900.0\n",
       "3        24500.0\n",
       "4       265000.0\n",
       "          ...   \n",
       "3221         NaN\n",
       "3222         NaN\n",
       "3223         NaN\n",
       "3224         NaN\n",
       "3225         NaN\n",
       "Name: foreign_born_num, Length: 3226, dtype: float64"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "percent_foreign_born = counties[\"foreign_born_num\"] * 100\n",
    "percent_foreign_born"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "58fd7bef-47b6-4a3d-943e-302618b8adbf",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "\"['county_name'] not in index\"",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\pandas_transform_variables.qmd:8\u001b[0m\n\u001b[0;32m      5\u001b[0m top_two_counties \u001b[39m=\u001b[39m counties\u001b[39m.\u001b[39msort_values(by\u001b[39m=\u001b[39m\u001b[39m'\u001b[39m\u001b[39mforeign_born_percentage\u001b[39m\u001b[39m'\u001b[39m, ascending\u001b[39m=\u001b[39m\u001b[39mFalse\u001b[39;00m)\n\u001b[0;32m      7\u001b[0m \u001b[39m# Display the top two counties with the highest percentage of foreign-born residents\u001b[39;00m\n\u001b[1;32m----> 8\u001b[0m top_two_counties[[\u001b[39m'\u001b[39;49m\u001b[39mcounty_name\u001b[39;49m\u001b[39m'\u001b[39;49m, \u001b[39m'\u001b[39;49m\u001b[39mforeign_born_percentage\u001b[39;49m\u001b[39m'\u001b[39;49m]]\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\frame.py:4108\u001b[0m, in \u001b[0;36mDataFrame.__getitem__\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   4106\u001b[0m     \u001b[39mif\u001b[39;00m is_iterator(key):\n\u001b[0;32m   4107\u001b[0m         key \u001b[39m=\u001b[39m \u001b[39mlist\u001b[39m(key)\n\u001b[1;32m-> 4108\u001b[0m     indexer \u001b[39m=\u001b[39m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mcolumns\u001b[39m.\u001b[39;49m_get_indexer_strict(key, \u001b[39m\"\u001b[39;49m\u001b[39mcolumns\u001b[39;49m\u001b[39m\"\u001b[39;49m)[\u001b[39m1\u001b[39m]\n\u001b[0;32m   4110\u001b[0m \u001b[39m# take() does not accept boolean indexers\u001b[39;00m\n\u001b[0;32m   4111\u001b[0m \u001b[39mif\u001b[39;00m \u001b[39mgetattr\u001b[39m(indexer, \u001b[39m\"\u001b[39m\u001b[39mdtype\u001b[39m\u001b[39m\"\u001b[39m, \u001b[39mNone\u001b[39;00m) \u001b[39m==\u001b[39m \u001b[39mbool\u001b[39m:\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:6200\u001b[0m, in \u001b[0;36mIndex._get_indexer_strict\u001b[1;34m(self, key, axis_name)\u001b[0m\n\u001b[0;32m   6197\u001b[0m \u001b[39melse\u001b[39;00m:\n\u001b[0;32m   6198\u001b[0m     keyarr, indexer, new_indexer \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_reindex_non_unique(keyarr)\n\u001b[1;32m-> 6200\u001b[0m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_raise_if_missing(keyarr, indexer, axis_name)\n\u001b[0;32m   6202\u001b[0m keyarr \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mtake(indexer)\n\u001b[0;32m   6203\u001b[0m \u001b[39mif\u001b[39;00m \u001b[39misinstance\u001b[39m(key, Index):\n\u001b[0;32m   6204\u001b[0m     \u001b[39m# GH 42790 - Preserve name from an Index\u001b[39;00m\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:6252\u001b[0m, in \u001b[0;36mIndex._raise_if_missing\u001b[1;34m(self, key, indexer, axis_name)\u001b[0m\n\u001b[0;32m   6249\u001b[0m     \u001b[39mraise\u001b[39;00m \u001b[39mKeyError\u001b[39;00m(\u001b[39mf\u001b[39m\u001b[39m\"\u001b[39m\u001b[39mNone of [\u001b[39m\u001b[39m{\u001b[39;00mkey\u001b[39m}\u001b[39;00m\u001b[39m] are in the [\u001b[39m\u001b[39m{\u001b[39;00maxis_name\u001b[39m}\u001b[39;00m\u001b[39m]\u001b[39m\u001b[39m\"\u001b[39m)\n\u001b[0;32m   6251\u001b[0m not_found \u001b[39m=\u001b[39m \u001b[39mlist\u001b[39m(ensure_index(key)[missing_mask\u001b[39m.\u001b[39mnonzero()[\u001b[39m0\u001b[39m]]\u001b[39m.\u001b[39munique())\n\u001b[1;32m-> 6252\u001b[0m \u001b[39mraise\u001b[39;00m \u001b[39mKeyError\u001b[39;00m(\u001b[39mf\u001b[39m\u001b[39m\"\u001b[39m\u001b[39m{\u001b[39;00mnot_found\u001b[39m}\u001b[39;00m\u001b[39m not in index\u001b[39m\u001b[39m\"\u001b[39m)\n",
      "\u001b[1;31mKeyError\u001b[0m: \"['county_name'] not in index\""
     ]
    }
   ],
   "source": [
    "# Calculate the percentage of foreign-born residents\n",
    "counties['foreign_born_percentage'] = (counties['foreign_born_num'] / counties['pop_20']) * 100\n",
    "\n",
    "# Sort counties by the foreign-born percentage in descending order and select the top two\n",
    "top_two_counties = counties.sort_values(by='foreign_born_percentage', ascending=False)\n",
    "\n",
    "# Display the top two counties with the highest percentage of foreign-born residents\n",
    "top_two_counties[['county_name', 'foreign_born_percentage']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "83d29451-6cf0-4772-b7be-87a8465416b9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>foreign_born_percentage</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>367</th>\n",
       "      <td>Miami-Dade, FL</td>\n",
       "      <td>53.947117</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1873</th>\n",
       "      <td>Queens, NY</td>\n",
       "      <td>46.919285</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>69</th>\n",
       "      <td>Aleutians West, AK</td>\n",
       "      <td>45.697272</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2716</th>\n",
       "      <td>Presidio, TX</td>\n",
       "      <td>44.608325</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2642</th>\n",
       "      <td>Hudspeth, TX</td>\n",
       "      <td>44.274093</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3221</th>\n",
       "      <td>Vega Baja, PR</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3222</th>\n",
       "      <td>Vieques, PR</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3223</th>\n",
       "      <td>Villalba, PR</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3224</th>\n",
       "      <td>Yabucoa, PR</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3225</th>\n",
       "      <td>Yauco, PR</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3226 rows Ã— 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                  county  foreign_born_percentage\n",
       "367       Miami-Dade, FL                53.947117\n",
       "1873          Queens, NY                46.919285\n",
       "69    Aleutians West, AK                45.697272\n",
       "2716        Presidio, TX                44.608325\n",
       "2642        Hudspeth, TX                44.274093\n",
       "...                  ...                      ...\n",
       "3221       Vega Baja, PR                      NaN\n",
       "3222         Vieques, PR                      NaN\n",
       "3223        Villalba, PR                      NaN\n",
       "3224         Yabucoa, PR                      NaN\n",
       "3225           Yauco, PR                      NaN\n",
       "\n",
       "[3226 rows x 2 columns]"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Calculate the percentage of foreign-born residents\n",
    "counties['foreign_born_percentage'] = (counties['foreign_born_num'] / counties['pop_20']) * 100\n",
    "\n",
    "# Sort counties by the foreign-born percentage in descending order and select the top two\n",
    "top_two_counties = counties.sort_values(by='foreign_born_percentage', ascending=False)\n",
    "\n",
    "# Display the top two counties with the highest percentage of foreign-born residents\n",
    "top_two_counties[['county', 'foreign_born_percentage']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1ee92637-7430-4a90-bcdc-02026101aa22",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>foreign_born_percentage</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>367</th>\n",
       "      <td>Miami-Dade, FL</td>\n",
       "      <td>53.947117</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1873</th>\n",
       "      <td>Queens, NY</td>\n",
       "      <td>46.919285</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              county  foreign_born_percentage\n",
       "367   Miami-Dade, FL                53.947117\n",
       "1873      Queens, NY                46.919285"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Calculate the percentage of foreign-born residents\n",
    "counties['foreign_born_percentage'] = (counties['foreign_born_num'] / counties['pop_20']) * 100\n",
    "\n",
    "# Sort counties by the foreign-born percentage in descending order and select the top two\n",
    "top_two_counties = counties.sort_values(by='foreign_born_percentage', ascending=False).head(2)\n",
    "\n",
    "# Display the top two counties with the highest percentage of foreign-born residents\n",
    "top_two_counties[['county', 'foreign_born_percentage']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e54d9213-2108-4951-bc5d-5dd88c6058f7",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "\"['pct_emp_2010_2021'] not in index\"",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\pandas_transform_variables.qmd:2\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[39m# make a subset of the counties dataframe with the following colmun\u001b[39;00m\n\u001b[1;32m----> 2\u001b[0m changes_df \u001b[39m=\u001b[39m counties[[\u001b[39m\"\u001b[39;49m\u001b[39mcounty\u001b[39;49m\u001b[39m\"\u001b[39;49m, \u001b[39m\"\u001b[39;49m\u001b[39mpop_change_2010_2020\u001b[39;49m\u001b[39m\"\u001b[39;49m, \u001b[39m\"\u001b[39;49m\u001b[39mpct_emp_2010_2021\u001b[39;49m\u001b[39m\"\u001b[39;49m]]\n\u001b[0;32m      3\u001b[0m changes_df\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\frame.py:4108\u001b[0m, in \u001b[0;36mDataFrame.__getitem__\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   4106\u001b[0m     \u001b[39mif\u001b[39;00m is_iterator(key):\n\u001b[0;32m   4107\u001b[0m         key \u001b[39m=\u001b[39m \u001b[39mlist\u001b[39m(key)\n\u001b[1;32m-> 4108\u001b[0m     indexer \u001b[39m=\u001b[39m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mcolumns\u001b[39m.\u001b[39;49m_get_indexer_strict(key, \u001b[39m\"\u001b[39;49m\u001b[39mcolumns\u001b[39;49m\u001b[39m\"\u001b[39;49m)[\u001b[39m1\u001b[39m]\n\u001b[0;32m   4110\u001b[0m \u001b[39m# take() does not accept boolean indexers\u001b[39;00m\n\u001b[0;32m   4111\u001b[0m \u001b[39mif\u001b[39;00m \u001b[39mgetattr\u001b[39m(indexer, \u001b[39m\"\u001b[39m\u001b[39mdtype\u001b[39m\u001b[39m\"\u001b[39m, \u001b[39mNone\u001b[39;00m) \u001b[39m==\u001b[39m \u001b[39mbool\u001b[39m:\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:6200\u001b[0m, in \u001b[0;36mIndex._get_indexer_strict\u001b[1;34m(self, key, axis_name)\u001b[0m\n\u001b[0;32m   6197\u001b[0m \u001b[39melse\u001b[39;00m:\n\u001b[0;32m   6198\u001b[0m     keyarr, indexer, new_indexer \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_reindex_non_unique(keyarr)\n\u001b[1;32m-> 6200\u001b[0m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_raise_if_missing(keyarr, indexer, axis_name)\n\u001b[0;32m   6202\u001b[0m keyarr \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mtake(indexer)\n\u001b[0;32m   6203\u001b[0m \u001b[39mif\u001b[39;00m \u001b[39misinstance\u001b[39m(key, Index):\n\u001b[0;32m   6204\u001b[0m     \u001b[39m# GH 42790 - Preserve name from an Index\u001b[39;00m\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:6252\u001b[0m, in \u001b[0;36mIndex._raise_if_missing\u001b[1;34m(self, key, indexer, axis_name)\u001b[0m\n\u001b[0;32m   6249\u001b[0m     \u001b[39mraise\u001b[39;00m \u001b[39mKeyError\u001b[39;00m(\u001b[39mf\u001b[39m\u001b[39m\"\u001b[39m\u001b[39mNone of [\u001b[39m\u001b[39m{\u001b[39;00mkey\u001b[39m}\u001b[39;00m\u001b[39m] are in the [\u001b[39m\u001b[39m{\u001b[39;00maxis_name\u001b[39m}\u001b[39;00m\u001b[39m]\u001b[39m\u001b[39m\"\u001b[39m)\n\u001b[0;32m   6251\u001b[0m not_found \u001b[39m=\u001b[39m \u001b[39mlist\u001b[39m(ensure_index(key)[missing_mask\u001b[39m.\u001b[39mnonzero()[\u001b[39m0\u001b[39m]]\u001b[39m.\u001b[39munique())\n\u001b[1;32m-> 6252\u001b[0m \u001b[39mraise\u001b[39;00m \u001b[39mKeyError\u001b[39;00m(\u001b[39mf\u001b[39m\u001b[39m\"\u001b[39m\u001b[39m{\u001b[39;00mnot_found\u001b[39m}\u001b[39;00m\u001b[39m not in index\u001b[39m\u001b[39m\"\u001b[39m)\n",
      "\u001b[1;31mKeyError\u001b[0m: \"['pct_emp_2010_2021'] not in index\""
     ]
    }
   ],
   "source": [
    "# make a subset of the counties dataframe with the following colmun\n",
    "changes_df = counties[[\"county\", \"pop_change_2010_2020\", \"pct_emp_2010_2021\"]]\n",
    "changes_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "940b38b4-f77a-465f-8a3e-bdec912e4cb8",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "\"['pop_change_2010_2021', 'pct_emp_2010_2021'] not in index\"",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\pandas_transform_variables.qmd:2\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[39m# make a subset of the counties dataframe with the following colmun\u001b[39;00m\n\u001b[1;32m----> 2\u001b[0m changes_df \u001b[39m=\u001b[39m counties[[\u001b[39m\"\u001b[39;49m\u001b[39mcounty\u001b[39;49m\u001b[39m\"\u001b[39;49m, \u001b[39m\"\u001b[39;49m\u001b[39mpop_change_2010_2021\u001b[39;49m\u001b[39m\"\u001b[39;49m, \u001b[39m\"\u001b[39;49m\u001b[39mpct_emp_2010_2021\u001b[39;49m\u001b[39m\"\u001b[39;49m]]\n\u001b[0;32m      3\u001b[0m changes_df\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\frame.py:4108\u001b[0m, in \u001b[0;36mDataFrame.__getitem__\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   4106\u001b[0m     \u001b[39mif\u001b[39;00m is_iterator(key):\n\u001b[0;32m   4107\u001b[0m         key \u001b[39m=\u001b[39m \u001b[39mlist\u001b[39m(key)\n\u001b[1;32m-> 4108\u001b[0m     indexer \u001b[39m=\u001b[39m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mcolumns\u001b[39m.\u001b[39;49m_get_indexer_strict(key, \u001b[39m\"\u001b[39;49m\u001b[39mcolumns\u001b[39;49m\u001b[39m\"\u001b[39;49m)[\u001b[39m1\u001b[39m]\n\u001b[0;32m   4110\u001b[0m \u001b[39m# take() does not accept boolean indexers\u001b[39;00m\n\u001b[0;32m   4111\u001b[0m \u001b[39mif\u001b[39;00m \u001b[39mgetattr\u001b[39m(indexer, \u001b[39m\"\u001b[39m\u001b[39mdtype\u001b[39m\u001b[39m\"\u001b[39m, \u001b[39mNone\u001b[39;00m) \u001b[39m==\u001b[39m \u001b[39mbool\u001b[39m:\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:6200\u001b[0m, in \u001b[0;36mIndex._get_indexer_strict\u001b[1;34m(self, key, axis_name)\u001b[0m\n\u001b[0;32m   6197\u001b[0m \u001b[39melse\u001b[39;00m:\n\u001b[0;32m   6198\u001b[0m     keyarr, indexer, new_indexer \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_reindex_non_unique(keyarr)\n\u001b[1;32m-> 6200\u001b[0m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_raise_if_missing(keyarr, indexer, axis_name)\n\u001b[0;32m   6202\u001b[0m keyarr \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mtake(indexer)\n\u001b[0;32m   6203\u001b[0m \u001b[39mif\u001b[39;00m \u001b[39misinstance\u001b[39m(key, Index):\n\u001b[0;32m   6204\u001b[0m     \u001b[39m# GH 42790 - Preserve name from an Index\u001b[39;00m\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:6252\u001b[0m, in \u001b[0;36mIndex._raise_if_missing\u001b[1;34m(self, key, indexer, axis_name)\u001b[0m\n\u001b[0;32m   6249\u001b[0m     \u001b[39mraise\u001b[39;00m \u001b[39mKeyError\u001b[39;00m(\u001b[39mf\u001b[39m\u001b[39m\"\u001b[39m\u001b[39mNone of [\u001b[39m\u001b[39m{\u001b[39;00mkey\u001b[39m}\u001b[39;00m\u001b[39m] are in the [\u001b[39m\u001b[39m{\u001b[39;00maxis_name\u001b[39m}\u001b[39;00m\u001b[39m]\u001b[39m\u001b[39m\"\u001b[39m)\n\u001b[0;32m   6251\u001b[0m not_found \u001b[39m=\u001b[39m \u001b[39mlist\u001b[39m(ensure_index(key)[missing_mask\u001b[39m.\u001b[39mnonzero()[\u001b[39m0\u001b[39m]]\u001b[39m.\u001b[39munique())\n\u001b[1;32m-> 6252\u001b[0m \u001b[39mraise\u001b[39;00m \u001b[39mKeyError\u001b[39;00m(\u001b[39mf\u001b[39m\u001b[39m\"\u001b[39m\u001b[39m{\u001b[39;00mnot_found\u001b[39m}\u001b[39;00m\u001b[39m not in index\u001b[39m\u001b[39m\"\u001b[39m)\n",
      "\u001b[1;31mKeyError\u001b[0m: \"['pop_change_2010_2021', 'pct_emp_2010_2021'] not in index\""
     ]
    }
   ],
   "source": [
    "# make a subset of the counties dataframe with the following colmun\n",
    "changes_df = counties[[\"county\", \"pop_change_2010_2021\", \"pct_emp_2010_2021\"]]\n",
    "changes_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "35698ee0-f72f-4f35-96bc-eb334398e57d",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "\"['pct_emp_2010_2021'] not in index\"",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\pandas_transform_variables.qmd:2\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[39m# make a subset of the counties dataframe with the following colmun\u001b[39;00m\n\u001b[1;32m----> 2\u001b[0m changes_df \u001b[39m=\u001b[39m counties[[\u001b[39m\"\u001b[39;49m\u001b[39mcounty\u001b[39;49m\u001b[39m\"\u001b[39;49m, \u001b[39m\"\u001b[39;49m\u001b[39mpop_change_2010_2020\u001b[39;49m\u001b[39m\"\u001b[39;49m, \u001b[39m\"\u001b[39;49m\u001b[39mpct_emp_2010_2021\u001b[39;49m\u001b[39m\"\u001b[39;49m]]\n\u001b[0;32m      3\u001b[0m changes_df\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\frame.py:4108\u001b[0m, in \u001b[0;36mDataFrame.__getitem__\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   4106\u001b[0m     \u001b[39mif\u001b[39;00m is_iterator(key):\n\u001b[0;32m   4107\u001b[0m         key \u001b[39m=\u001b[39m \u001b[39mlist\u001b[39m(key)\n\u001b[1;32m-> 4108\u001b[0m     indexer \u001b[39m=\u001b[39m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mcolumns\u001b[39m.\u001b[39;49m_get_indexer_strict(key, \u001b[39m\"\u001b[39;49m\u001b[39mcolumns\u001b[39;49m\u001b[39m\"\u001b[39;49m)[\u001b[39m1\u001b[39m]\n\u001b[0;32m   4110\u001b[0m \u001b[39m# take() does not accept boolean indexers\u001b[39;00m\n\u001b[0;32m   4111\u001b[0m \u001b[39mif\u001b[39;00m \u001b[39mgetattr\u001b[39m(indexer, \u001b[39m\"\u001b[39m\u001b[39mdtype\u001b[39m\u001b[39m\"\u001b[39m, \u001b[39mNone\u001b[39;00m) \u001b[39m==\u001b[39m \u001b[39mbool\u001b[39m:\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:6200\u001b[0m, in \u001b[0;36mIndex._get_indexer_strict\u001b[1;34m(self, key, axis_name)\u001b[0m\n\u001b[0;32m   6197\u001b[0m \u001b[39melse\u001b[39;00m:\n\u001b[0;32m   6198\u001b[0m     keyarr, indexer, new_indexer \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_reindex_non_unique(keyarr)\n\u001b[1;32m-> 6200\u001b[0m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_raise_if_missing(keyarr, indexer, axis_name)\n\u001b[0;32m   6202\u001b[0m keyarr \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mtake(indexer)\n\u001b[0;32m   6203\u001b[0m \u001b[39mif\u001b[39;00m \u001b[39misinstance\u001b[39m(key, Index):\n\u001b[0;32m   6204\u001b[0m     \u001b[39m# GH 42790 - Preserve name from an Index\u001b[39;00m\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:6252\u001b[0m, in \u001b[0;36mIndex._raise_if_missing\u001b[1;34m(self, key, indexer, axis_name)\u001b[0m\n\u001b[0;32m   6249\u001b[0m     \u001b[39mraise\u001b[39;00m \u001b[39mKeyError\u001b[39;00m(\u001b[39mf\u001b[39m\u001b[39m\"\u001b[39m\u001b[39mNone of [\u001b[39m\u001b[39m{\u001b[39;00mkey\u001b[39m}\u001b[39;00m\u001b[39m] are in the [\u001b[39m\u001b[39m{\u001b[39;00maxis_name\u001b[39m}\u001b[39;00m\u001b[39m]\u001b[39m\u001b[39m\"\u001b[39m)\n\u001b[0;32m   6251\u001b[0m not_found \u001b[39m=\u001b[39m \u001b[39mlist\u001b[39m(ensure_index(key)[missing_mask\u001b[39m.\u001b[39mnonzero()[\u001b[39m0\u001b[39m]]\u001b[39m.\u001b[39munique())\n\u001b[1;32m-> 6252\u001b[0m \u001b[39mraise\u001b[39;00m \u001b[39mKeyError\u001b[39;00m(\u001b[39mf\u001b[39m\u001b[39m\"\u001b[39m\u001b[39m{\u001b[39;00mnot_found\u001b[39m}\u001b[39;00m\u001b[39m not in index\u001b[39m\u001b[39m\"\u001b[39m)\n",
      "\u001b[1;31mKeyError\u001b[0m: \"['pct_emp_2010_2021'] not in index\""
     ]
    }
   ],
   "source": [
    "# make a subset of the counties dataframe with the following colmun\n",
    "changes_df = counties[[\"county\", \"pop_change_2010_2020\", \"pct_emp_2010_2021\"]]\n",
    "changes_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2830bb9c-2809-4bf0-9281-8e3e3f2fa5e1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>pop_change_2010_2020</th>\n",
       "      <th>pct_emp_change_2010_2021</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Autauga, AL</td>\n",
       "      <td>7.758700</td>\n",
       "      <td>9.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Baldwin, AL</td>\n",
       "      <td>27.159356</td>\n",
       "      <td>28.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Barbour, AL</td>\n",
       "      <td>-8.136359</td>\n",
       "      <td>-13.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bibb, AL</td>\n",
       "      <td>-2.714379</td>\n",
       "      <td>4.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Blount, AL</td>\n",
       "      <td>3.161090</td>\n",
       "      <td>9.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3221</th>\n",
       "      <td>Vega Baja, PR</td>\n",
       "      <td>-8.796219</td>\n",
       "      <td>-0.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3222</th>\n",
       "      <td>Vieques, PR</td>\n",
       "      <td>-11.310612</td>\n",
       "      <td>-12.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3223</th>\n",
       "      <td>Villalba, PR</td>\n",
       "      <td>-15.264833</td>\n",
       "      <td>-1.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3224</th>\n",
       "      <td>Yabucoa, PR</td>\n",
       "      <td>-19.807069</td>\n",
       "      <td>0.1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3225</th>\n",
       "      <td>Yauco, PR</td>\n",
       "      <td>-18.721309</td>\n",
       "      <td>-5.3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3226 rows Ã— 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             county  pop_change_2010_2020  pct_emp_change_2010_2021\n",
       "0       Autauga, AL              7.758700                       9.0\n",
       "1       Baldwin, AL             27.159356                      28.2\n",
       "2       Barbour, AL             -8.136359                     -13.9\n",
       "3          Bibb, AL             -2.714379                       4.2\n",
       "4        Blount, AL              3.161090                       9.0\n",
       "...             ...                   ...                       ...\n",
       "3221  Vega Baja, PR             -8.796219                      -0.9\n",
       "3222    Vieques, PR            -11.310612                     -12.0\n",
       "3223   Villalba, PR            -15.264833                      -1.2\n",
       "3224    Yabucoa, PR            -19.807069                       0.1\n",
       "3225      Yauco, PR            -18.721309                      -5.3\n",
       "\n",
       "[3226 rows x 3 columns]"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# make a subset of the counties dataframe with the following colmun\n",
    "changes_df = counties[[\"county\", \"pop_change_2010_2020\", \"pct_emp_change_2010_2021\"]]\n",
    "changes_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a921e62f-bdeb-4d7c-a50e-bbabc1db2159",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "'pop_chanbe_2010_2020'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3805\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3804\u001b[0m \u001b[39mtry\u001b[39;00m:\n\u001b[1;32m-> 3805\u001b[0m     \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_engine\u001b[39m.\u001b[39;49mget_loc(casted_key)\n\u001b[0;32m   3806\u001b[0m \u001b[39mexcept\u001b[39;00m \u001b[39mKeyError\u001b[39;00m \u001b[39mas\u001b[39;00m err:\n",
      "File \u001b[1;32mindex.pyx:167\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mindex.pyx:196\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7081\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7089\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "\u001b[1;31mKeyError\u001b[0m: 'pop_chanbe_2010_2020'",
      "\nThe above exception was the direct cause of the following exception:\n",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\pandas_transform_variables.qmd:1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m changes_df[\u001b[39m\"\u001b[39;49m\u001b[39mpop_chanbe_2010_2020\u001b[39;49m\u001b[39m\"\u001b[39;49m] \u001b[39m>\u001b[39m \u001b[39m0\u001b[39m\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\frame.py:4102\u001b[0m, in \u001b[0;36mDataFrame.__getitem__\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   4100\u001b[0m \u001b[39mif\u001b[39;00m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mcolumns\u001b[39m.\u001b[39mnlevels \u001b[39m>\u001b[39m \u001b[39m1\u001b[39m:\n\u001b[0;32m   4101\u001b[0m     \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_getitem_multilevel(key)\n\u001b[1;32m-> 4102\u001b[0m indexer \u001b[39m=\u001b[39m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mcolumns\u001b[39m.\u001b[39;49mget_loc(key)\n\u001b[0;32m   4103\u001b[0m \u001b[39mif\u001b[39;00m is_integer(indexer):\n\u001b[0;32m   4104\u001b[0m     indexer \u001b[39m=\u001b[39m [indexer]\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3812\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3807\u001b[0m     \u001b[39mif\u001b[39;00m \u001b[39misinstance\u001b[39m(casted_key, \u001b[39mslice\u001b[39m) \u001b[39mor\u001b[39;00m (\n\u001b[0;32m   3808\u001b[0m         \u001b[39misinstance\u001b[39m(casted_key, abc\u001b[39m.\u001b[39mIterable)\n\u001b[0;32m   3809\u001b[0m         \u001b[39mand\u001b[39;00m \u001b[39many\u001b[39m(\u001b[39misinstance\u001b[39m(x, \u001b[39mslice\u001b[39m) \u001b[39mfor\u001b[39;00m x \u001b[39min\u001b[39;00m casted_key)\n\u001b[0;32m   3810\u001b[0m     ):\n\u001b[0;32m   3811\u001b[0m         \u001b[39mraise\u001b[39;00m InvalidIndexError(key)\n\u001b[1;32m-> 3812\u001b[0m     \u001b[39mraise\u001b[39;00m \u001b[39mKeyError\u001b[39;00m(key) \u001b[39mfrom\u001b[39;00m \u001b[39merr\u001b[39;00m\n\u001b[0;32m   3813\u001b[0m \u001b[39mexcept\u001b[39;00m \u001b[39mTypeError\u001b[39;00m:\n\u001b[0;32m   3814\u001b[0m     \u001b[39m# If we have a listlike key, _check_indexing_error will raise\u001b[39;00m\n\u001b[0;32m   3815\u001b[0m     \u001b[39m#  InvalidIndexError. Otherwise we fall through and re-raise\u001b[39;00m\n\u001b[0;32m   3816\u001b[0m     \u001b[39m#  the TypeError.\u001b[39;00m\n\u001b[0;32m   3817\u001b[0m     \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_check_indexing_error(key)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'pop_chanbe_2010_2020'"
     ]
    }
   ],
   "source": [
    "changes_df[\"pop_chanbe_2010_2020\"] > 0"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "07bc70e7-0989-4a38-b7c3-558a1977cc3c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0        True\n",
       "1        True\n",
       "2       False\n",
       "3       False\n",
       "4        True\n",
       "        ...  \n",
       "3221    False\n",
       "3222    False\n",
       "3223    False\n",
       "3224    False\n",
       "3225    False\n",
       "Name: pop_change_2010_2020, Length: 3226, dtype: bool"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "changes_df[\"pop_change_2010_2020\"] > 0"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bb380f86-0134-4b37-83a2-0afbcfa8139d",
   "metadata": {},
   "outputs": [
    {
     "ename": "SyntaxError",
     "evalue": "invalid syntax (<ipython-input-34-fd15b5cad584>, line 1)",
     "output_type": "error",
     "traceback": [
      "\u001b[1;36m  Cell \u001b[1;32mIn[34], line 1\u001b[1;36m\u001b[0m\n\u001b[1;33m    changes_df[\"pop_increase\"] =\u001b[0m\n\u001b[1;37m                                 ^\u001b[0m\n\u001b[1;31mSyntaxError\u001b[0m\u001b[1;31m:\u001b[0m invalid syntax\n"
     ]
    }
   ],
   "source": [
    "changes_df[\"pop_increase\"] = \n",
    "changes_df[\"pop_change_2010_2020\"] > 0\n",
    "changes_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1fa55b2d-d0c1-46de-b51d-de6176f972f4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>pop_change_2010_2020</th>\n",
       "      <th>pct_emp_change_2010_2021</th>\n",
       "      <th>pop_increase</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Autauga, AL</td>\n",
       "      <td>7.758700</td>\n",
       "      <td>9.0</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Baldwin, AL</td>\n",
       "      <td>27.159356</td>\n",
       "      <td>28.2</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Barbour, AL</td>\n",
       "      <td>-8.136359</td>\n",
       "      <td>-13.9</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bibb, AL</td>\n",
       "      <td>-2.714379</td>\n",
       "      <td>4.2</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Blount, AL</td>\n",
       "      <td>3.161090</td>\n",
       "      <td>9.0</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3221</th>\n",
       "      <td>Vega Baja, PR</td>\n",
       "      <td>-8.796219</td>\n",
       "      <td>-0.9</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3222</th>\n",
       "      <td>Vieques, PR</td>\n",
       "      <td>-11.310612</td>\n",
       "      <td>-12.0</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3223</th>\n",
       "      <td>Villalba, PR</td>\n",
       "      <td>-15.264833</td>\n",
       "      <td>-1.2</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3224</th>\n",
       "      <td>Yabucoa, PR</td>\n",
       "      <td>-19.807069</td>\n",
       "      <td>0.1</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3225</th>\n",
       "      <td>Yauco, PR</td>\n",
       "      <td>-18.721309</td>\n",
       "      <td>-5.3</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3226 rows Ã— 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             county  pop_change_2010_2020  pct_emp_change_2010_2021  \\\n",
       "0       Autauga, AL              7.758700                       9.0   \n",
       "1       Baldwin, AL             27.159356                      28.2   \n",
       "2       Barbour, AL             -8.136359                     -13.9   \n",
       "3          Bibb, AL             -2.714379                       4.2   \n",
       "4        Blount, AL              3.161090                       9.0   \n",
       "...             ...                   ...                       ...   \n",
       "3221  Vega Baja, PR             -8.796219                      -0.9   \n",
       "3222    Vieques, PR            -11.310612                     -12.0   \n",
       "3223   Villalba, PR            -15.264833                      -1.2   \n",
       "3224    Yabucoa, PR            -19.807069                       0.1   \n",
       "3225      Yauco, PR            -18.721309                      -5.3   \n",
       "\n",
       "      pop_increase  \n",
       "0             True  \n",
       "1             True  \n",
       "2            False  \n",
       "3            False  \n",
       "4             True  \n",
       "...            ...  \n",
       "3221         False  \n",
       "3222         False  \n",
       "3223         False  \n",
       "3224         False  \n",
       "3225         False  \n",
       "\n",
       "[3226 rows x 4 columns]"
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "changes_df[\"pop_increase\"] = changes_df[\"pop_change_2010_2020\"] > 0\n",
    "changes_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5ddee307-98de-4473-a79e-2b53249b886a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>pop_change_2010_2020</th>\n",
       "      <th>pct_emp_change_2010_2021</th>\n",
       "      <th>pop_increase</th>\n",
       "      <th>emp_increase</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Autauga, AL</td>\n",
       "      <td>7.758700</td>\n",
       "      <td>9.0</td>\n",
       "      <td>True</td>\n",
       "      <td>9.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Baldwin, AL</td>\n",
       "      <td>27.159356</td>\n",
       "      <td>28.2</td>\n",
       "      <td>True</td>\n",
       "      <td>28.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Barbour, AL</td>\n",
       "      <td>-8.136359</td>\n",
       "      <td>-13.9</td>\n",
       "      <td>False</td>\n",
       "      <td>-13.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bibb, AL</td>\n",
       "      <td>-2.714379</td>\n",
       "      <td>4.2</td>\n",
       "      <td>False</td>\n",
       "      <td>4.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Blount, AL</td>\n",
       "      <td>3.161090</td>\n",
       "      <td>9.0</td>\n",
       "      <td>True</td>\n",
       "      <td>9.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3221</th>\n",
       "      <td>Vega Baja, PR</td>\n",
       "      <td>-8.796219</td>\n",
       "      <td>-0.9</td>\n",
       "      <td>False</td>\n",
       "      <td>-0.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3222</th>\n",
       "      <td>Vieques, PR</td>\n",
       "      <td>-11.310612</td>\n",
       "      <td>-12.0</td>\n",
       "      <td>False</td>\n",
       "      <td>-12.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3223</th>\n",
       "      <td>Villalba, PR</td>\n",
       "      <td>-15.264833</td>\n",
       "      <td>-1.2</td>\n",
       "      <td>False</td>\n",
       "      <td>-1.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3224</th>\n",
       "      <td>Yabucoa, PR</td>\n",
       "      <td>-19.807069</td>\n",
       "      <td>0.1</td>\n",
       "      <td>False</td>\n",
       "      <td>0.1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3225</th>\n",
       "      <td>Yauco, PR</td>\n",
       "      <td>-18.721309</td>\n",
       "      <td>-5.3</td>\n",
       "      <td>False</td>\n",
       "      <td>-5.3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3226 rows Ã— 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             county  pop_change_2010_2020  pct_emp_change_2010_2021  \\\n",
       "0       Autauga, AL              7.758700                       9.0   \n",
       "1       Baldwin, AL             27.159356                      28.2   \n",
       "2       Barbour, AL             -8.136359                     -13.9   \n",
       "3          Bibb, AL             -2.714379                       4.2   \n",
       "4        Blount, AL              3.161090                       9.0   \n",
       "...             ...                   ...                       ...   \n",
       "3221  Vega Baja, PR             -8.796219                      -0.9   \n",
       "3222    Vieques, PR            -11.310612                     -12.0   \n",
       "3223   Villalba, PR            -15.264833                      -1.2   \n",
       "3224    Yabucoa, PR            -19.807069                       0.1   \n",
       "3225      Yauco, PR            -18.721309                      -5.3   \n",
       "\n",
       "      pop_increase  emp_increase  \n",
       "0             True           9.0  \n",
       "1             True          28.2  \n",
       "2            False         -13.9  \n",
       "3            False           4.2  \n",
       "4             True           9.0  \n",
       "...            ...           ...  \n",
       "3221         False          -0.9  \n",
       "3222         False         -12.0  \n",
       "3223         False          -1.2  \n",
       "3224         False           0.1  \n",
       "3225         False          -5.3  \n",
       "\n",
       "[3226 rows x 5 columns]"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "changes_df[\"pop_increase\"] = changes_df[\"pop_change_2010_2020\"] > 0\n",
    "changes_df[\"emp_increase\"] = changes_df[\"pct_emp_change_2010_2021\"]\n",
    "changes_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ed541fca-efdb-4836-a7bc-95b8445291df",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>pop_change_2010_2020</th>\n",
       "      <th>pct_emp_change_2010_2021</th>\n",
       "      <th>pop_increase</th>\n",
       "      <th>emp_increase</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Autauga, AL</td>\n",
       "      <td>7.758700</td>\n",
       "      <td>9.0</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Baldwin, AL</td>\n",
       "      <td>27.159356</td>\n",
       "      <td>28.2</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Barbour, AL</td>\n",
       "      <td>-8.136359</td>\n",
       "      <td>-13.9</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bibb, AL</td>\n",
       "      <td>-2.714379</td>\n",
       "      <td>4.2</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Blount, AL</td>\n",
       "      <td>3.161090</td>\n",
       "      <td>9.0</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3221</th>\n",
       "      <td>Vega Baja, PR</td>\n",
       "      <td>-8.796219</td>\n",
       "      <td>-0.9</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3222</th>\n",
       "      <td>Vieques, PR</td>\n",
       "      <td>-11.310612</td>\n",
       "      <td>-12.0</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3223</th>\n",
       "      <td>Villalba, PR</td>\n",
       "      <td>-15.264833</td>\n",
       "      <td>-1.2</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3224</th>\n",
       "      <td>Yabucoa, PR</td>\n",
       "      <td>-19.807069</td>\n",
       "      <td>0.1</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3225</th>\n",
       "      <td>Yauco, PR</td>\n",
       "      <td>-18.721309</td>\n",
       "      <td>-5.3</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3226 rows Ã— 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             county  pop_change_2010_2020  pct_emp_change_2010_2021  \\\n",
       "0       Autauga, AL              7.758700                       9.0   \n",
       "1       Baldwin, AL             27.159356                      28.2   \n",
       "2       Barbour, AL             -8.136359                     -13.9   \n",
       "3          Bibb, AL             -2.714379                       4.2   \n",
       "4        Blount, AL              3.161090                       9.0   \n",
       "...             ...                   ...                       ...   \n",
       "3221  Vega Baja, PR             -8.796219                      -0.9   \n",
       "3222    Vieques, PR            -11.310612                     -12.0   \n",
       "3223   Villalba, PR            -15.264833                      -1.2   \n",
       "3224    Yabucoa, PR            -19.807069                       0.1   \n",
       "3225      Yauco, PR            -18.721309                      -5.3   \n",
       "\n",
       "      pop_increase  emp_increase  \n",
       "0             True          True  \n",
       "1             True          True  \n",
       "2            False         False  \n",
       "3            False          True  \n",
       "4             True          True  \n",
       "...            ...           ...  \n",
       "3221         False         False  \n",
       "3222         False         False  \n",
       "3223         False         False  \n",
       "3224         False          True  \n",
       "3225         False         False  \n",
       "\n",
       "[3226 rows x 5 columns]"
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "changes_df[\"pop_increase\"] = changes_df[\"pop_change_2010_2020\"] > 0\n",
    "changes_df[\"emp_increase\"] = changes_df[\"pct_emp_change_2010_2021\"] > 0\n",
    "changes_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "50c5f64a-94a8-4f48-af25-1206930ee2eb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<bound method DataFrame.query of              county  pop_change_2010_2020  pct_emp_change_2010_2021  \\\n",
       "0       Autauga, AL              7.758700                       9.0   \n",
       "1       Baldwin, AL             27.159356                      28.2   \n",
       "2       Barbour, AL             -8.136359                     -13.9   \n",
       "3          Bibb, AL             -2.714379                       4.2   \n",
       "4        Blount, AL              3.161090                       9.0   \n",
       "...             ...                   ...                       ...   \n",
       "3221  Vega Baja, PR             -8.796219                      -0.9   \n",
       "3222    Vieques, PR            -11.310612                     -12.0   \n",
       "3223   Villalba, PR            -15.264833                      -1.2   \n",
       "3224    Yabucoa, PR            -19.807069                       0.1   \n",
       "3225      Yauco, PR            -18.721309                      -5.3   \n",
       "\n",
       "      pop_increase  emp_increase  \n",
       "0             True          True  \n",
       "1             True          True  \n",
       "2            False         False  \n",
       "3            False          True  \n",
       "4             True          True  \n",
       "...            ...           ...  \n",
       "3221         False         False  \n",
       "3222         False         False  \n",
       "3223         False         False  \n",
       "3224         False          True  \n",
       "3225         False         False  \n",
       "\n",
       "[3226 rows x 5 columns]>"
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "changes_df.query(\"pop_increase == True & emp_increase == False\")\n",
    "## beacuse the coulmns are already in boolean,\n",
    "## the above code can also be written as \n",
    "changes_df.query(\"pop_increase & ~(emp_increase)\")\n",
    "changes_df.query"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0b02fcbf-0aa5-431e-81f4-3723fbfe5a45",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<bound method DataFrame.query of              county  pop_change_2010_2020  pct_emp_change_2010_2021  \\\n",
       "0       Autauga, AL              7.758700                       9.0   \n",
       "1       Baldwin, AL             27.159356                      28.2   \n",
       "2       Barbour, AL             -8.136359                     -13.9   \n",
       "3          Bibb, AL             -2.714379                       4.2   \n",
       "4        Blount, AL              3.161090                       9.0   \n",
       "...             ...                   ...                       ...   \n",
       "3221  Vega Baja, PR             -8.796219                      -0.9   \n",
       "3222    Vieques, PR            -11.310612                     -12.0   \n",
       "3223   Villalba, PR            -15.264833                      -1.2   \n",
       "3224    Yabucoa, PR            -19.807069                       0.1   \n",
       "3225      Yauco, PR            -18.721309                      -5.3   \n",
       "\n",
       "      pop_increase  emp_increase  \n",
       "0             True          True  \n",
       "1             True          True  \n",
       "2            False         False  \n",
       "3            False          True  \n",
       "4             True          True  \n",
       "...            ...           ...  \n",
       "3221         False         False  \n",
       "3222         False         False  \n",
       "3223         False         False  \n",
       "3224         False          True  \n",
       "3225         False         False  \n",
       "\n",
       "[3226 rows x 5 columns]>"
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "changes_df.query(\"pop_increase == True & emp_increase == False\")\n",
    "## beacuse the coulmns are already in boolean,\n",
    "## the above code can also be written as \n",
    "changes_df.query(\"pop_increase & ~(emp_increase)\")\n",
    "changes_df.query"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4132ffc0-456f-4a97-aff4-51e88dbd6a46",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<bound method DataFrame.query of              county  pop_change_2010_2020  pct_emp_change_2010_2021  \\\n",
       "0       Autauga, AL              7.758700                       9.0   \n",
       "1       Baldwin, AL             27.159356                      28.2   \n",
       "2       Barbour, AL             -8.136359                     -13.9   \n",
       "3          Bibb, AL             -2.714379                       4.2   \n",
       "4        Blount, AL              3.161090                       9.0   \n",
       "...             ...                   ...                       ...   \n",
       "3221  Vega Baja, PR             -8.796219                      -0.9   \n",
       "3222    Vieques, PR            -11.310612                     -12.0   \n",
       "3223   Villalba, PR            -15.264833                      -1.2   \n",
       "3224    Yabucoa, PR            -19.807069                       0.1   \n",
       "3225      Yauco, PR            -18.721309                      -5.3   \n",
       "\n",
       "      pop_increase  emp_increase  \n",
       "0             True          True  \n",
       "1             True          True  \n",
       "2            False         False  \n",
       "3            False          True  \n",
       "4             True          True  \n",
       "...            ...           ...  \n",
       "3221         False         False  \n",
       "3222         False         False  \n",
       "3223         False         False  \n",
       "3224         False          True  \n",
       "3225         False         False  \n",
       "\n",
       "[3226 rows x 5 columns]>"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "changes_df.query(\"pop_increase == True & emp_increase == False\")\n",
    "## beacuse the coulmns are already in boolean,\n",
    "## the above code can also be written as \n",
    "\n",
    "changes_df.query"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ec08a63f-e31c-4fa2-94fe-e1fe2a42aa39",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<bound method DataFrame.query of              county  pop_change_2010_2020  pct_emp_change_2010_2021  \\\n",
       "0       Autauga, AL              7.758700                       9.0   \n",
       "1       Baldwin, AL             27.159356                      28.2   \n",
       "2       Barbour, AL             -8.136359                     -13.9   \n",
       "3          Bibb, AL             -2.714379                       4.2   \n",
       "4        Blount, AL              3.161090                       9.0   \n",
       "...             ...                   ...                       ...   \n",
       "3221  Vega Baja, PR             -8.796219                      -0.9   \n",
       "3222    Vieques, PR            -11.310612                     -12.0   \n",
       "3223   Villalba, PR            -15.264833                      -1.2   \n",
       "3224    Yabucoa, PR            -19.807069                       0.1   \n",
       "3225      Yauco, PR            -18.721309                      -5.3   \n",
       "\n",
       "      pop_increase  emp_increase  \n",
       "0             True          True  \n",
       "1             True          True  \n",
       "2            False         False  \n",
       "3            False          True  \n",
       "4             True          True  \n",
       "...            ...           ...  \n",
       "3221         False         False  \n",
       "3222         False         False  \n",
       "3223         False         False  \n",
       "3224         False          True  \n",
       "3225         False         False  \n",
       "\n",
       "[3226 rows x 5 columns]>"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "changes_df.query(\"pop_increase == True & emp_increase == False\")\n",
    "## beacuse the coulmns are already in boolean,\n",
    "## the above code can also be written as \n",
    "changes_df.query(\"pop_increase == True & emp_increase == False\")\n",
    "changes_df.query"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5a66b949-478d-4b26-b309-c7f2e2d6821e",
   "metadata": {},
   "outputs": [],
   "source": [
    "foreign_born_pct_gt_30 = counties['foreign_born_percentage'] > 30"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c5299c81-a6be-4589-802a-adba79af2782",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       False\n",
       "1       False\n",
       "2       False\n",
       "3       False\n",
       "4       False\n",
       "        ...  \n",
       "3221    False\n",
       "3222    False\n",
       "3223    False\n",
       "3224    False\n",
       "3225    False\n",
       "Name: foreign_born_percentage, Length: 3226, dtype: bool"
      ]
     },
     "execution_count": 43,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "foreign_born_pct_gt_30 = counties['foreign_born_percentage'] > 30\n",
    "foreign_born_pct_gt_30"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "61eff2a7-f64b-40b5-b152-d16265e03175",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<bound method DataFrame.query of              county  pop_change_2010_2020  pct_emp_change_2010_2021  \\\n",
       "0       Autauga, AL              7.758700                       9.0   \n",
       "1       Baldwin, AL             27.159356                      28.2   \n",
       "2       Barbour, AL             -8.136359                     -13.9   \n",
       "3          Bibb, AL             -2.714379                       4.2   \n",
       "4        Blount, AL              3.161090                       9.0   \n",
       "...             ...                   ...                       ...   \n",
       "3221  Vega Baja, PR             -8.796219                      -0.9   \n",
       "3222    Vieques, PR            -11.310612                     -12.0   \n",
       "3223   Villalba, PR            -15.264833                      -1.2   \n",
       "3224    Yabucoa, PR            -19.807069                       0.1   \n",
       "3225      Yauco, PR            -18.721309                      -5.3   \n",
       "\n",
       "      pop_increase  emp_increase  \n",
       "0             True          True  \n",
       "1             True          True  \n",
       "2            False         False  \n",
       "3            False          True  \n",
       "4             True          True  \n",
       "...            ...           ...  \n",
       "3221         False         False  \n",
       "3222         False         False  \n",
       "3223         False         False  \n",
       "3224         False          True  \n",
       "3225         False         False  \n",
       "\n",
       "[3226 rows x 5 columns]>"
      ]
     },
     "execution_count": 44,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "changes_df.query(\"pop_increase == True & emp_increase == False\")\n",
    "## beacuse the coulmns are already in boolean,\n",
    "## the above code can also be written as \n",
    "changes_df.query(\"pop_increase & ~(emp_increase)\")\n",
    "changes_df.query"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8d2b83ab-2083-426a-a97d-94ca52560b0e",
   "metadata": {},
   "outputs": [
    {
     "ename": "AttributeError",
     "evalue": "'Series' object has no attribute 'query'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mAttributeError\u001b[0m                            Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-45-1e83e632cef5>\u001b[0m in \u001b[0;36m?\u001b[1;34m()\u001b[0m\n\u001b[1;32m----> 1\u001b[1;33m \u001b[0mforeign_born_pct_gt_30\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mquery\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"foreign_born_percentage\"\u001b[0m \u001b[1;33m==\u001b[0m \u001b[1;32mTrue\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, name)\u001b[0m\n\u001b[0;32m   6295\u001b[0m             \u001b[1;32mand\u001b[0m \u001b[0mname\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[1;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_accessors\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   6296\u001b[0m             \u001b[1;32mand\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_info_axis\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_can_hold_identifiers_and_holds_name\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mname\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   6297\u001b[0m         \u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   6298\u001b[0m             \u001b[1;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m[\u001b[0m\u001b[0mname\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 6299\u001b[1;33m         \u001b[1;32mreturn\u001b[0m \u001b[0mobject\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m__getattribute__\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mname\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;31mAttributeError\u001b[0m: 'Series' object has no attribute 'query'"
     ]
    }
   ],
   "source": [
    "foreign_born_pct_gt_30.query(\"foreign_born_percentage\" == True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5f650865-69d0-484c-9eae-52e6fefee96f",
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "expr must be a string to be evaluated, <class 'bool'> given",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-46-6577630cf1fb>\u001b[0m in \u001b[0;36m?\u001b[1;34m()\u001b[0m\n\u001b[1;32m----> 1\u001b[1;33m \u001b[0mcounties\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mquery\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"foreign_born_percentage\"\u001b[0m \u001b[1;33m==\u001b[0m \u001b[1;32mTrue\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\frame.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, expr, inplace, **kwargs)\u001b[0m\n\u001b[0;32m   4816\u001b[0m         \"\"\"\n\u001b[0;32m   4817\u001b[0m         \u001b[0minplace\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mvalidate_bool_kwarg\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0minplace\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;34m\"inplace\"\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   4818\u001b[0m         \u001b[1;32mif\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[0misinstance\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mexpr\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mstr\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   4819\u001b[0m             \u001b[0mmsg\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;33mf\"\u001b[0m\u001b[1;33mexpr must be a string to be evaluated, \u001b[0m\u001b[1;33m{\u001b[0m\u001b[0mtype\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mexpr\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m}\u001b[0m\u001b[1;33m given\u001b[0m\u001b[1;33m\"\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 4820\u001b[1;33m             \u001b[1;32mraise\u001b[0m \u001b[0mValueError\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mmsg\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m   4821\u001b[0m         \u001b[0mkwargs\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m\"level\"\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mkwargs\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mpop\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"level\"\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;36m0\u001b[0m\u001b[1;33m)\u001b[0m \u001b[1;33m+\u001b[0m \u001b[1;36m1\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   4822\u001b[0m         \u001b[0mkwargs\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m\"target\"\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;32mNone\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   4823\u001b[0m         \u001b[0mres\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0meval\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mexpr\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;33m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;31mValueError\u001b[0m: expr must be a string to be evaluated, <class 'bool'> given"
     ]
    }
   ],
   "source": [
    "counties.query(\"foreign_born_percentage\" == True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "728374f2-967c-4521-83b7-d38e9428a889",
   "metadata": {},
   "outputs": [
    {
     "ename": "SyntaxError",
     "evalue": "unterminated string literal (detected at line 3) (<ipython-input-47-f2179285a6ab>, line 3)",
     "output_type": "error",
     "traceback": [
      "\u001b[1;36m  Cell \u001b[1;32mIn[47], line 3\u001b[1;36m\u001b[0m\n\u001b[1;33m    high_foreign_born_counties = counties.query(foreign_born_pct_gt_30 == True')\u001b[0m\n\u001b[1;37m                                                                              ^\u001b[0m\n\u001b[1;31mSyntaxError\u001b[0m\u001b[1;31m:\u001b[0m unterminated string literal (detected at line 3)\n"
     ]
    }
   ],
   "source": [
    "counties.query(\"foreign_born_percentage\" == True)\n",
    "# Query the DataFrame to show only counties where percent_30 is True\n",
    "high_foreign_born_counties = counties.query(foreign_born_pct_gt_30 == True')\n",
    "\n",
    "# Display the resulting DataFrame\n",
    "high_foreign_born_counties[['county_name', 'foreign_born_percentage', 'percent_30']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "81dab67e-967d-4891-ba54-c1978637e561",
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "expr must be a string to be evaluated, <class 'bool'> given",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-48-07c9ab5c72df>\u001b[0m in \u001b[0;36m?\u001b[1;34m()\u001b[0m\n\u001b[1;32m----> 1\u001b[1;33m \u001b[0mcounties\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mquery\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"foreign_born_percentage\"\u001b[0m \u001b[1;33m==\u001b[0m \u001b[1;32mTrue\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m      2\u001b[0m \u001b[1;31m# Query the DataFrame to show only counties where percent_30 is True\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m      3\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\frame.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, expr, inplace, **kwargs)\u001b[0m\n\u001b[0;32m   4816\u001b[0m         \"\"\"\n\u001b[0;32m   4817\u001b[0m         \u001b[0minplace\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mvalidate_bool_kwarg\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0minplace\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;34m\"inplace\"\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   4818\u001b[0m         \u001b[1;32mif\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[0misinstance\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mexpr\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mstr\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   4819\u001b[0m             \u001b[0mmsg\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;33mf\"\u001b[0m\u001b[1;33mexpr must be a string to be evaluated, \u001b[0m\u001b[1;33m{\u001b[0m\u001b[0mtype\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mexpr\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m}\u001b[0m\u001b[1;33m given\u001b[0m\u001b[1;33m\"\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 4820\u001b[1;33m             \u001b[1;32mraise\u001b[0m \u001b[0mValueError\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mmsg\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m   4821\u001b[0m         \u001b[0mkwargs\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m\"level\"\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mkwargs\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mpop\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"level\"\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;36m0\u001b[0m\u001b[1;33m)\u001b[0m \u001b[1;33m+\u001b[0m \u001b[1;36m1\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   4822\u001b[0m         \u001b[0mkwargs\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m\"target\"\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;32mNone\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   4823\u001b[0m         \u001b[0mres\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0meval\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mexpr\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;33m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;31mValueError\u001b[0m: expr must be a string to be evaluated, <class 'bool'> given"
     ]
    }
   ],
   "source": [
    "counties.query(\"foreign_born_percentage\" == True)\n",
    "# Query the DataFrame to show only counties where percent_30 is True"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "98639ed5-de22-4404-8373-43ca69fd3e55",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       2.107784\n",
       "1       3.404821\n",
       "2       2.617156\n",
       "3       1.102461\n",
       "4       4.485368\n",
       "          ...   \n",
       "3221         NaN\n",
       "3222         NaN\n",
       "3223         NaN\n",
       "3224         NaN\n",
       "3225         NaN\n",
       "Name: foreign_born_percentage, Length: 3226, dtype: float64"
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "change = counties['foreign_born_percentage']\n",
    "change"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "95ae4f27-497b-498b-8a8d-455d1593b7b5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       2.107784\n",
       "1       3.404821\n",
       "2       2.617156\n",
       "3       1.102461\n",
       "4       4.485368\n",
       "          ...   \n",
       "3221         NaN\n",
       "3222         NaN\n",
       "3223         NaN\n",
       "3224         NaN\n",
       "3225         NaN\n",
       "Name: foreign_born_percentage, Length: 3226, dtype: float64"
      ]
     },
     "execution_count": 50,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "change = counties['foreign_born_percentage']\n",
    "change"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "82070f4e-f9de-43c9-88c6-86712e79ad54",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       2.107784\n",
       "1       3.404821\n",
       "2       2.617156\n",
       "3       1.102461\n",
       "4       4.485368\n",
       "          ...   \n",
       "3221         NaN\n",
       "3222         NaN\n",
       "3223         NaN\n",
       "3224         NaN\n",
       "3225         NaN\n",
       "Name: foreign_born_percentage, Length: 3226, dtype: float64"
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "change = counties[\"foreign_born_percentage\"]\n",
    "change"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e0b0d3f1-6d0e-4e22-a1a2-1519eb1b7e96",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<ipython-input-52-97534827f51d>:1: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value '[ True  True  True  True  True  True  True  True  True  True  True  True\n",
      "  True  True  True  True  True  True  True  True  True  True  True  True]' has dtype incompatible with float64, please explicitly cast to a compatible dtype first.\n",
      "  change[foreign_born_pct_gt_30] = counties[\"foreign_born_percentage\"] > 30\n"
     ]
    },
    {
     "ename": "NameError",
     "evalue": "name 'changeforeign_born_pct_gt_30' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\pandas_transform_variables.qmd:2\u001b[0m\n\u001b[0;32m      1\u001b[0m change[foreign_born_pct_gt_30] \u001b[39m=\u001b[39m counties[\u001b[39m\"\u001b[39m\u001b[39mforeign_born_percentage\u001b[39m\u001b[39m\"\u001b[39m] \u001b[39m>\u001b[39m \u001b[39m30\u001b[39m\n\u001b[1;32m----> 2\u001b[0m changeforeign_born_pct_gt_30\n",
      "\u001b[1;31mNameError\u001b[0m: name 'changeforeign_born_pct_gt_30' is not defined"
     ]
    }
   ],
   "source": [
    "change[foreign_born_pct_gt_30] = counties[\"foreign_born_percentage\"] > 30\n",
    "changeforeign_born_pct_gt_30"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "71c9ce8b-949a-4b30-b6a2-b7c93dbf55dd",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       2.107784\n",
       "1       3.404821\n",
       "2       2.617156\n",
       "3       1.102461\n",
       "4       4.485368\n",
       "          ...   \n",
       "3221         NaN\n",
       "3222         NaN\n",
       "3223         NaN\n",
       "3224         NaN\n",
       "3225         NaN\n",
       "Name: foreign_born_percentage, Length: 3226, dtype: object"
      ]
     },
     "execution_count": 53,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "change[foreign_born_pct_gt_30] = counties[\"foreign_born_percentage\"] > 30\n",
    "change"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "224c0348-7e04-4e13-bc5d-2755229146ef",
   "metadata": {},
   "outputs": [
    {
     "ename": "AttributeError",
     "evalue": "'Series' object has no attribute 'query'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mAttributeError\u001b[0m                            Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-54-1125da1c8fdf>\u001b[0m in \u001b[0;36m?\u001b[1;34m()\u001b[0m\n\u001b[1;32m----> 1\u001b[1;33m \u001b[0mchange\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mquery\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"foreign_born_percentage\"\u001b[0m \u001b[1;33m==\u001b[0m \u001b[1;32mTrue\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m      2\u001b[0m \u001b[1;31m# Query the DataFrame to show only counties where percent_30 is True\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m      3\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, name)\u001b[0m\n\u001b[0;32m   6295\u001b[0m             \u001b[1;32mand\u001b[0m \u001b[0mname\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[1;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_accessors\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   6296\u001b[0m             \u001b[1;32mand\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_info_axis\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_can_hold_identifiers_and_holds_name\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mname\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   6297\u001b[0m         \u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   6298\u001b[0m             \u001b[1;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m[\u001b[0m\u001b[0mname\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 6299\u001b[1;33m         \u001b[1;32mreturn\u001b[0m \u001b[0mobject\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m__getattribute__\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mname\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;31mAttributeError\u001b[0m: 'Series' object has no attribute 'query'"
     ]
    }
   ],
   "source": [
    "change.query(\"foreign_born_percentage\" == True)\n",
    "# Query the DataFrame to show only counties where percent_30 is True"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f80d6fb0-bdb3-4500-84c8-c0504ff24697",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>foreign_born_percentage</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>367</th>\n",
       "      <td>Miami-Dade, FL</td>\n",
       "      <td>53.947117</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1873</th>\n",
       "      <td>Queens, NY</td>\n",
       "      <td>46.919285</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              county  foreign_born_percentage\n",
       "367   Miami-Dade, FL                53.947117\n",
       "1873      Queens, NY                46.919285"
      ]
     },
     "execution_count": 55,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Calculate the percentage of foreign-born residents\n",
    "counties['foreign_born_percentage'] = (counties['foreign_born_num'] / counties['pop_20']) * 100\n",
    "\n",
    "# Sort counties by the foreign-born percentage in descending order and select the top two\n",
    "top_two_counties = counties.sort_values(by='foreign_born_percentage', ascending=False).head(2)\n",
    "\n",
    "# Display the top two counties with the highest percentage of foreign-born residents\n",
    "top_two_counties[['county', 'foreign_born_percentage']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bab3dc84-3f9f-4777-8725-401da0a00558",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>pop_change_2010_2020</th>\n",
       "      <th>pct_emp_change_2010_2021</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Autauga, AL</td>\n",
       "      <td>7.758700</td>\n",
       "      <td>9.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Baldwin, AL</td>\n",
       "      <td>27.159356</td>\n",
       "      <td>28.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Barbour, AL</td>\n",
       "      <td>-8.136359</td>\n",
       "      <td>-13.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bibb, AL</td>\n",
       "      <td>-2.714379</td>\n",
       "      <td>4.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Blount, AL</td>\n",
       "      <td>3.161090</td>\n",
       "      <td>9.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3221</th>\n",
       "      <td>Vega Baja, PR</td>\n",
       "      <td>-8.796219</td>\n",
       "      <td>-0.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3222</th>\n",
       "      <td>Vieques, PR</td>\n",
       "      <td>-11.310612</td>\n",
       "      <td>-12.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3223</th>\n",
       "      <td>Villalba, PR</td>\n",
       "      <td>-15.264833</td>\n",
       "      <td>-1.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3224</th>\n",
       "      <td>Yabucoa, PR</td>\n",
       "      <td>-19.807069</td>\n",
       "      <td>0.1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3225</th>\n",
       "      <td>Yauco, PR</td>\n",
       "      <td>-18.721309</td>\n",
       "      <td>-5.3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3226 rows Ã— 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             county  pop_change_2010_2020  pct_emp_change_2010_2021\n",
       "0       Autauga, AL              7.758700                       9.0\n",
       "1       Baldwin, AL             27.159356                      28.2\n",
       "2       Barbour, AL             -8.136359                     -13.9\n",
       "3          Bibb, AL             -2.714379                       4.2\n",
       "4        Blount, AL              3.161090                       9.0\n",
       "...             ...                   ...                       ...\n",
       "3221  Vega Baja, PR             -8.796219                      -0.9\n",
       "3222    Vieques, PR            -11.310612                     -12.0\n",
       "3223   Villalba, PR            -15.264833                      -1.2\n",
       "3224    Yabucoa, PR            -19.807069                       0.1\n",
       "3225      Yauco, PR            -18.721309                      -5.3\n",
       "\n",
       "[3226 rows x 3 columns]"
      ]
     },
     "execution_count": 56,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# make a subset of the counties dataframe with the following colmun\n",
    "changes_df = counties[[\"county\", \"pop_change_2010_2020\", \"pct_emp_change_2010_2021\"]]\n",
    "changes_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "739d4f72-e584-405e-8b4f-b3bb9dc47685",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>area_sq_miles</th>\n",
       "      <th>pop_20</th>\n",
       "      <th>area_sq_km</th>\n",
       "      <th>area_hectares</th>\n",
       "      <th>area_acres</th>\n",
       "      <th>pop_per_sq_km</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1863</th>\n",
       "      <td>New York, NY</td>\n",
       "      <td>22.656266</td>\n",
       "      <td>1687834.0</td>\n",
       "      <td>58.679729</td>\n",
       "      <td>5867.972888</td>\n",
       "      <td>14500.0</td>\n",
       "      <td>28763.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1856</th>\n",
       "      <td>Kings, NY</td>\n",
       "      <td>69.376570</td>\n",
       "      <td>2727393.0</td>\n",
       "      <td>179.685318</td>\n",
       "      <td>17968.531752</td>\n",
       "      <td>44401.0</td>\n",
       "      <td>15178.7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1835</th>\n",
       "      <td>Bronx, NY</td>\n",
       "      <td>42.171860</td>\n",
       "      <td>1466438.0</td>\n",
       "      <td>109.225117</td>\n",
       "      <td>10922.511706</td>\n",
       "      <td>26990.0</td>\n",
       "      <td>13425.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1873</th>\n",
       "      <td>Queens, NY</td>\n",
       "      <td>108.724075</td>\n",
       "      <td>2395791.0</td>\n",
       "      <td>281.595355</td>\n",
       "      <td>28159.535469</td>\n",
       "      <td>69583.4</td>\n",
       "      <td>8507.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>228</th>\n",
       "      <td>San Francisco, CA</td>\n",
       "      <td>46.914151</td>\n",
       "      <td>870014.0</td>\n",
       "      <td>121.507652</td>\n",
       "      <td>12150.765197</td>\n",
       "      <td>30025.1</td>\n",
       "      <td>7160.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>91</th>\n",
       "      <td>Prince of Wales-Outer Ketchikan, AK</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>94</th>\n",
       "      <td>Skagway-Hoonah-Angoon, AK</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>96</th>\n",
       "      <td>Valdez-Cordova, AK</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>98</th>\n",
       "      <td>Wrangell-Petersburg, AK</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2921</th>\n",
       "      <td>Bedford, VA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3226 rows Ã— 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                   county  area_sq_miles     pop_20  \\\n",
       "1863                         New York, NY      22.656266  1687834.0   \n",
       "1856                            Kings, NY      69.376570  2727393.0   \n",
       "1835                            Bronx, NY      42.171860  1466438.0   \n",
       "1873                           Queens, NY     108.724075  2395791.0   \n",
       "228                     San Francisco, CA      46.914151   870014.0   \n",
       "...                                   ...            ...        ...   \n",
       "91    Prince of Wales-Outer Ketchikan, AK            NaN        NaN   \n",
       "94              Skagway-Hoonah-Angoon, AK            NaN        NaN   \n",
       "96                     Valdez-Cordova, AK            NaN        NaN   \n",
       "98                Wrangell-Petersburg, AK            NaN        NaN   \n",
       "2921                          Bedford, VA            NaN        NaN   \n",
       "\n",
       "      area_sq_km  area_hectares  area_acres  pop_per_sq_km  \n",
       "1863   58.679729    5867.972888     14500.0        28763.5  \n",
       "1856  179.685318   17968.531752     44401.0        15178.7  \n",
       "1835  109.225117   10922.511706     26990.0        13425.8  \n",
       "1873  281.595355   28159.535469     69583.4         8507.9  \n",
       "228   121.507652   12150.765197     30025.1         7160.2  \n",
       "...          ...            ...         ...            ...  \n",
       "91           NaN            NaN         NaN            NaN  \n",
       "94           NaN            NaN         NaN            NaN  \n",
       "96           NaN            NaN         NaN            NaN  \n",
       "98           NaN            NaN         NaN            NaN  \n",
       "2921         NaN            NaN         NaN            NaN  \n",
       "\n",
       "[3226 rows x 7 columns]"
      ]
     },
     "execution_count": 57,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "area_df[\"pop_per_sq_km\"] = (area_df[\"pop_20\"] / area_df[\"area_sq_km\"]).round(1)\n",
    "area_df = area_df.sort_values(by=\"pop_per_sq_km\", ascending=False)\n",
    "area_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "95b67be7-c728-4a09-8adc-b0aa9172ec62",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>pop_change_2010_2020</th>\n",
       "      <th>pct_emp_change_2010_2021</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Autauga, AL</td>\n",
       "      <td>7.758700</td>\n",
       "      <td>9.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Baldwin, AL</td>\n",
       "      <td>27.159356</td>\n",
       "      <td>28.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Barbour, AL</td>\n",
       "      <td>-8.136359</td>\n",
       "      <td>-13.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bibb, AL</td>\n",
       "      <td>-2.714379</td>\n",
       "      <td>4.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Blount, AL</td>\n",
       "      <td>3.161090</td>\n",
       "      <td>9.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3221</th>\n",
       "      <td>Vega Baja, PR</td>\n",
       "      <td>-8.796219</td>\n",
       "      <td>-0.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3222</th>\n",
       "      <td>Vieques, PR</td>\n",
       "      <td>-11.310612</td>\n",
       "      <td>-12.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3223</th>\n",
       "      <td>Villalba, PR</td>\n",
       "      <td>-15.264833</td>\n",
       "      <td>-1.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3224</th>\n",
       "      <td>Yabucoa, PR</td>\n",
       "      <td>-19.807069</td>\n",
       "      <td>0.1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3225</th>\n",
       "      <td>Yauco, PR</td>\n",
       "      <td>-18.721309</td>\n",
       "      <td>-5.3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3226 rows Ã— 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             county  pop_change_2010_2020  pct_emp_change_2010_2021\n",
       "0       Autauga, AL              7.758700                       9.0\n",
       "1       Baldwin, AL             27.159356                      28.2\n",
       "2       Barbour, AL             -8.136359                     -13.9\n",
       "3          Bibb, AL             -2.714379                       4.2\n",
       "4        Blount, AL              3.161090                       9.0\n",
       "...             ...                   ...                       ...\n",
       "3221  Vega Baja, PR             -8.796219                      -0.9\n",
       "3222    Vieques, PR            -11.310612                     -12.0\n",
       "3223   Villalba, PR            -15.264833                      -1.2\n",
       "3224    Yabucoa, PR            -19.807069                       0.1\n",
       "3225      Yauco, PR            -18.721309                      -5.3\n",
       "\n",
       "[3226 rows x 3 columns]"
      ]
     },
     "execution_count": 58,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# make a subset of the counties dataframe with the following colmun\n",
    "changes_df = counties[[\"county\", \"pop_change_2010_2020\", \"pct_emp_change_2010_2021\"]]\n",
    "changes_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c40fb3bb-a691-4b40-aa11-2b23f92d9034",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>pop_change_2010_2020</th>\n",
       "      <th>pct_emp_change_2010_2021</th>\n",
       "      <th>pop_increase</th>\n",
       "      <th>emp_increase</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Autauga, AL</td>\n",
       "      <td>7.758700</td>\n",
       "      <td>9.0</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Baldwin, AL</td>\n",
       "      <td>27.159356</td>\n",
       "      <td>28.2</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Barbour, AL</td>\n",
       "      <td>-8.136359</td>\n",
       "      <td>-13.9</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bibb, AL</td>\n",
       "      <td>-2.714379</td>\n",
       "      <td>4.2</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Blount, AL</td>\n",
       "      <td>3.161090</td>\n",
       "      <td>9.0</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3221</th>\n",
       "      <td>Vega Baja, PR</td>\n",
       "      <td>-8.796219</td>\n",
       "      <td>-0.9</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3222</th>\n",
       "      <td>Vieques, PR</td>\n",
       "      <td>-11.310612</td>\n",
       "      <td>-12.0</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3223</th>\n",
       "      <td>Villalba, PR</td>\n",
       "      <td>-15.264833</td>\n",
       "      <td>-1.2</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3224</th>\n",
       "      <td>Yabucoa, PR</td>\n",
       "      <td>-19.807069</td>\n",
       "      <td>0.1</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3225</th>\n",
       "      <td>Yauco, PR</td>\n",
       "      <td>-18.721309</td>\n",
       "      <td>-5.3</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3226 rows Ã— 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             county  pop_change_2010_2020  pct_emp_change_2010_2021  \\\n",
       "0       Autauga, AL              7.758700                       9.0   \n",
       "1       Baldwin, AL             27.159356                      28.2   \n",
       "2       Barbour, AL             -8.136359                     -13.9   \n",
       "3          Bibb, AL             -2.714379                       4.2   \n",
       "4        Blount, AL              3.161090                       9.0   \n",
       "...             ...                   ...                       ...   \n",
       "3221  Vega Baja, PR             -8.796219                      -0.9   \n",
       "3222    Vieques, PR            -11.310612                     -12.0   \n",
       "3223   Villalba, PR            -15.264833                      -1.2   \n",
       "3224    Yabucoa, PR            -19.807069                       0.1   \n",
       "3225      Yauco, PR            -18.721309                      -5.3   \n",
       "\n",
       "      pop_increase  emp_increase  \n",
       "0             True          True  \n",
       "1             True          True  \n",
       "2            False         False  \n",
       "3            False          True  \n",
       "4             True          True  \n",
       "...            ...           ...  \n",
       "3221         False         False  \n",
       "3222         False         False  \n",
       "3223         False         False  \n",
       "3224         False          True  \n",
       "3225         False         False  \n",
       "\n",
       "[3226 rows x 5 columns]"
      ]
     },
     "execution_count": 59,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "changes_df[\"pop_increase\"] = changes_df[\"pop_change_2010_2020\"] > 0\n",
    "changes_df[\"emp_increase\"] = changes_df[\"pct_emp_change_2010_2021\"] > 0\n",
    "changes_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dea30e0e-6f4b-4a7e-a79e-d25b5253a9d1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<bound method DataFrame.query of              county  pop_change_2010_2020  pct_emp_change_2010_2021  \\\n",
       "0       Autauga, AL              7.758700                       9.0   \n",
       "1       Baldwin, AL             27.159356                      28.2   \n",
       "2       Barbour, AL             -8.136359                     -13.9   \n",
       "3          Bibb, AL             -2.714379                       4.2   \n",
       "4        Blount, AL              3.161090                       9.0   \n",
       "...             ...                   ...                       ...   \n",
       "3221  Vega Baja, PR             -8.796219                      -0.9   \n",
       "3222    Vieques, PR            -11.310612                     -12.0   \n",
       "3223   Villalba, PR            -15.264833                      -1.2   \n",
       "3224    Yabucoa, PR            -19.807069                       0.1   \n",
       "3225      Yauco, PR            -18.721309                      -5.3   \n",
       "\n",
       "      pop_increase  emp_increase  \n",
       "0             True          True  \n",
       "1             True          True  \n",
       "2            False         False  \n",
       "3            False          True  \n",
       "4             True          True  \n",
       "...            ...           ...  \n",
       "3221         False         False  \n",
       "3222         False         False  \n",
       "3223         False         False  \n",
       "3224         False          True  \n",
       "3225         False         False  \n",
       "\n",
       "[3226 rows x 5 columns]>"
      ]
     },
     "execution_count": 60,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "changes_df.query(\"pop_increase == True & emp_increase == False\")\n",
    "## beacuse the coulmns are already in boolean,\n",
    "## the above code can also be written as \n",
    "changes_df.query(\"pop_increase & ~(emp_increase)\")\n",
    "changes_df.query"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b34ecf1a-34f9-4355-a647-d357f8baa28f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>pop_change_2010_2020</th>\n",
       "      <th>pct_emp_change_2010_2021</th>\n",
       "      <th>pop_increase</th>\n",
       "      <th>emp_increase</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>71</th>\n",
       "      <td>Bethel, AK</td>\n",
       "      <td>9.716099</td>\n",
       "      <td>-0.7</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75</th>\n",
       "      <td>Dillingham, AK</td>\n",
       "      <td>0.206313</td>\n",
       "      <td>-16.1</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>79</th>\n",
       "      <td>Juneau , AK</td>\n",
       "      <td>3.133493</td>\n",
       "      <td>-5.0</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>81</th>\n",
       "      <td>Ketchikan Gateway, AK</td>\n",
       "      <td>3.494843</td>\n",
       "      <td>-5.5</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>87</th>\n",
       "      <td>North Slope, AK</td>\n",
       "      <td>16.977731</td>\n",
       "      <td>-24.8</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3079</th>\n",
       "      <td>Jackson, WI</td>\n",
       "      <td>3.403589</td>\n",
       "      <td>-1.5</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3090</th>\n",
       "      <td>Marinette, WI</td>\n",
       "      <td>0.294618</td>\n",
       "      <td>-1.5</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3125</th>\n",
       "      <td>Albany, WY</td>\n",
       "      <td>2.113006</td>\n",
       "      <td>-0.7</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3127</th>\n",
       "      <td>Campbell, WY</td>\n",
       "      <td>1.935708</td>\n",
       "      <td>-14.8</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3137</th>\n",
       "      <td>Natrona, WY</td>\n",
       "      <td>5.970842</td>\n",
       "      <td>-0.2</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>242 rows Ã— 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                     county  pop_change_2010_2020  pct_emp_change_2010_2021  \\\n",
       "71               Bethel, AK              9.716099                      -0.7   \n",
       "75           Dillingham, AK              0.206313                     -16.1   \n",
       "79              Juneau , AK              3.133493                      -5.0   \n",
       "81    Ketchikan Gateway, AK              3.494843                      -5.5   \n",
       "87          North Slope, AK             16.977731                     -24.8   \n",
       "...                     ...                   ...                       ...   \n",
       "3079            Jackson, WI              3.403589                      -1.5   \n",
       "3090          Marinette, WI              0.294618                      -1.5   \n",
       "3125             Albany, WY              2.113006                      -0.7   \n",
       "3127           Campbell, WY              1.935708                     -14.8   \n",
       "3137            Natrona, WY              5.970842                      -0.2   \n",
       "\n",
       "      pop_increase  emp_increase  \n",
       "71            True         False  \n",
       "75            True         False  \n",
       "79            True         False  \n",
       "81            True         False  \n",
       "87            True         False  \n",
       "...            ...           ...  \n",
       "3079          True         False  \n",
       "3090          True         False  \n",
       "3125          True         False  \n",
       "3127          True         False  \n",
       "3137          True         False  \n",
       "\n",
       "[242 rows x 5 columns]"
      ]
     },
     "execution_count": 61,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "changes_df.query(\"pop_increase == True & emp_increase == False\")\n",
    "## beacuse the coulmns are already in boolean,\n",
    "## the above code can also be written as \n",
    "changes_df.query(\"pop_increase & ~(emp_increase)\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "be6fbb68-01b1-461f-96cf-f64453053ae0",
   "metadata": {},
   "outputs": [],
   "source": [
    "changes_df.query(\"pop_increase == True & emp_increase == False\")\n",
    "## beacuse the coulmns are already in boolean,\n",
    "## the above code can also be written as \n",
    "changes_df = changes_df.query(\"pop_increase & ~(emp_increase)\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5036fda0-08d2-42a5-aeb8-1a49dac62d3a",
   "metadata": {},
   "outputs": [
    {
     "ename": "AttributeError",
     "evalue": "'Series' object has no attribute 'query'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mAttributeError\u001b[0m                            Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-63-b9402a8e3d1e>\u001b[0m in \u001b[0;36m?\u001b[1;34m()\u001b[0m\n\u001b[1;32m----> 1\u001b[1;33m \u001b[0mchange\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mquery\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"'foreign_born_percentage' == True\"\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m      2\u001b[0m \u001b[1;31m# Query the DataFrame to show only counties where percent_30 is True\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m      3\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, name)\u001b[0m\n\u001b[0;32m   6295\u001b[0m             \u001b[1;32mand\u001b[0m \u001b[0mname\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[1;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_accessors\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   6296\u001b[0m             \u001b[1;32mand\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_info_axis\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_can_hold_identifiers_and_holds_name\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mname\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   6297\u001b[0m         \u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   6298\u001b[0m             \u001b[1;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m[\u001b[0m\u001b[0mname\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 6299\u001b[1;33m         \u001b[1;32mreturn\u001b[0m \u001b[0mobject\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m__getattribute__\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mname\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;31mAttributeError\u001b[0m: 'Series' object has no attribute 'query'"
     ]
    }
   ],
   "source": [
    "change.query(\"'foreign_born_percentage' == True\")\n",
    "# Query the DataFrame to show only counties where percent_30 is True"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "aa7abfa6-4b89-4301-9f57-484bc968db7e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0                                                                  2.107784\n",
       "1                                                                  3.404821\n",
       "2                                                                  2.617156\n",
       "3                                                                  1.102461\n",
       "4                                                                  4.485368\n",
       "                                                ...                        \n",
       "3222                                                                    NaN\n",
       "3223                                                                    NaN\n",
       "3224                                                                    NaN\n",
       "3225                                                                    NaN\n",
       "foreign_born_pct_gt_30    0       False\n",
       "1       False\n",
       "2       False\n",
       "3   ...\n",
       "Name: foreign_born_percentage, Length: 3227, dtype: object"
      ]
     },
     "execution_count": 64,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "change[\"foreign_born_pct_gt_30\"] = counties[\"foreign_born_percentage\"] > 30\n",
    "change"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "21c30667-bfa9-4ba7-80dd-06eed90fbdca",
   "metadata": {},
   "outputs": [
    {
     "ename": "AttributeError",
     "evalue": "'Series' object has no attribute 'query'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mAttributeError\u001b[0m                            Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-65-b9402a8e3d1e>\u001b[0m in \u001b[0;36m?\u001b[1;34m()\u001b[0m\n\u001b[1;32m----> 1\u001b[1;33m \u001b[0mchange\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mquery\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"'foreign_born_percentage' == True\"\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m      2\u001b[0m \u001b[1;31m# Query the DataFrame to show only counties where percent_30 is True\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m      3\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, name)\u001b[0m\n\u001b[0;32m   6295\u001b[0m             \u001b[1;32mand\u001b[0m \u001b[0mname\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[1;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_accessors\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   6296\u001b[0m             \u001b[1;32mand\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_info_axis\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_can_hold_identifiers_and_holds_name\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mname\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   6297\u001b[0m         \u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   6298\u001b[0m             \u001b[1;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m[\u001b[0m\u001b[0mname\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 6299\u001b[1;33m         \u001b[1;32mreturn\u001b[0m \u001b[0mobject\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m__getattribute__\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mname\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;31mAttributeError\u001b[0m: 'Series' object has no attribute 'query'"
     ]
    }
   ],
   "source": [
    "change.query(\"'foreign_born_percentage' == True\")\n",
    "# Query the DataFrame to show only counties where percent_30 is True"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "58e39558-4cf3-41a1-b2e1-a845c3c4e155",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       False\n",
       "1       False\n",
       "2       False\n",
       "3       False\n",
       "4       False\n",
       "        ...  \n",
       "3221    False\n",
       "3222    False\n",
       "3223    False\n",
       "3224    False\n",
       "3225    False\n",
       "Name: foreign_born_pct_gt_30, Length: 3226, dtype: bool"
      ]
     },
     "execution_count": 66,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "counties[\"foreign_born_pct_gt_30\"] = counties[\"foreign_born_percentage\"] > 30\n",
    "counties[\"foreign_born_pct_gt_30\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "af910a20-0a89-4347-b933-9e01f0bf233f",
   "metadata": {},
   "outputs": [
    {
     "ename": "TypeError",
     "evalue": "argument of type 'bool' is not iterable",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mAttributeError\u001b[0m                            Traceback (most recent call last)",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\ops.py:268\u001b[0m, in \u001b[0;36m_in\u001b[1;34m(x, y)\u001b[0m\n\u001b[0;32m    267\u001b[0m \u001b[39mtry\u001b[39;00m:\n\u001b[1;32m--> 268\u001b[0m     \u001b[39mreturn\u001b[39;00m x\u001b[39m.\u001b[39;49misin(y)\n\u001b[0;32m    269\u001b[0m \u001b[39mexcept\u001b[39;00m \u001b[39mAttributeError\u001b[39;00m:\n",
      "\u001b[1;31mAttributeError\u001b[0m: 'list' object has no attribute 'isin'",
      "\nDuring handling of the above exception, another exception occurred:\n",
      "\u001b[1;31mTypeError\u001b[0m                                 Traceback (most recent call last)",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\pandas_transform_variables.qmd:1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m counties\u001b[39m.\u001b[39;49mquery(\u001b[39m\"\u001b[39;49m\u001b[39m'\u001b[39;49m\u001b[39mforeign_born_percentage\u001b[39;49m\u001b[39m'\u001b[39;49m\u001b[39m == True\u001b[39;49m\u001b[39m\"\u001b[39;49m)\n\u001b[0;32m      2\u001b[0m \u001b[39m# Query the DataFrame to show only counties where percent_30 is True\u001b[39;00m\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\frame.py:4823\u001b[0m, in \u001b[0;36mDataFrame.query\u001b[1;34m(self, expr, inplace, **kwargs)\u001b[0m\n\u001b[0;32m   4821\u001b[0m kwargs[\u001b[39m\"\u001b[39m\u001b[39mlevel\u001b[39m\u001b[39m\"\u001b[39m] \u001b[39m=\u001b[39m kwargs\u001b[39m.\u001b[39mpop(\u001b[39m\"\u001b[39m\u001b[39mlevel\u001b[39m\u001b[39m\"\u001b[39m, \u001b[39m0\u001b[39m) \u001b[39m+\u001b[39m \u001b[39m1\u001b[39m\n\u001b[0;32m   4822\u001b[0m kwargs[\u001b[39m\"\u001b[39m\u001b[39mtarget\u001b[39m\u001b[39m\"\u001b[39m] \u001b[39m=\u001b[39m \u001b[39mNone\u001b[39;00m\n\u001b[1;32m-> 4823\u001b[0m res \u001b[39m=\u001b[39m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49meval(expr, \u001b[39m*\u001b[39;49m\u001b[39m*\u001b[39;49mkwargs)\n\u001b[0;32m   4825\u001b[0m \u001b[39mtry\u001b[39;00m:\n\u001b[0;32m   4826\u001b[0m     result \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mloc[res]\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\frame.py:4949\u001b[0m, in \u001b[0;36mDataFrame.eval\u001b[1;34m(self, expr, inplace, **kwargs)\u001b[0m\n\u001b[0;32m   4946\u001b[0m     kwargs[\u001b[39m\"\u001b[39m\u001b[39mtarget\u001b[39m\u001b[39m\"\u001b[39m] \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\n\u001b[0;32m   4947\u001b[0m kwargs[\u001b[39m\"\u001b[39m\u001b[39mresolvers\u001b[39m\u001b[39m\"\u001b[39m] \u001b[39m=\u001b[39m \u001b[39mtuple\u001b[39m(kwargs\u001b[39m.\u001b[39mget(\u001b[39m\"\u001b[39m\u001b[39mresolvers\u001b[39m\u001b[39m\"\u001b[39m, ())) \u001b[39m+\u001b[39m resolvers\n\u001b[1;32m-> 4949\u001b[0m \u001b[39mreturn\u001b[39;00m _eval(expr, inplace\u001b[39m=\u001b[39;49minplace, \u001b[39m*\u001b[39;49m\u001b[39m*\u001b[39;49mkwargs)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\eval.py:336\u001b[0m, in \u001b[0;36meval\u001b[1;34m(expr, parser, engine, local_dict, global_dict, resolvers, level, target, inplace)\u001b[0m\n\u001b[0;32m    327\u001b[0m \u001b[39m# get our (possibly passed-in) scope\u001b[39;00m\n\u001b[0;32m    328\u001b[0m env \u001b[39m=\u001b[39m ensure_scope(\n\u001b[0;32m    329\u001b[0m     level \u001b[39m+\u001b[39m \u001b[39m1\u001b[39m,\n\u001b[0;32m    330\u001b[0m     global_dict\u001b[39m=\u001b[39mglobal_dict,\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    333\u001b[0m     target\u001b[39m=\u001b[39mtarget,\n\u001b[0;32m    334\u001b[0m )\n\u001b[1;32m--> 336\u001b[0m parsed_expr \u001b[39m=\u001b[39m Expr(expr, engine\u001b[39m=\u001b[39;49mengine, parser\u001b[39m=\u001b[39;49mparser, env\u001b[39m=\u001b[39;49menv)\n\u001b[0;32m    338\u001b[0m \u001b[39mif\u001b[39;00m engine \u001b[39m==\u001b[39m \u001b[39m\"\u001b[39m\u001b[39mnumexpr\u001b[39m\u001b[39m\"\u001b[39m \u001b[39mand\u001b[39;00m (\n\u001b[0;32m    339\u001b[0m     is_extension_array_dtype(parsed_expr\u001b[39m.\u001b[39mterms\u001b[39m.\u001b[39mreturn_type)\n\u001b[0;32m    340\u001b[0m     \u001b[39mor\u001b[39;00m \u001b[39mgetattr\u001b[39m(parsed_expr\u001b[39m.\u001b[39mterms, \u001b[39m\"\u001b[39m\u001b[39moperand_types\u001b[39m\u001b[39m\"\u001b[39m, \u001b[39mNone\u001b[39;00m) \u001b[39mis\u001b[39;00m \u001b[39mnot\u001b[39;00m \u001b[39mNone\u001b[39;00m\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    344\u001b[0m     )\n\u001b[0;32m    345\u001b[0m ):\n\u001b[0;32m    346\u001b[0m     warnings\u001b[39m.\u001b[39mwarn(\n\u001b[0;32m    347\u001b[0m         \u001b[39m\"\u001b[39m\u001b[39mEngine has switched to \u001b[39m\u001b[39m'\u001b[39m\u001b[39mpython\u001b[39m\u001b[39m'\u001b[39m\u001b[39m because numexpr does not support \u001b[39m\u001b[39m\"\u001b[39m\n\u001b[0;32m    348\u001b[0m         \u001b[39m\"\u001b[39m\u001b[39mextension array dtypes. Please set your engine to python manually.\u001b[39m\u001b[39m\"\u001b[39m,\n\u001b[0;32m    349\u001b[0m         \u001b[39mRuntimeWarning\u001b[39;00m,\n\u001b[0;32m    350\u001b[0m         stacklevel\u001b[39m=\u001b[39mfind_stack_level(),\n\u001b[0;32m    351\u001b[0m     )\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:805\u001b[0m, in \u001b[0;36mExpr.__init__\u001b[1;34m(self, expr, engine, parser, env, level)\u001b[0m\n\u001b[0;32m    803\u001b[0m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mparser \u001b[39m=\u001b[39m parser\n\u001b[0;32m    804\u001b[0m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_visitor \u001b[39m=\u001b[39m PARSERS[parser](\u001b[39mself\u001b[39m\u001b[39m.\u001b[39menv, \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mengine, \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mparser)\n\u001b[1;32m--> 805\u001b[0m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mterms \u001b[39m=\u001b[39m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mparse()\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:824\u001b[0m, in \u001b[0;36mExpr.parse\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m    820\u001b[0m \u001b[39mdef\u001b[39;00m \u001b[39mparse\u001b[39m(\u001b[39mself\u001b[39m):\n\u001b[0;32m    821\u001b[0m \u001b[39m    \u001b[39m\u001b[39m\"\"\"\u001b[39;00m\n\u001b[0;32m    822\u001b[0m \u001b[39m    Parse an expression.\u001b[39;00m\n\u001b[0;32m    823\u001b[0m \u001b[39m    \"\"\"\u001b[39;00m\n\u001b[1;32m--> 824\u001b[0m     \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_visitor\u001b[39m.\u001b[39;49mvisit(\u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mexpr)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:411\u001b[0m, in \u001b[0;36mBaseExprVisitor.visit\u001b[1;34m(self, node, **kwargs)\u001b[0m\n\u001b[0;32m    409\u001b[0m method \u001b[39m=\u001b[39m \u001b[39mf\u001b[39m\u001b[39m\"\u001b[39m\u001b[39mvisit_\u001b[39m\u001b[39m{\u001b[39;00m\u001b[39mtype\u001b[39m(node)\u001b[39m.\u001b[39m\u001b[39m__name__\u001b[39m\u001b[39m}\u001b[39;00m\u001b[39m\"\u001b[39m\n\u001b[0;32m    410\u001b[0m visitor \u001b[39m=\u001b[39m \u001b[39mgetattr\u001b[39m(\u001b[39mself\u001b[39m, method)\n\u001b[1;32m--> 411\u001b[0m \u001b[39mreturn\u001b[39;00m visitor(node, \u001b[39m*\u001b[39;49m\u001b[39m*\u001b[39;49mkwargs)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:417\u001b[0m, in \u001b[0;36mBaseExprVisitor.visit_Module\u001b[1;34m(self, node, **kwargs)\u001b[0m\n\u001b[0;32m    415\u001b[0m     \u001b[39mraise\u001b[39;00m \u001b[39mSyntaxError\u001b[39;00m(\u001b[39m\"\u001b[39m\u001b[39monly a single expression is allowed\u001b[39m\u001b[39m\"\u001b[39m)\n\u001b[0;32m    416\u001b[0m expr \u001b[39m=\u001b[39m node\u001b[39m.\u001b[39mbody[\u001b[39m0\u001b[39m]\n\u001b[1;32m--> 417\u001b[0m \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mvisit(expr, \u001b[39m*\u001b[39;49m\u001b[39m*\u001b[39;49mkwargs)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:411\u001b[0m, in \u001b[0;36mBaseExprVisitor.visit\u001b[1;34m(self, node, **kwargs)\u001b[0m\n\u001b[0;32m    409\u001b[0m method \u001b[39m=\u001b[39m \u001b[39mf\u001b[39m\u001b[39m\"\u001b[39m\u001b[39mvisit_\u001b[39m\u001b[39m{\u001b[39;00m\u001b[39mtype\u001b[39m(node)\u001b[39m.\u001b[39m\u001b[39m__name__\u001b[39m\u001b[39m}\u001b[39;00m\u001b[39m\"\u001b[39m\n\u001b[0;32m    410\u001b[0m visitor \u001b[39m=\u001b[39m \u001b[39mgetattr\u001b[39m(\u001b[39mself\u001b[39m, method)\n\u001b[1;32m--> 411\u001b[0m \u001b[39mreturn\u001b[39;00m visitor(node, \u001b[39m*\u001b[39;49m\u001b[39m*\u001b[39;49mkwargs)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:420\u001b[0m, in \u001b[0;36mBaseExprVisitor.visit_Expr\u001b[1;34m(self, node, **kwargs)\u001b[0m\n\u001b[0;32m    419\u001b[0m \u001b[39mdef\u001b[39;00m \u001b[39mvisit_Expr\u001b[39m(\u001b[39mself\u001b[39m, node, \u001b[39m*\u001b[39m\u001b[39m*\u001b[39mkwargs):\n\u001b[1;32m--> 420\u001b[0m     \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mvisit(node\u001b[39m.\u001b[39;49mvalue, \u001b[39m*\u001b[39;49m\u001b[39m*\u001b[39;49mkwargs)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:411\u001b[0m, in \u001b[0;36mBaseExprVisitor.visit\u001b[1;34m(self, node, **kwargs)\u001b[0m\n\u001b[0;32m    409\u001b[0m method \u001b[39m=\u001b[39m \u001b[39mf\u001b[39m\u001b[39m\"\u001b[39m\u001b[39mvisit_\u001b[39m\u001b[39m{\u001b[39;00m\u001b[39mtype\u001b[39m(node)\u001b[39m.\u001b[39m\u001b[39m__name__\u001b[39m\u001b[39m}\u001b[39;00m\u001b[39m\"\u001b[39m\n\u001b[0;32m    410\u001b[0m visitor \u001b[39m=\u001b[39m \u001b[39mgetattr\u001b[39m(\u001b[39mself\u001b[39m, method)\n\u001b[1;32m--> 411\u001b[0m \u001b[39mreturn\u001b[39;00m visitor(node, \u001b[39m*\u001b[39;49m\u001b[39m*\u001b[39;49mkwargs)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:715\u001b[0m, in \u001b[0;36mBaseExprVisitor.visit_Compare\u001b[1;34m(self, node, **kwargs)\u001b[0m\n\u001b[0;32m    713\u001b[0m     op \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mtranslate_In(ops[\u001b[39m0\u001b[39m])\n\u001b[0;32m    714\u001b[0m     binop \u001b[39m=\u001b[39m ast\u001b[39m.\u001b[39mBinOp(op\u001b[39m=\u001b[39mop, left\u001b[39m=\u001b[39mnode\u001b[39m.\u001b[39mleft, right\u001b[39m=\u001b[39mcomps[\u001b[39m0\u001b[39m])\n\u001b[1;32m--> 715\u001b[0m     \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mvisit(binop)\n\u001b[0;32m    717\u001b[0m \u001b[39m# recursive case: we have a chained comparison, a CMP b CMP c, etc.\u001b[39;00m\n\u001b[0;32m    718\u001b[0m left \u001b[39m=\u001b[39m node\u001b[39m.\u001b[39mleft\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:411\u001b[0m, in \u001b[0;36mBaseExprVisitor.visit\u001b[1;34m(self, node, **kwargs)\u001b[0m\n\u001b[0;32m    409\u001b[0m method \u001b[39m=\u001b[39m \u001b[39mf\u001b[39m\u001b[39m\"\u001b[39m\u001b[39mvisit_\u001b[39m\u001b[39m{\u001b[39;00m\u001b[39mtype\u001b[39m(node)\u001b[39m.\u001b[39m\u001b[39m__name__\u001b[39m\u001b[39m}\u001b[39;00m\u001b[39m\"\u001b[39m\n\u001b[0;32m    410\u001b[0m visitor \u001b[39m=\u001b[39m \u001b[39mgetattr\u001b[39m(\u001b[39mself\u001b[39m, method)\n\u001b[1;32m--> 411\u001b[0m \u001b[39mreturn\u001b[39;00m visitor(node, \u001b[39m*\u001b[39;49m\u001b[39m*\u001b[39;49mkwargs)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:533\u001b[0m, in \u001b[0;36mBaseExprVisitor.visit_BinOp\u001b[1;34m(self, node, **kwargs)\u001b[0m\n\u001b[0;32m    531\u001b[0m op, op_class, left, right \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_maybe_transform_eq_ne(node)\n\u001b[0;32m    532\u001b[0m left, right \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_maybe_downcast_constants(left, right)\n\u001b[1;32m--> 533\u001b[0m \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_maybe_evaluate_binop(op, op_class, left, right)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:519\u001b[0m, in \u001b[0;36mBaseExprVisitor._maybe_evaluate_binop\u001b[1;34m(self, op, op_class, lhs, rhs, eval_in_python, maybe_eval_in_python)\u001b[0m\n\u001b[0;32m    515\u001b[0m     \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_maybe_eval(res, \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mbinary_ops)\n\u001b[0;32m    517\u001b[0m \u001b[39mif\u001b[39;00m res\u001b[39m.\u001b[39mop \u001b[39min\u001b[39;00m eval_in_python:\n\u001b[0;32m    518\u001b[0m     \u001b[39m# \"in\"/\"not in\" ops are always evaluated in python\u001b[39;00m\n\u001b[1;32m--> 519\u001b[0m     \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_maybe_eval(res, eval_in_python)\n\u001b[0;32m    520\u001b[0m \u001b[39melif\u001b[39;00m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mengine \u001b[39m!=\u001b[39m \u001b[39m\"\u001b[39m\u001b[39mpytables\u001b[39m\u001b[39m\"\u001b[39m:\n\u001b[0;32m    521\u001b[0m     \u001b[39mif\u001b[39;00m (\n\u001b[0;32m    522\u001b[0m         \u001b[39mgetattr\u001b[39m(lhs, \u001b[39m\"\u001b[39m\u001b[39mreturn_type\u001b[39m\u001b[39m\"\u001b[39m, \u001b[39mNone\u001b[39;00m) \u001b[39m==\u001b[39m \u001b[39mobject\u001b[39m\n\u001b[0;32m    523\u001b[0m         \u001b[39mor\u001b[39;00m \u001b[39mgetattr\u001b[39m(rhs, \u001b[39m\"\u001b[39m\u001b[39mreturn_type\u001b[39m\u001b[39m\"\u001b[39m, \u001b[39mNone\u001b[39;00m) \u001b[39m==\u001b[39m \u001b[39mobject\u001b[39m\n\u001b[0;32m    524\u001b[0m     ):\n\u001b[0;32m    525\u001b[0m         \u001b[39m# evaluate \"==\" and \"!=\" in python if either of our operands\u001b[39;00m\n\u001b[0;32m    526\u001b[0m         \u001b[39m# has an object return type\u001b[39;00m\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:487\u001b[0m, in \u001b[0;36mBaseExprVisitor._maybe_eval\u001b[1;34m(self, binop, eval_in_python)\u001b[0m\n\u001b[0;32m    480\u001b[0m \u001b[39mdef\u001b[39;00m \u001b[39m_maybe_eval\u001b[39m(\u001b[39mself\u001b[39m, binop, eval_in_python):\n\u001b[0;32m    481\u001b[0m     \u001b[39m# eval `in` and `not in` (for now) in \"partial\" python space\u001b[39;00m\n\u001b[0;32m    482\u001b[0m     \u001b[39m# things that can be evaluated in \"eval\" space will be turned into\u001b[39;00m\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    485\u001b[0m     \u001b[39m# in that case a + 2 * b will be evaluated using numexpr, and the \"in\"\u001b[39;00m\n\u001b[0;32m    486\u001b[0m     \u001b[39m# call will be evaluated using isin (in python space)\u001b[39;00m\n\u001b[1;32m--> 487\u001b[0m     \u001b[39mreturn\u001b[39;00m binop\u001b[39m.\u001b[39;49mevaluate(\n\u001b[0;32m    488\u001b[0m         \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49menv, \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mengine, \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mparser, \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mterm_type, eval_in_python\n\u001b[0;32m    489\u001b[0m     )\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\ops.py:405\u001b[0m, in \u001b[0;36mBinOp.evaluate\u001b[1;34m(self, env, engine, parser, term_type, eval_in_python)\u001b[0m\n\u001b[0;32m    388\u001b[0m \u001b[39m\u001b[39m\u001b[39m\"\"\"\u001b[39;00m\n\u001b[0;32m    389\u001b[0m \u001b[39mEvaluate a binary operation *before* being passed to the engine.\u001b[39;00m\n\u001b[0;32m    390\u001b[0m \n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    402\u001b[0m \u001b[39m    The \"pre-evaluated\" expression as an instance of ``term_type``\u001b[39;00m\n\u001b[0;32m    403\u001b[0m \u001b[39m\"\"\"\u001b[39;00m\n\u001b[0;32m    404\u001b[0m \u001b[39mif\u001b[39;00m engine \u001b[39m==\u001b[39m \u001b[39m\"\u001b[39m\u001b[39mpython\u001b[39m\u001b[39m\"\u001b[39m:\n\u001b[1;32m--> 405\u001b[0m     res \u001b[39m=\u001b[39m \u001b[39mself\u001b[39;49m(env)\n\u001b[0;32m    406\u001b[0m \u001b[39melse\u001b[39;00m:\n\u001b[0;32m    407\u001b[0m     \u001b[39m# recurse over the left/right nodes\u001b[39;00m\n\u001b[0;32m    409\u001b[0m     left \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mlhs\u001b[39m.\u001b[39mevaluate(\n\u001b[0;32m    410\u001b[0m         env,\n\u001b[0;32m    411\u001b[0m         engine\u001b[39m=\u001b[39mengine,\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    414\u001b[0m         eval_in_python\u001b[39m=\u001b[39meval_in_python,\n\u001b[0;32m    415\u001b[0m     )\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\ops.py:385\u001b[0m, in \u001b[0;36mBinOp.__call__\u001b[1;34m(self, env)\u001b[0m\n\u001b[0;32m    382\u001b[0m left \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mlhs(env)\n\u001b[0;32m    383\u001b[0m right \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mrhs(env)\n\u001b[1;32m--> 385\u001b[0m \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mfunc(left, right)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\ops.py:275\u001b[0m, in \u001b[0;36m_in\u001b[1;34m(x, y)\u001b[0m\n\u001b[0;32m    273\u001b[0m     \u001b[39mexcept\u001b[39;00m \u001b[39mAttributeError\u001b[39;00m:\n\u001b[0;32m    274\u001b[0m         \u001b[39mpass\u001b[39;00m\n\u001b[1;32m--> 275\u001b[0m \u001b[39mreturn\u001b[39;00m x \u001b[39min\u001b[39;49;00m y\n",
      "\u001b[1;31mTypeError\u001b[0m: argument of type 'bool' is not iterable"
     ]
    }
   ],
   "source": [
    "counties.query(\"'foreign_born_percentage' == True\")\n",
    "# Query the DataFrame to show only counties where percent_30 is True"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1aaaac2f-4892-4673-be1f-a174dff730b4",
   "metadata": {},
   "outputs": [
    {
     "ename": "TypeError",
     "evalue": "argument of type 'bool' is not iterable",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mAttributeError\u001b[0m                            Traceback (most recent call last)",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\ops.py:268\u001b[0m, in \u001b[0;36m_in\u001b[1;34m(x, y)\u001b[0m\n\u001b[0;32m    267\u001b[0m \u001b[39mtry\u001b[39;00m:\n\u001b[1;32m--> 268\u001b[0m     \u001b[39mreturn\u001b[39;00m x\u001b[39m.\u001b[39;49misin(y)\n\u001b[0;32m    269\u001b[0m \u001b[39mexcept\u001b[39;00m \u001b[39mAttributeError\u001b[39;00m:\n",
      "\u001b[1;31mAttributeError\u001b[0m: 'list' object has no attribute 'isin'",
      "\nDuring handling of the above exception, another exception occurred:\n",
      "\u001b[1;31mTypeError\u001b[0m                                 Traceback (most recent call last)",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\pandas_transform_variables.qmd:1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m counties\u001b[39m.\u001b[39;49mquery(\u001b[39m\"\u001b[39;49m\u001b[39m'\u001b[39;49m\u001b[39mforeign_born_pct_gt_30\u001b[39;49m\u001b[39m'\u001b[39;49m\u001b[39m == True\u001b[39;49m\u001b[39m\"\u001b[39;49m)\n\u001b[0;32m      2\u001b[0m \u001b[39m# Query the DataFrame to show only counties where percent_30 is True\u001b[39;00m\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\frame.py:4823\u001b[0m, in \u001b[0;36mDataFrame.query\u001b[1;34m(self, expr, inplace, **kwargs)\u001b[0m\n\u001b[0;32m   4821\u001b[0m kwargs[\u001b[39m\"\u001b[39m\u001b[39mlevel\u001b[39m\u001b[39m\"\u001b[39m] \u001b[39m=\u001b[39m kwargs\u001b[39m.\u001b[39mpop(\u001b[39m\"\u001b[39m\u001b[39mlevel\u001b[39m\u001b[39m\"\u001b[39m, \u001b[39m0\u001b[39m) \u001b[39m+\u001b[39m \u001b[39m1\u001b[39m\n\u001b[0;32m   4822\u001b[0m kwargs[\u001b[39m\"\u001b[39m\u001b[39mtarget\u001b[39m\u001b[39m\"\u001b[39m] \u001b[39m=\u001b[39m \u001b[39mNone\u001b[39;00m\n\u001b[1;32m-> 4823\u001b[0m res \u001b[39m=\u001b[39m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49meval(expr, \u001b[39m*\u001b[39;49m\u001b[39m*\u001b[39;49mkwargs)\n\u001b[0;32m   4825\u001b[0m \u001b[39mtry\u001b[39;00m:\n\u001b[0;32m   4826\u001b[0m     result \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mloc[res]\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\frame.py:4949\u001b[0m, in \u001b[0;36mDataFrame.eval\u001b[1;34m(self, expr, inplace, **kwargs)\u001b[0m\n\u001b[0;32m   4946\u001b[0m     kwargs[\u001b[39m\"\u001b[39m\u001b[39mtarget\u001b[39m\u001b[39m\"\u001b[39m] \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\n\u001b[0;32m   4947\u001b[0m kwargs[\u001b[39m\"\u001b[39m\u001b[39mresolvers\u001b[39m\u001b[39m\"\u001b[39m] \u001b[39m=\u001b[39m \u001b[39mtuple\u001b[39m(kwargs\u001b[39m.\u001b[39mget(\u001b[39m\"\u001b[39m\u001b[39mresolvers\u001b[39m\u001b[39m\"\u001b[39m, ())) \u001b[39m+\u001b[39m resolvers\n\u001b[1;32m-> 4949\u001b[0m \u001b[39mreturn\u001b[39;00m _eval(expr, inplace\u001b[39m=\u001b[39;49minplace, \u001b[39m*\u001b[39;49m\u001b[39m*\u001b[39;49mkwargs)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\eval.py:336\u001b[0m, in \u001b[0;36meval\u001b[1;34m(expr, parser, engine, local_dict, global_dict, resolvers, level, target, inplace)\u001b[0m\n\u001b[0;32m    327\u001b[0m \u001b[39m# get our (possibly passed-in) scope\u001b[39;00m\n\u001b[0;32m    328\u001b[0m env \u001b[39m=\u001b[39m ensure_scope(\n\u001b[0;32m    329\u001b[0m     level \u001b[39m+\u001b[39m \u001b[39m1\u001b[39m,\n\u001b[0;32m    330\u001b[0m     global_dict\u001b[39m=\u001b[39mglobal_dict,\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    333\u001b[0m     target\u001b[39m=\u001b[39mtarget,\n\u001b[0;32m    334\u001b[0m )\n\u001b[1;32m--> 336\u001b[0m parsed_expr \u001b[39m=\u001b[39m Expr(expr, engine\u001b[39m=\u001b[39;49mengine, parser\u001b[39m=\u001b[39;49mparser, env\u001b[39m=\u001b[39;49menv)\n\u001b[0;32m    338\u001b[0m \u001b[39mif\u001b[39;00m engine \u001b[39m==\u001b[39m \u001b[39m\"\u001b[39m\u001b[39mnumexpr\u001b[39m\u001b[39m\"\u001b[39m \u001b[39mand\u001b[39;00m (\n\u001b[0;32m    339\u001b[0m     is_extension_array_dtype(parsed_expr\u001b[39m.\u001b[39mterms\u001b[39m.\u001b[39mreturn_type)\n\u001b[0;32m    340\u001b[0m     \u001b[39mor\u001b[39;00m \u001b[39mgetattr\u001b[39m(parsed_expr\u001b[39m.\u001b[39mterms, \u001b[39m\"\u001b[39m\u001b[39moperand_types\u001b[39m\u001b[39m\"\u001b[39m, \u001b[39mNone\u001b[39;00m) \u001b[39mis\u001b[39;00m \u001b[39mnot\u001b[39;00m \u001b[39mNone\u001b[39;00m\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    344\u001b[0m     )\n\u001b[0;32m    345\u001b[0m ):\n\u001b[0;32m    346\u001b[0m     warnings\u001b[39m.\u001b[39mwarn(\n\u001b[0;32m    347\u001b[0m         \u001b[39m\"\u001b[39m\u001b[39mEngine has switched to \u001b[39m\u001b[39m'\u001b[39m\u001b[39mpython\u001b[39m\u001b[39m'\u001b[39m\u001b[39m because numexpr does not support \u001b[39m\u001b[39m\"\u001b[39m\n\u001b[0;32m    348\u001b[0m         \u001b[39m\"\u001b[39m\u001b[39mextension array dtypes. Please set your engine to python manually.\u001b[39m\u001b[39m\"\u001b[39m,\n\u001b[0;32m    349\u001b[0m         \u001b[39mRuntimeWarning\u001b[39;00m,\n\u001b[0;32m    350\u001b[0m         stacklevel\u001b[39m=\u001b[39mfind_stack_level(),\n\u001b[0;32m    351\u001b[0m     )\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:805\u001b[0m, in \u001b[0;36mExpr.__init__\u001b[1;34m(self, expr, engine, parser, env, level)\u001b[0m\n\u001b[0;32m    803\u001b[0m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mparser \u001b[39m=\u001b[39m parser\n\u001b[0;32m    804\u001b[0m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_visitor \u001b[39m=\u001b[39m PARSERS[parser](\u001b[39mself\u001b[39m\u001b[39m.\u001b[39menv, \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mengine, \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mparser)\n\u001b[1;32m--> 805\u001b[0m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mterms \u001b[39m=\u001b[39m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mparse()\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:824\u001b[0m, in \u001b[0;36mExpr.parse\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m    820\u001b[0m \u001b[39mdef\u001b[39;00m \u001b[39mparse\u001b[39m(\u001b[39mself\u001b[39m):\n\u001b[0;32m    821\u001b[0m \u001b[39m    \u001b[39m\u001b[39m\"\"\"\u001b[39;00m\n\u001b[0;32m    822\u001b[0m \u001b[39m    Parse an expression.\u001b[39;00m\n\u001b[0;32m    823\u001b[0m \u001b[39m    \"\"\"\u001b[39;00m\n\u001b[1;32m--> 824\u001b[0m     \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_visitor\u001b[39m.\u001b[39;49mvisit(\u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mexpr)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:411\u001b[0m, in \u001b[0;36mBaseExprVisitor.visit\u001b[1;34m(self, node, **kwargs)\u001b[0m\n\u001b[0;32m    409\u001b[0m method \u001b[39m=\u001b[39m \u001b[39mf\u001b[39m\u001b[39m\"\u001b[39m\u001b[39mvisit_\u001b[39m\u001b[39m{\u001b[39;00m\u001b[39mtype\u001b[39m(node)\u001b[39m.\u001b[39m\u001b[39m__name__\u001b[39m\u001b[39m}\u001b[39;00m\u001b[39m\"\u001b[39m\n\u001b[0;32m    410\u001b[0m visitor \u001b[39m=\u001b[39m \u001b[39mgetattr\u001b[39m(\u001b[39mself\u001b[39m, method)\n\u001b[1;32m--> 411\u001b[0m \u001b[39mreturn\u001b[39;00m visitor(node, \u001b[39m*\u001b[39;49m\u001b[39m*\u001b[39;49mkwargs)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:417\u001b[0m, in \u001b[0;36mBaseExprVisitor.visit_Module\u001b[1;34m(self, node, **kwargs)\u001b[0m\n\u001b[0;32m    415\u001b[0m     \u001b[39mraise\u001b[39;00m \u001b[39mSyntaxError\u001b[39;00m(\u001b[39m\"\u001b[39m\u001b[39monly a single expression is allowed\u001b[39m\u001b[39m\"\u001b[39m)\n\u001b[0;32m    416\u001b[0m expr \u001b[39m=\u001b[39m node\u001b[39m.\u001b[39mbody[\u001b[39m0\u001b[39m]\n\u001b[1;32m--> 417\u001b[0m \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mvisit(expr, \u001b[39m*\u001b[39;49m\u001b[39m*\u001b[39;49mkwargs)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:411\u001b[0m, in \u001b[0;36mBaseExprVisitor.visit\u001b[1;34m(self, node, **kwargs)\u001b[0m\n\u001b[0;32m    409\u001b[0m method \u001b[39m=\u001b[39m \u001b[39mf\u001b[39m\u001b[39m\"\u001b[39m\u001b[39mvisit_\u001b[39m\u001b[39m{\u001b[39;00m\u001b[39mtype\u001b[39m(node)\u001b[39m.\u001b[39m\u001b[39m__name__\u001b[39m\u001b[39m}\u001b[39;00m\u001b[39m\"\u001b[39m\n\u001b[0;32m    410\u001b[0m visitor \u001b[39m=\u001b[39m \u001b[39mgetattr\u001b[39m(\u001b[39mself\u001b[39m, method)\n\u001b[1;32m--> 411\u001b[0m \u001b[39mreturn\u001b[39;00m visitor(node, \u001b[39m*\u001b[39;49m\u001b[39m*\u001b[39;49mkwargs)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:420\u001b[0m, in \u001b[0;36mBaseExprVisitor.visit_Expr\u001b[1;34m(self, node, **kwargs)\u001b[0m\n\u001b[0;32m    419\u001b[0m \u001b[39mdef\u001b[39;00m \u001b[39mvisit_Expr\u001b[39m(\u001b[39mself\u001b[39m, node, \u001b[39m*\u001b[39m\u001b[39m*\u001b[39mkwargs):\n\u001b[1;32m--> 420\u001b[0m     \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mvisit(node\u001b[39m.\u001b[39;49mvalue, \u001b[39m*\u001b[39;49m\u001b[39m*\u001b[39;49mkwargs)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:411\u001b[0m, in \u001b[0;36mBaseExprVisitor.visit\u001b[1;34m(self, node, **kwargs)\u001b[0m\n\u001b[0;32m    409\u001b[0m method \u001b[39m=\u001b[39m \u001b[39mf\u001b[39m\u001b[39m\"\u001b[39m\u001b[39mvisit_\u001b[39m\u001b[39m{\u001b[39;00m\u001b[39mtype\u001b[39m(node)\u001b[39m.\u001b[39m\u001b[39m__name__\u001b[39m\u001b[39m}\u001b[39;00m\u001b[39m\"\u001b[39m\n\u001b[0;32m    410\u001b[0m visitor \u001b[39m=\u001b[39m \u001b[39mgetattr\u001b[39m(\u001b[39mself\u001b[39m, method)\n\u001b[1;32m--> 411\u001b[0m \u001b[39mreturn\u001b[39;00m visitor(node, \u001b[39m*\u001b[39;49m\u001b[39m*\u001b[39;49mkwargs)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:715\u001b[0m, in \u001b[0;36mBaseExprVisitor.visit_Compare\u001b[1;34m(self, node, **kwargs)\u001b[0m\n\u001b[0;32m    713\u001b[0m     op \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mtranslate_In(ops[\u001b[39m0\u001b[39m])\n\u001b[0;32m    714\u001b[0m     binop \u001b[39m=\u001b[39m ast\u001b[39m.\u001b[39mBinOp(op\u001b[39m=\u001b[39mop, left\u001b[39m=\u001b[39mnode\u001b[39m.\u001b[39mleft, right\u001b[39m=\u001b[39mcomps[\u001b[39m0\u001b[39m])\n\u001b[1;32m--> 715\u001b[0m     \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mvisit(binop)\n\u001b[0;32m    717\u001b[0m \u001b[39m# recursive case: we have a chained comparison, a CMP b CMP c, etc.\u001b[39;00m\n\u001b[0;32m    718\u001b[0m left \u001b[39m=\u001b[39m node\u001b[39m.\u001b[39mleft\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:411\u001b[0m, in \u001b[0;36mBaseExprVisitor.visit\u001b[1;34m(self, node, **kwargs)\u001b[0m\n\u001b[0;32m    409\u001b[0m method \u001b[39m=\u001b[39m \u001b[39mf\u001b[39m\u001b[39m\"\u001b[39m\u001b[39mvisit_\u001b[39m\u001b[39m{\u001b[39;00m\u001b[39mtype\u001b[39m(node)\u001b[39m.\u001b[39m\u001b[39m__name__\u001b[39m\u001b[39m}\u001b[39;00m\u001b[39m\"\u001b[39m\n\u001b[0;32m    410\u001b[0m visitor \u001b[39m=\u001b[39m \u001b[39mgetattr\u001b[39m(\u001b[39mself\u001b[39m, method)\n\u001b[1;32m--> 411\u001b[0m \u001b[39mreturn\u001b[39;00m visitor(node, \u001b[39m*\u001b[39;49m\u001b[39m*\u001b[39;49mkwargs)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:533\u001b[0m, in \u001b[0;36mBaseExprVisitor.visit_BinOp\u001b[1;34m(self, node, **kwargs)\u001b[0m\n\u001b[0;32m    531\u001b[0m op, op_class, left, right \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_maybe_transform_eq_ne(node)\n\u001b[0;32m    532\u001b[0m left, right \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_maybe_downcast_constants(left, right)\n\u001b[1;32m--> 533\u001b[0m \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_maybe_evaluate_binop(op, op_class, left, right)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:519\u001b[0m, in \u001b[0;36mBaseExprVisitor._maybe_evaluate_binop\u001b[1;34m(self, op, op_class, lhs, rhs, eval_in_python, maybe_eval_in_python)\u001b[0m\n\u001b[0;32m    515\u001b[0m     \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_maybe_eval(res, \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mbinary_ops)\n\u001b[0;32m    517\u001b[0m \u001b[39mif\u001b[39;00m res\u001b[39m.\u001b[39mop \u001b[39min\u001b[39;00m eval_in_python:\n\u001b[0;32m    518\u001b[0m     \u001b[39m# \"in\"/\"not in\" ops are always evaluated in python\u001b[39;00m\n\u001b[1;32m--> 519\u001b[0m     \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_maybe_eval(res, eval_in_python)\n\u001b[0;32m    520\u001b[0m \u001b[39melif\u001b[39;00m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mengine \u001b[39m!=\u001b[39m \u001b[39m\"\u001b[39m\u001b[39mpytables\u001b[39m\u001b[39m\"\u001b[39m:\n\u001b[0;32m    521\u001b[0m     \u001b[39mif\u001b[39;00m (\n\u001b[0;32m    522\u001b[0m         \u001b[39mgetattr\u001b[39m(lhs, \u001b[39m\"\u001b[39m\u001b[39mreturn_type\u001b[39m\u001b[39m\"\u001b[39m, \u001b[39mNone\u001b[39;00m) \u001b[39m==\u001b[39m \u001b[39mobject\u001b[39m\n\u001b[0;32m    523\u001b[0m         \u001b[39mor\u001b[39;00m \u001b[39mgetattr\u001b[39m(rhs, \u001b[39m\"\u001b[39m\u001b[39mreturn_type\u001b[39m\u001b[39m\"\u001b[39m, \u001b[39mNone\u001b[39;00m) \u001b[39m==\u001b[39m \u001b[39mobject\u001b[39m\n\u001b[0;32m    524\u001b[0m     ):\n\u001b[0;32m    525\u001b[0m         \u001b[39m# evaluate \"==\" and \"!=\" in python if either of our operands\u001b[39;00m\n\u001b[0;32m    526\u001b[0m         \u001b[39m# has an object return type\u001b[39;00m\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:487\u001b[0m, in \u001b[0;36mBaseExprVisitor._maybe_eval\u001b[1;34m(self, binop, eval_in_python)\u001b[0m\n\u001b[0;32m    480\u001b[0m \u001b[39mdef\u001b[39;00m \u001b[39m_maybe_eval\u001b[39m(\u001b[39mself\u001b[39m, binop, eval_in_python):\n\u001b[0;32m    481\u001b[0m     \u001b[39m# eval `in` and `not in` (for now) in \"partial\" python space\u001b[39;00m\n\u001b[0;32m    482\u001b[0m     \u001b[39m# things that can be evaluated in \"eval\" space will be turned into\u001b[39;00m\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    485\u001b[0m     \u001b[39m# in that case a + 2 * b will be evaluated using numexpr, and the \"in\"\u001b[39;00m\n\u001b[0;32m    486\u001b[0m     \u001b[39m# call will be evaluated using isin (in python space)\u001b[39;00m\n\u001b[1;32m--> 487\u001b[0m     \u001b[39mreturn\u001b[39;00m binop\u001b[39m.\u001b[39;49mevaluate(\n\u001b[0;32m    488\u001b[0m         \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49menv, \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mengine, \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mparser, \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mterm_type, eval_in_python\n\u001b[0;32m    489\u001b[0m     )\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\ops.py:405\u001b[0m, in \u001b[0;36mBinOp.evaluate\u001b[1;34m(self, env, engine, parser, term_type, eval_in_python)\u001b[0m\n\u001b[0;32m    388\u001b[0m \u001b[39m\u001b[39m\u001b[39m\"\"\"\u001b[39;00m\n\u001b[0;32m    389\u001b[0m \u001b[39mEvaluate a binary operation *before* being passed to the engine.\u001b[39;00m\n\u001b[0;32m    390\u001b[0m \n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    402\u001b[0m \u001b[39m    The \"pre-evaluated\" expression as an instance of ``term_type``\u001b[39;00m\n\u001b[0;32m    403\u001b[0m \u001b[39m\"\"\"\u001b[39;00m\n\u001b[0;32m    404\u001b[0m \u001b[39mif\u001b[39;00m engine \u001b[39m==\u001b[39m \u001b[39m\"\u001b[39m\u001b[39mpython\u001b[39m\u001b[39m\"\u001b[39m:\n\u001b[1;32m--> 405\u001b[0m     res \u001b[39m=\u001b[39m \u001b[39mself\u001b[39;49m(env)\n\u001b[0;32m    406\u001b[0m \u001b[39melse\u001b[39;00m:\n\u001b[0;32m    407\u001b[0m     \u001b[39m# recurse over the left/right nodes\u001b[39;00m\n\u001b[0;32m    409\u001b[0m     left \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mlhs\u001b[39m.\u001b[39mevaluate(\n\u001b[0;32m    410\u001b[0m         env,\n\u001b[0;32m    411\u001b[0m         engine\u001b[39m=\u001b[39mengine,\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    414\u001b[0m         eval_in_python\u001b[39m=\u001b[39meval_in_python,\n\u001b[0;32m    415\u001b[0m     )\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\ops.py:385\u001b[0m, in \u001b[0;36mBinOp.__call__\u001b[1;34m(self, env)\u001b[0m\n\u001b[0;32m    382\u001b[0m left \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mlhs(env)\n\u001b[0;32m    383\u001b[0m right \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mrhs(env)\n\u001b[1;32m--> 385\u001b[0m \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mfunc(left, right)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\ops.py:275\u001b[0m, in \u001b[0;36m_in\u001b[1;34m(x, y)\u001b[0m\n\u001b[0;32m    273\u001b[0m     \u001b[39mexcept\u001b[39;00m \u001b[39mAttributeError\u001b[39;00m:\n\u001b[0;32m    274\u001b[0m         \u001b[39mpass\u001b[39;00m\n\u001b[1;32m--> 275\u001b[0m \u001b[39mreturn\u001b[39;00m x \u001b[39min\u001b[39;49;00m y\n",
      "\u001b[1;31mTypeError\u001b[0m: argument of type 'bool' is not iterable"
     ]
    }
   ],
   "source": [
    "counties.query(\"'foreign_born_pct_gt_30' == True\")\n",
    "# Query the DataFrame to show only counties where percent_30 is True"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>state</th>\n",
       "      <th>county</th>\n",
       "      <th>pop_20</th>\n",
       "      <th>area_sq_miles</th>\n",
       "      <th>hh_inc_21</th>\n",
       "      <th>econ_type</th>\n",
       "      <th>unemp_20</th>\n",
       "      <th>foreign_born_num</th>\n",
       "      <th>pop_change_2010_2020</th>\n",
       "      <th>pct_emp_change_2010_2021</th>\n",
       "      <th>foreign_born_percentage</th>\n",
       "      <th>foreign_born_pct_gt_30</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AL</td>\n",
       "      <td>Autauga, AL</td>\n",
       "      <td>58877.0</td>\n",
       "      <td>594.456107</td>\n",
       "      <td>66444.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>5.4</td>\n",
       "      <td>1241.0</td>\n",
       "      <td>7.758700</td>\n",
       "      <td>9.0</td>\n",
       "      <td>2.107784</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AL</td>\n",
       "      <td>Baldwin, AL</td>\n",
       "      <td>233140.0</td>\n",
       "      <td>1589.836014</td>\n",
       "      <td>65658.0</td>\n",
       "      <td>Recreation</td>\n",
       "      <td>6.2</td>\n",
       "      <td>7938.0</td>\n",
       "      <td>27.159356</td>\n",
       "      <td>28.2</td>\n",
       "      <td>3.404821</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AL</td>\n",
       "      <td>Barbour, AL</td>\n",
       "      <td>25180.0</td>\n",
       "      <td>885.008019</td>\n",
       "      <td>38649.0</td>\n",
       "      <td>Manufacturing</td>\n",
       "      <td>7.8</td>\n",
       "      <td>659.0</td>\n",
       "      <td>-8.136359</td>\n",
       "      <td>-13.9</td>\n",
       "      <td>2.617156</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>AL</td>\n",
       "      <td>Bibb, AL</td>\n",
       "      <td>22223.0</td>\n",
       "      <td>622.469570</td>\n",
       "      <td>48454.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>7.3</td>\n",
       "      <td>245.0</td>\n",
       "      <td>-2.714379</td>\n",
       "      <td>4.2</td>\n",
       "      <td>1.102461</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AL</td>\n",
       "      <td>Blount, AL</td>\n",
       "      <td>59081.0</td>\n",
       "      <td>644.890667</td>\n",
       "      <td>56894.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>4.6</td>\n",
       "      <td>2650.0</td>\n",
       "      <td>3.161090</td>\n",
       "      <td>9.0</td>\n",
       "      <td>4.485368</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3221</th>\n",
       "      <td>PR</td>\n",
       "      <td>Vega Baja, PR</td>\n",
       "      <td>54322.0</td>\n",
       "      <td>45.847734</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-8.796219</td>\n",
       "      <td>-0.9</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3222</th>\n",
       "      <td>PR</td>\n",
       "      <td>Vieques, PR</td>\n",
       "      <td>8242.0</td>\n",
       "      <td>50.788416</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-11.310612</td>\n",
       "      <td>-12.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3223</th>\n",
       "      <td>PR</td>\n",
       "      <td>Villalba, PR</td>\n",
       "      <td>22044.0</td>\n",
       "      <td>35.636678</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-15.264833</td>\n",
       "      <td>-1.2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3224</th>\n",
       "      <td>PR</td>\n",
       "      <td>Yabucoa, PR</td>\n",
       "      <td>30364.0</td>\n",
       "      <td>55.214614</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-19.807069</td>\n",
       "      <td>0.1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3225</th>\n",
       "      <td>PR</td>\n",
       "      <td>Yauco, PR</td>\n",
       "      <td>34062.0</td>\n",
       "      <td>67.711484</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-18.721309</td>\n",
       "      <td>-5.3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3226 rows Ã— 12 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     state         county    pop_20  area_sq_miles  hh_inc_21       econ_type  \\\n",
       "0       AL    Autauga, AL   58877.0     594.456107    66444.0  Nonspecialized   \n",
       "1       AL    Baldwin, AL  233140.0    1589.836014    65658.0      Recreation   \n",
       "2       AL    Barbour, AL   25180.0     885.008019    38649.0   Manufacturing   \n",
       "3       AL       Bibb, AL   22223.0     622.469570    48454.0  Nonspecialized   \n",
       "4       AL     Blount, AL   59081.0     644.890667    56894.0  Nonspecialized   \n",
       "...    ...            ...       ...            ...        ...             ...   \n",
       "3221    PR  Vega Baja, PR   54322.0      45.847734        NaN             NaN   \n",
       "3222    PR    Vieques, PR    8242.0      50.788416        NaN             NaN   \n",
       "3223    PR   Villalba, PR   22044.0      35.636678        NaN             NaN   \n",
       "3224    PR    Yabucoa, PR   30364.0      55.214614        NaN             NaN   \n",
       "3225    PR      Yauco, PR   34062.0      67.711484        NaN             NaN   \n",
       "\n",
       "      unemp_20  foreign_born_num  pop_change_2010_2020  \\\n",
       "0          5.4            1241.0              7.758700   \n",
       "1          6.2            7938.0             27.159356   \n",
       "2          7.8             659.0             -8.136359   \n",
       "3          7.3             245.0             -2.714379   \n",
       "4          4.6            2650.0              3.161090   \n",
       "...        ...               ...                   ...   \n",
       "3221       NaN               NaN             -8.796219   \n",
       "3222       NaN               NaN            -11.310612   \n",
       "3223       NaN               NaN            -15.264833   \n",
       "3224       NaN               NaN            -19.807069   \n",
       "3225       NaN               NaN            -18.721309   \n",
       "\n",
       "      pct_emp_change_2010_2021  foreign_born_percentage  \\\n",
       "0                          9.0                 2.107784   \n",
       "1                         28.2                 3.404821   \n",
       "2                        -13.9                 2.617156   \n",
       "3                          4.2                 1.102461   \n",
       "4                          9.0                 4.485368   \n",
       "...                        ...                      ...   \n",
       "3221                      -0.9                      NaN   \n",
       "3222                     -12.0                      NaN   \n",
       "3223                      -1.2                      NaN   \n",
       "3224                       0.1                      NaN   \n",
       "3225                      -5.3                      NaN   \n",
       "\n",
       "      foreign_born_pct_gt_30  \n",
       "0                      False  \n",
       "1                      False  \n",
       "2                      False  \n",
       "3                      False  \n",
       "4                      False  \n",
       "...                      ...  \n",
       "3221                   False  \n",
       "3222                   False  \n",
       "3223                   False  \n",
       "3224                   False  \n",
       "3225                   False  \n",
       "\n",
       "[3226 rows x 12 columns]"
      ]
     },
     "execution_count": 69,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "counties"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a5a211d2-ba88-42b3-b121-229d78343793",
   "metadata": {},
   "outputs": [
    {
     "ename": "TypeError",
     "evalue": "argument of type 'bool' is not iterable",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mAttributeError\u001b[0m                            Traceback (most recent call last)",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\ops.py:268\u001b[0m, in \u001b[0;36m_in\u001b[1;34m(x, y)\u001b[0m\n\u001b[0;32m    267\u001b[0m \u001b[39mtry\u001b[39;00m:\n\u001b[1;32m--> 268\u001b[0m     \u001b[39mreturn\u001b[39;00m x\u001b[39m.\u001b[39;49misin(y)\n\u001b[0;32m    269\u001b[0m \u001b[39mexcept\u001b[39;00m \u001b[39mAttributeError\u001b[39;00m:\n",
      "\u001b[1;31mAttributeError\u001b[0m: 'list' object has no attribute 'isin'",
      "\nDuring handling of the above exception, another exception occurred:\n",
      "\u001b[1;31mTypeError\u001b[0m                                 Traceback (most recent call last)",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\pandas_transform_variables.qmd:1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m counties\u001b[39m.\u001b[39;49mquery(\u001b[39m\"\u001b[39;49m\u001b[39m'\u001b[39;49m\u001b[39mforeign_born_pct_gt_30\u001b[39;49m\u001b[39m'\u001b[39;49m\u001b[39m == True\u001b[39;49m\u001b[39m\"\u001b[39;49m)\n\u001b[0;32m      2\u001b[0m \u001b[39m# Query the DataFrame to show only counties where percent_30 is True\u001b[39;00m\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\frame.py:4823\u001b[0m, in \u001b[0;36mDataFrame.query\u001b[1;34m(self, expr, inplace, **kwargs)\u001b[0m\n\u001b[0;32m   4821\u001b[0m kwargs[\u001b[39m\"\u001b[39m\u001b[39mlevel\u001b[39m\u001b[39m\"\u001b[39m] \u001b[39m=\u001b[39m kwargs\u001b[39m.\u001b[39mpop(\u001b[39m\"\u001b[39m\u001b[39mlevel\u001b[39m\u001b[39m\"\u001b[39m, \u001b[39m0\u001b[39m) \u001b[39m+\u001b[39m \u001b[39m1\u001b[39m\n\u001b[0;32m   4822\u001b[0m kwargs[\u001b[39m\"\u001b[39m\u001b[39mtarget\u001b[39m\u001b[39m\"\u001b[39m] \u001b[39m=\u001b[39m \u001b[39mNone\u001b[39;00m\n\u001b[1;32m-> 4823\u001b[0m res \u001b[39m=\u001b[39m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49meval(expr, \u001b[39m*\u001b[39;49m\u001b[39m*\u001b[39;49mkwargs)\n\u001b[0;32m   4825\u001b[0m \u001b[39mtry\u001b[39;00m:\n\u001b[0;32m   4826\u001b[0m     result \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mloc[res]\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\frame.py:4949\u001b[0m, in \u001b[0;36mDataFrame.eval\u001b[1;34m(self, expr, inplace, **kwargs)\u001b[0m\n\u001b[0;32m   4946\u001b[0m     kwargs[\u001b[39m\"\u001b[39m\u001b[39mtarget\u001b[39m\u001b[39m\"\u001b[39m] \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\n\u001b[0;32m   4947\u001b[0m kwargs[\u001b[39m\"\u001b[39m\u001b[39mresolvers\u001b[39m\u001b[39m\"\u001b[39m] \u001b[39m=\u001b[39m \u001b[39mtuple\u001b[39m(kwargs\u001b[39m.\u001b[39mget(\u001b[39m\"\u001b[39m\u001b[39mresolvers\u001b[39m\u001b[39m\"\u001b[39m, ())) \u001b[39m+\u001b[39m resolvers\n\u001b[1;32m-> 4949\u001b[0m \u001b[39mreturn\u001b[39;00m _eval(expr, inplace\u001b[39m=\u001b[39;49minplace, \u001b[39m*\u001b[39;49m\u001b[39m*\u001b[39;49mkwargs)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\eval.py:336\u001b[0m, in \u001b[0;36meval\u001b[1;34m(expr, parser, engine, local_dict, global_dict, resolvers, level, target, inplace)\u001b[0m\n\u001b[0;32m    327\u001b[0m \u001b[39m# get our (possibly passed-in) scope\u001b[39;00m\n\u001b[0;32m    328\u001b[0m env \u001b[39m=\u001b[39m ensure_scope(\n\u001b[0;32m    329\u001b[0m     level \u001b[39m+\u001b[39m \u001b[39m1\u001b[39m,\n\u001b[0;32m    330\u001b[0m     global_dict\u001b[39m=\u001b[39mglobal_dict,\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    333\u001b[0m     target\u001b[39m=\u001b[39mtarget,\n\u001b[0;32m    334\u001b[0m )\n\u001b[1;32m--> 336\u001b[0m parsed_expr \u001b[39m=\u001b[39m Expr(expr, engine\u001b[39m=\u001b[39;49mengine, parser\u001b[39m=\u001b[39;49mparser, env\u001b[39m=\u001b[39;49menv)\n\u001b[0;32m    338\u001b[0m \u001b[39mif\u001b[39;00m engine \u001b[39m==\u001b[39m \u001b[39m\"\u001b[39m\u001b[39mnumexpr\u001b[39m\u001b[39m\"\u001b[39m \u001b[39mand\u001b[39;00m (\n\u001b[0;32m    339\u001b[0m     is_extension_array_dtype(parsed_expr\u001b[39m.\u001b[39mterms\u001b[39m.\u001b[39mreturn_type)\n\u001b[0;32m    340\u001b[0m     \u001b[39mor\u001b[39;00m \u001b[39mgetattr\u001b[39m(parsed_expr\u001b[39m.\u001b[39mterms, \u001b[39m\"\u001b[39m\u001b[39moperand_types\u001b[39m\u001b[39m\"\u001b[39m, \u001b[39mNone\u001b[39;00m) \u001b[39mis\u001b[39;00m \u001b[39mnot\u001b[39;00m \u001b[39mNone\u001b[39;00m\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    344\u001b[0m     )\n\u001b[0;32m    345\u001b[0m ):\n\u001b[0;32m    346\u001b[0m     warnings\u001b[39m.\u001b[39mwarn(\n\u001b[0;32m    347\u001b[0m         \u001b[39m\"\u001b[39m\u001b[39mEngine has switched to \u001b[39m\u001b[39m'\u001b[39m\u001b[39mpython\u001b[39m\u001b[39m'\u001b[39m\u001b[39m because numexpr does not support \u001b[39m\u001b[39m\"\u001b[39m\n\u001b[0;32m    348\u001b[0m         \u001b[39m\"\u001b[39m\u001b[39mextension array dtypes. Please set your engine to python manually.\u001b[39m\u001b[39m\"\u001b[39m,\n\u001b[0;32m    349\u001b[0m         \u001b[39mRuntimeWarning\u001b[39;00m,\n\u001b[0;32m    350\u001b[0m         stacklevel\u001b[39m=\u001b[39mfind_stack_level(),\n\u001b[0;32m    351\u001b[0m     )\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:805\u001b[0m, in \u001b[0;36mExpr.__init__\u001b[1;34m(self, expr, engine, parser, env, level)\u001b[0m\n\u001b[0;32m    803\u001b[0m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mparser \u001b[39m=\u001b[39m parser\n\u001b[0;32m    804\u001b[0m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_visitor \u001b[39m=\u001b[39m PARSERS[parser](\u001b[39mself\u001b[39m\u001b[39m.\u001b[39menv, \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mengine, \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mparser)\n\u001b[1;32m--> 805\u001b[0m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mterms \u001b[39m=\u001b[39m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mparse()\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:824\u001b[0m, in \u001b[0;36mExpr.parse\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m    820\u001b[0m \u001b[39mdef\u001b[39;00m \u001b[39mparse\u001b[39m(\u001b[39mself\u001b[39m):\n\u001b[0;32m    821\u001b[0m \u001b[39m    \u001b[39m\u001b[39m\"\"\"\u001b[39;00m\n\u001b[0;32m    822\u001b[0m \u001b[39m    Parse an expression.\u001b[39;00m\n\u001b[0;32m    823\u001b[0m \u001b[39m    \"\"\"\u001b[39;00m\n\u001b[1;32m--> 824\u001b[0m     \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_visitor\u001b[39m.\u001b[39;49mvisit(\u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mexpr)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:411\u001b[0m, in \u001b[0;36mBaseExprVisitor.visit\u001b[1;34m(self, node, **kwargs)\u001b[0m\n\u001b[0;32m    409\u001b[0m method \u001b[39m=\u001b[39m \u001b[39mf\u001b[39m\u001b[39m\"\u001b[39m\u001b[39mvisit_\u001b[39m\u001b[39m{\u001b[39;00m\u001b[39mtype\u001b[39m(node)\u001b[39m.\u001b[39m\u001b[39m__name__\u001b[39m\u001b[39m}\u001b[39;00m\u001b[39m\"\u001b[39m\n\u001b[0;32m    410\u001b[0m visitor \u001b[39m=\u001b[39m \u001b[39mgetattr\u001b[39m(\u001b[39mself\u001b[39m, method)\n\u001b[1;32m--> 411\u001b[0m \u001b[39mreturn\u001b[39;00m visitor(node, \u001b[39m*\u001b[39;49m\u001b[39m*\u001b[39;49mkwargs)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:417\u001b[0m, in \u001b[0;36mBaseExprVisitor.visit_Module\u001b[1;34m(self, node, **kwargs)\u001b[0m\n\u001b[0;32m    415\u001b[0m     \u001b[39mraise\u001b[39;00m \u001b[39mSyntaxError\u001b[39;00m(\u001b[39m\"\u001b[39m\u001b[39monly a single expression is allowed\u001b[39m\u001b[39m\"\u001b[39m)\n\u001b[0;32m    416\u001b[0m expr \u001b[39m=\u001b[39m node\u001b[39m.\u001b[39mbody[\u001b[39m0\u001b[39m]\n\u001b[1;32m--> 417\u001b[0m \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mvisit(expr, \u001b[39m*\u001b[39;49m\u001b[39m*\u001b[39;49mkwargs)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:411\u001b[0m, in \u001b[0;36mBaseExprVisitor.visit\u001b[1;34m(self, node, **kwargs)\u001b[0m\n\u001b[0;32m    409\u001b[0m method \u001b[39m=\u001b[39m \u001b[39mf\u001b[39m\u001b[39m\"\u001b[39m\u001b[39mvisit_\u001b[39m\u001b[39m{\u001b[39;00m\u001b[39mtype\u001b[39m(node)\u001b[39m.\u001b[39m\u001b[39m__name__\u001b[39m\u001b[39m}\u001b[39;00m\u001b[39m\"\u001b[39m\n\u001b[0;32m    410\u001b[0m visitor \u001b[39m=\u001b[39m \u001b[39mgetattr\u001b[39m(\u001b[39mself\u001b[39m, method)\n\u001b[1;32m--> 411\u001b[0m \u001b[39mreturn\u001b[39;00m visitor(node, \u001b[39m*\u001b[39;49m\u001b[39m*\u001b[39;49mkwargs)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:420\u001b[0m, in \u001b[0;36mBaseExprVisitor.visit_Expr\u001b[1;34m(self, node, **kwargs)\u001b[0m\n\u001b[0;32m    419\u001b[0m \u001b[39mdef\u001b[39;00m \u001b[39mvisit_Expr\u001b[39m(\u001b[39mself\u001b[39m, node, \u001b[39m*\u001b[39m\u001b[39m*\u001b[39mkwargs):\n\u001b[1;32m--> 420\u001b[0m     \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mvisit(node\u001b[39m.\u001b[39;49mvalue, \u001b[39m*\u001b[39;49m\u001b[39m*\u001b[39;49mkwargs)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:411\u001b[0m, in \u001b[0;36mBaseExprVisitor.visit\u001b[1;34m(self, node, **kwargs)\u001b[0m\n\u001b[0;32m    409\u001b[0m method \u001b[39m=\u001b[39m \u001b[39mf\u001b[39m\u001b[39m\"\u001b[39m\u001b[39mvisit_\u001b[39m\u001b[39m{\u001b[39;00m\u001b[39mtype\u001b[39m(node)\u001b[39m.\u001b[39m\u001b[39m__name__\u001b[39m\u001b[39m}\u001b[39;00m\u001b[39m\"\u001b[39m\n\u001b[0;32m    410\u001b[0m visitor \u001b[39m=\u001b[39m \u001b[39mgetattr\u001b[39m(\u001b[39mself\u001b[39m, method)\n\u001b[1;32m--> 411\u001b[0m \u001b[39mreturn\u001b[39;00m visitor(node, \u001b[39m*\u001b[39;49m\u001b[39m*\u001b[39;49mkwargs)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:715\u001b[0m, in \u001b[0;36mBaseExprVisitor.visit_Compare\u001b[1;34m(self, node, **kwargs)\u001b[0m\n\u001b[0;32m    713\u001b[0m     op \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mtranslate_In(ops[\u001b[39m0\u001b[39m])\n\u001b[0;32m    714\u001b[0m     binop \u001b[39m=\u001b[39m ast\u001b[39m.\u001b[39mBinOp(op\u001b[39m=\u001b[39mop, left\u001b[39m=\u001b[39mnode\u001b[39m.\u001b[39mleft, right\u001b[39m=\u001b[39mcomps[\u001b[39m0\u001b[39m])\n\u001b[1;32m--> 715\u001b[0m     \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mvisit(binop)\n\u001b[0;32m    717\u001b[0m \u001b[39m# recursive case: we have a chained comparison, a CMP b CMP c, etc.\u001b[39;00m\n\u001b[0;32m    718\u001b[0m left \u001b[39m=\u001b[39m node\u001b[39m.\u001b[39mleft\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:411\u001b[0m, in \u001b[0;36mBaseExprVisitor.visit\u001b[1;34m(self, node, **kwargs)\u001b[0m\n\u001b[0;32m    409\u001b[0m method \u001b[39m=\u001b[39m \u001b[39mf\u001b[39m\u001b[39m\"\u001b[39m\u001b[39mvisit_\u001b[39m\u001b[39m{\u001b[39;00m\u001b[39mtype\u001b[39m(node)\u001b[39m.\u001b[39m\u001b[39m__name__\u001b[39m\u001b[39m}\u001b[39;00m\u001b[39m\"\u001b[39m\n\u001b[0;32m    410\u001b[0m visitor \u001b[39m=\u001b[39m \u001b[39mgetattr\u001b[39m(\u001b[39mself\u001b[39m, method)\n\u001b[1;32m--> 411\u001b[0m \u001b[39mreturn\u001b[39;00m visitor(node, \u001b[39m*\u001b[39;49m\u001b[39m*\u001b[39;49mkwargs)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:533\u001b[0m, in \u001b[0;36mBaseExprVisitor.visit_BinOp\u001b[1;34m(self, node, **kwargs)\u001b[0m\n\u001b[0;32m    531\u001b[0m op, op_class, left, right \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_maybe_transform_eq_ne(node)\n\u001b[0;32m    532\u001b[0m left, right \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_maybe_downcast_constants(left, right)\n\u001b[1;32m--> 533\u001b[0m \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_maybe_evaluate_binop(op, op_class, left, right)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:519\u001b[0m, in \u001b[0;36mBaseExprVisitor._maybe_evaluate_binop\u001b[1;34m(self, op, op_class, lhs, rhs, eval_in_python, maybe_eval_in_python)\u001b[0m\n\u001b[0;32m    515\u001b[0m     \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_maybe_eval(res, \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mbinary_ops)\n\u001b[0;32m    517\u001b[0m \u001b[39mif\u001b[39;00m res\u001b[39m.\u001b[39mop \u001b[39min\u001b[39;00m eval_in_python:\n\u001b[0;32m    518\u001b[0m     \u001b[39m# \"in\"/\"not in\" ops are always evaluated in python\u001b[39;00m\n\u001b[1;32m--> 519\u001b[0m     \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_maybe_eval(res, eval_in_python)\n\u001b[0;32m    520\u001b[0m \u001b[39melif\u001b[39;00m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mengine \u001b[39m!=\u001b[39m \u001b[39m\"\u001b[39m\u001b[39mpytables\u001b[39m\u001b[39m\"\u001b[39m:\n\u001b[0;32m    521\u001b[0m     \u001b[39mif\u001b[39;00m (\n\u001b[0;32m    522\u001b[0m         \u001b[39mgetattr\u001b[39m(lhs, \u001b[39m\"\u001b[39m\u001b[39mreturn_type\u001b[39m\u001b[39m\"\u001b[39m, \u001b[39mNone\u001b[39;00m) \u001b[39m==\u001b[39m \u001b[39mobject\u001b[39m\n\u001b[0;32m    523\u001b[0m         \u001b[39mor\u001b[39;00m \u001b[39mgetattr\u001b[39m(rhs, \u001b[39m\"\u001b[39m\u001b[39mreturn_type\u001b[39m\u001b[39m\"\u001b[39m, \u001b[39mNone\u001b[39;00m) \u001b[39m==\u001b[39m \u001b[39mobject\u001b[39m\n\u001b[0;32m    524\u001b[0m     ):\n\u001b[0;32m    525\u001b[0m         \u001b[39m# evaluate \"==\" and \"!=\" in python if either of our operands\u001b[39;00m\n\u001b[0;32m    526\u001b[0m         \u001b[39m# has an object return type\u001b[39;00m\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\expr.py:487\u001b[0m, in \u001b[0;36mBaseExprVisitor._maybe_eval\u001b[1;34m(self, binop, eval_in_python)\u001b[0m\n\u001b[0;32m    480\u001b[0m \u001b[39mdef\u001b[39;00m \u001b[39m_maybe_eval\u001b[39m(\u001b[39mself\u001b[39m, binop, eval_in_python):\n\u001b[0;32m    481\u001b[0m     \u001b[39m# eval `in` and `not in` (for now) in \"partial\" python space\u001b[39;00m\n\u001b[0;32m    482\u001b[0m     \u001b[39m# things that can be evaluated in \"eval\" space will be turned into\u001b[39;00m\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    485\u001b[0m     \u001b[39m# in that case a + 2 * b will be evaluated using numexpr, and the \"in\"\u001b[39;00m\n\u001b[0;32m    486\u001b[0m     \u001b[39m# call will be evaluated using isin (in python space)\u001b[39;00m\n\u001b[1;32m--> 487\u001b[0m     \u001b[39mreturn\u001b[39;00m binop\u001b[39m.\u001b[39;49mevaluate(\n\u001b[0;32m    488\u001b[0m         \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49menv, \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mengine, \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mparser, \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mterm_type, eval_in_python\n\u001b[0;32m    489\u001b[0m     )\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\ops.py:405\u001b[0m, in \u001b[0;36mBinOp.evaluate\u001b[1;34m(self, env, engine, parser, term_type, eval_in_python)\u001b[0m\n\u001b[0;32m    388\u001b[0m \u001b[39m\u001b[39m\u001b[39m\"\"\"\u001b[39;00m\n\u001b[0;32m    389\u001b[0m \u001b[39mEvaluate a binary operation *before* being passed to the engine.\u001b[39;00m\n\u001b[0;32m    390\u001b[0m \n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    402\u001b[0m \u001b[39m    The \"pre-evaluated\" expression as an instance of ``term_type``\u001b[39;00m\n\u001b[0;32m    403\u001b[0m \u001b[39m\"\"\"\u001b[39;00m\n\u001b[0;32m    404\u001b[0m \u001b[39mif\u001b[39;00m engine \u001b[39m==\u001b[39m \u001b[39m\"\u001b[39m\u001b[39mpython\u001b[39m\u001b[39m\"\u001b[39m:\n\u001b[1;32m--> 405\u001b[0m     res \u001b[39m=\u001b[39m \u001b[39mself\u001b[39;49m(env)\n\u001b[0;32m    406\u001b[0m \u001b[39melse\u001b[39;00m:\n\u001b[0;32m    407\u001b[0m     \u001b[39m# recurse over the left/right nodes\u001b[39;00m\n\u001b[0;32m    409\u001b[0m     left \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mlhs\u001b[39m.\u001b[39mevaluate(\n\u001b[0;32m    410\u001b[0m         env,\n\u001b[0;32m    411\u001b[0m         engine\u001b[39m=\u001b[39mengine,\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    414\u001b[0m         eval_in_python\u001b[39m=\u001b[39meval_in_python,\n\u001b[0;32m    415\u001b[0m     )\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\ops.py:385\u001b[0m, in \u001b[0;36mBinOp.__call__\u001b[1;34m(self, env)\u001b[0m\n\u001b[0;32m    382\u001b[0m left \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mlhs(env)\n\u001b[0;32m    383\u001b[0m right \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mrhs(env)\n\u001b[1;32m--> 385\u001b[0m \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mfunc(left, right)\n",
      "File \u001b[1;32mc:\\Users\\dataw\\OneDrive\\Desktop\\graph_courses_python\\.venv\\Lib\\site-packages\\pandas\\core\\computation\\ops.py:275\u001b[0m, in \u001b[0;36m_in\u001b[1;34m(x, y)\u001b[0m\n\u001b[0;32m    273\u001b[0m     \u001b[39mexcept\u001b[39;00m \u001b[39mAttributeError\u001b[39;00m:\n\u001b[0;32m    274\u001b[0m         \u001b[39mpass\u001b[39;00m\n\u001b[1;32m--> 275\u001b[0m \u001b[39mreturn\u001b[39;00m x \u001b[39min\u001b[39;49;00m y\n",
      "\u001b[1;31mTypeError\u001b[0m: argument of type 'bool' is not iterable"
     ]
    }
   ],
   "source": [
    "counties.query(\"'foreign_born_pct_gt_30' == True\")\n",
    "# Query the DataFrame to show only counties where percent_30 is True"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c922cafc-3e75-48b1-be46-6b09c9c44a68",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>state</th>\n",
       "      <th>county</th>\n",
       "      <th>pop_20</th>\n",
       "      <th>area_sq_miles</th>\n",
       "      <th>hh_inc_21</th>\n",
       "      <th>econ_type</th>\n",
       "      <th>unemp_20</th>\n",
       "      <th>foreign_born_num</th>\n",
       "      <th>pop_change_2010_2020</th>\n",
       "      <th>pct_emp_change_2010_2021</th>\n",
       "      <th>foreign_born_percentage</th>\n",
       "      <th>foreign_born_pct_gt_30</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>69</th>\n",
       "      <td>AK</td>\n",
       "      <td>Aleutians West, AK</td>\n",
       "      <td>5206.0</td>\n",
       "      <td>4393.026155</td>\n",
       "      <td>86050.0</td>\n",
       "      <td>Manufacturing</td>\n",
       "      <td>4.7</td>\n",
       "      <td>2379.0</td>\n",
       "      <td>-5.916202</td>\n",
       "      <td>-6.6</td>\n",
       "      <td>45.697272</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>113</th>\n",
       "      <td>AZ</td>\n",
       "      <td>Santa Cruz, AZ</td>\n",
       "      <td>47653.0</td>\n",
       "      <td>1236.242500</td>\n",
       "      <td>49216.0</td>\n",
       "      <td>Federal/State Government</td>\n",
       "      <td>11.2</td>\n",
       "      <td>15495.0</td>\n",
       "      <td>0.525095</td>\n",
       "      <td>-2.5</td>\n",
       "      <td>32.516316</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>191</th>\n",
       "      <td>CA</td>\n",
       "      <td>Alameda, CA</td>\n",
       "      <td>1679844.0</td>\n",
       "      <td>737.461854</td>\n",
       "      <td>108971.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>9.0</td>\n",
       "      <td>551151.0</td>\n",
       "      <td>11.394114</td>\n",
       "      <td>9.4</td>\n",
       "      <td>32.809654</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>203</th>\n",
       "      <td>CA</td>\n",
       "      <td>Imperial, CA</td>\n",
       "      <td>179489.0</td>\n",
       "      <td>4175.538752</td>\n",
       "      <td>50970.0</td>\n",
       "      <td>Federal/State Government</td>\n",
       "      <td>22.8</td>\n",
       "      <td>53889.0</td>\n",
       "      <td>2.964567</td>\n",
       "      <td>2.3</td>\n",
       "      <td>30.023567</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>209</th>\n",
       "      <td>CA</td>\n",
       "      <td>Los Angeles, CA</td>\n",
       "      <td>9989165.0</td>\n",
       "      <td>4059.281780</td>\n",
       "      <td>77356.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>12.3</td>\n",
       "      <td>3353967.0</td>\n",
       "      <td>1.990140</td>\n",
       "      <td>5.3</td>\n",
       "      <td>33.576050</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>228</th>\n",
       "      <td>CA</td>\n",
       "      <td>San Francisco, CA</td>\n",
       "      <td>870014.0</td>\n",
       "      <td>46.914151</td>\n",
       "      <td>119776.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>8.0</td>\n",
       "      <td>295398.0</td>\n",
       "      <td>8.535396</td>\n",
       "      <td>17.4</td>\n",
       "      <td>33.953247</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>231</th>\n",
       "      <td>CA</td>\n",
       "      <td>San Mateo, CA</td>\n",
       "      <td>762453.0</td>\n",
       "      <td>448.620625</td>\n",
       "      <td>131151.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>7.0</td>\n",
       "      <td>267704.0</td>\n",
       "      <td>6.401411</td>\n",
       "      <td>14.5</td>\n",
       "      <td>35.110886</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>233</th>\n",
       "      <td>CA</td>\n",
       "      <td>Santa Clara, CA</td>\n",
       "      <td>1930598.0</td>\n",
       "      <td>1291.084252</td>\n",
       "      <td>141161.0</td>\n",
       "      <td>Manufacturing</td>\n",
       "      <td>7.2</td>\n",
       "      <td>771644.0</td>\n",
       "      <td>8.678343</td>\n",
       "      <td>16.7</td>\n",
       "      <td>39.969170</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>330</th>\n",
       "      <td>FL</td>\n",
       "      <td>Broward, FL</td>\n",
       "      <td>1941516.0</td>\n",
       "      <td>1202.730697</td>\n",
       "      <td>65536.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>9.6</td>\n",
       "      <td>673696.0</td>\n",
       "      <td>11.230068</td>\n",
       "      <td>16.9</td>\n",
       "      <td>34.699482</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>367</th>\n",
       "      <td>FL</td>\n",
       "      <td>Miami-Dade, FL</td>\n",
       "      <td>2692459.0</td>\n",
       "      <td>1899.904166</td>\n",
       "      <td>58905.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>7.4</td>\n",
       "      <td>1452504.0</td>\n",
       "      <td>8.225009</td>\n",
       "      <td>14.2</td>\n",
       "      <td>53.947117</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1212</th>\n",
       "      <td>MD</td>\n",
       "      <td>Montgomery, MD</td>\n",
       "      <td>1061243.0</td>\n",
       "      <td>493.109885</td>\n",
       "      <td>112352.0</td>\n",
       "      <td>Federal/State Government</td>\n",
       "      <td>6.2</td>\n",
       "      <td>340808.0</td>\n",
       "      <td>9.290609</td>\n",
       "      <td>3.0</td>\n",
       "      <td>32.114040</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1677</th>\n",
       "      <td>NE</td>\n",
       "      <td>Colfax, NE</td>\n",
       "      <td>10546.0</td>\n",
       "      <td>411.646962</td>\n",
       "      <td>69498.0</td>\n",
       "      <td>Manufacturing</td>\n",
       "      <td>2.8</td>\n",
       "      <td>3665.0</td>\n",
       "      <td>0.637185</td>\n",
       "      <td>3.6</td>\n",
       "      <td>34.752513</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1780</th>\n",
       "      <td>NJ</td>\n",
       "      <td>Bergen, NJ</td>\n",
       "      <td>954774.0</td>\n",
       "      <td>232.788242</td>\n",
       "      <td>104777.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>9.2</td>\n",
       "      <td>294232.0</td>\n",
       "      <td>5.592211</td>\n",
       "      <td>5.0</td>\n",
       "      <td>30.816926</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1787</th>\n",
       "      <td>NJ</td>\n",
       "      <td>Hudson, NJ</td>\n",
       "      <td>722655.0</td>\n",
       "      <td>46.193582</td>\n",
       "      <td>79159.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>10.2</td>\n",
       "      <td>306223.0</td>\n",
       "      <td>14.282336</td>\n",
       "      <td>8.1</td>\n",
       "      <td>42.374715</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1790</th>\n",
       "      <td>NJ</td>\n",
       "      <td>Middlesex, NJ</td>\n",
       "      <td>861908.0</td>\n",
       "      <td>309.222015</td>\n",
       "      <td>98992.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>8.5</td>\n",
       "      <td>286806.0</td>\n",
       "      <td>6.581895</td>\n",
       "      <td>10.9</td>\n",
       "      <td>33.275709</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1794</th>\n",
       "      <td>NJ</td>\n",
       "      <td>Passaic, NJ</td>\n",
       "      <td>523100.0</td>\n",
       "      <td>186.013333</td>\n",
       "      <td>74016.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>12.2</td>\n",
       "      <td>167485.0</td>\n",
       "      <td>4.567201</td>\n",
       "      <td>2.0</td>\n",
       "      <td>32.017779</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1798</th>\n",
       "      <td>NJ</td>\n",
       "      <td>Union, NJ</td>\n",
       "      <td>574349.0</td>\n",
       "      <td>102.766332</td>\n",
       "      <td>85926.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>9.6</td>\n",
       "      <td>176059.0</td>\n",
       "      <td>7.240647</td>\n",
       "      <td>5.5</td>\n",
       "      <td>30.653662</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1835</th>\n",
       "      <td>NY</td>\n",
       "      <td>Bronx, NY</td>\n",
       "      <td>1466438.0</td>\n",
       "      <td>42.171860</td>\n",
       "      <td>43143.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>16.2</td>\n",
       "      <td>502165.0</td>\n",
       "      <td>6.320518</td>\n",
       "      <td>1.6</td>\n",
       "      <td>34.243862</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1856</th>\n",
       "      <td>NY</td>\n",
       "      <td>Kings, NY</td>\n",
       "      <td>2727393.0</td>\n",
       "      <td>69.376570</td>\n",
       "      <td>66943.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>12.6</td>\n",
       "      <td>957522.0</td>\n",
       "      <td>9.237593</td>\n",
       "      <td>1.6</td>\n",
       "      <td>35.107592</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1873</th>\n",
       "      <td>NY</td>\n",
       "      <td>Queens, NY</td>\n",
       "      <td>2395791.0</td>\n",
       "      <td>108.724075</td>\n",
       "      <td>72807.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>12.6</td>\n",
       "      <td>1124088.0</td>\n",
       "      <td>7.833428</td>\n",
       "      <td>0.1</td>\n",
       "      <td>46.919285</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2642</th>\n",
       "      <td>TX</td>\n",
       "      <td>Hudspeth, TX</td>\n",
       "      <td>3196.0</td>\n",
       "      <td>4570.525168</td>\n",
       "      <td>38904.0</td>\n",
       "      <td>Federal/State Government</td>\n",
       "      <td>8.1</td>\n",
       "      <td>1415.0</td>\n",
       "      <td>-7.882624</td>\n",
       "      <td>33.8</td>\n",
       "      <td>44.274093</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2716</th>\n",
       "      <td>TX</td>\n",
       "      <td>Presidio, TX</td>\n",
       "      <td>6102.0</td>\n",
       "      <td>3855.252398</td>\n",
       "      <td>39791.0</td>\n",
       "      <td>Federal/State Government</td>\n",
       "      <td>14.8</td>\n",
       "      <td>2722.0</td>\n",
       "      <td>-21.578409</td>\n",
       "      <td>-9.2</td>\n",
       "      <td>44.608325</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2853</th>\n",
       "      <td>VA</td>\n",
       "      <td>Fairfax, VA</td>\n",
       "      <td>1148472.0</td>\n",
       "      <td>391.020925</td>\n",
       "      <td>133845.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>5.8</td>\n",
       "      <td>351471.0</td>\n",
       "      <td>6.340145</td>\n",
       "      <td>2.5</td>\n",
       "      <td>30.603358</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2941</th>\n",
       "      <td>VA</td>\n",
       "      <td>Manassas Park, VA</td>\n",
       "      <td>17140.0</td>\n",
       "      <td>3.033816</td>\n",
       "      <td>87255.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>6.6</td>\n",
       "      <td>6469.0</td>\n",
       "      <td>20.640370</td>\n",
       "      <td>20.4</td>\n",
       "      <td>37.742124</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     state              county     pop_20  area_sq_miles  hh_inc_21  \\\n",
       "69      AK  Aleutians West, AK     5206.0    4393.026155    86050.0   \n",
       "113     AZ      Santa Cruz, AZ    47653.0    1236.242500    49216.0   \n",
       "191     CA         Alameda, CA  1679844.0     737.461854   108971.0   \n",
       "203     CA        Imperial, CA   179489.0    4175.538752    50970.0   \n",
       "209     CA     Los Angeles, CA  9989165.0    4059.281780    77356.0   \n",
       "228     CA   San Francisco, CA   870014.0      46.914151   119776.0   \n",
       "231     CA       San Mateo, CA   762453.0     448.620625   131151.0   \n",
       "233     CA     Santa Clara, CA  1930598.0    1291.084252   141161.0   \n",
       "330     FL         Broward, FL  1941516.0    1202.730697    65536.0   \n",
       "367     FL      Miami-Dade, FL  2692459.0    1899.904166    58905.0   \n",
       "1212    MD      Montgomery, MD  1061243.0     493.109885   112352.0   \n",
       "1677    NE          Colfax, NE    10546.0     411.646962    69498.0   \n",
       "1780    NJ          Bergen, NJ   954774.0     232.788242   104777.0   \n",
       "1787    NJ          Hudson, NJ   722655.0      46.193582    79159.0   \n",
       "1790    NJ       Middlesex, NJ   861908.0     309.222015    98992.0   \n",
       "1794    NJ         Passaic, NJ   523100.0     186.013333    74016.0   \n",
       "1798    NJ           Union, NJ   574349.0     102.766332    85926.0   \n",
       "1835    NY           Bronx, NY  1466438.0      42.171860    43143.0   \n",
       "1856    NY           Kings, NY  2727393.0      69.376570    66943.0   \n",
       "1873    NY          Queens, NY  2395791.0     108.724075    72807.0   \n",
       "2642    TX        Hudspeth, TX     3196.0    4570.525168    38904.0   \n",
       "2716    TX        Presidio, TX     6102.0    3855.252398    39791.0   \n",
       "2853    VA         Fairfax, VA  1148472.0     391.020925   133845.0   \n",
       "2941    VA   Manassas Park, VA    17140.0       3.033816    87255.0   \n",
       "\n",
       "                     econ_type  unemp_20  foreign_born_num  \\\n",
       "69               Manufacturing       4.7            2379.0   \n",
       "113   Federal/State Government      11.2           15495.0   \n",
       "191             Nonspecialized       9.0          551151.0   \n",
       "203   Federal/State Government      22.8           53889.0   \n",
       "209             Nonspecialized      12.3         3353967.0   \n",
       "228             Nonspecialized       8.0          295398.0   \n",
       "231             Nonspecialized       7.0          267704.0   \n",
       "233              Manufacturing       7.2          771644.0   \n",
       "330             Nonspecialized       9.6          673696.0   \n",
       "367             Nonspecialized       7.4         1452504.0   \n",
       "1212  Federal/State Government       6.2          340808.0   \n",
       "1677             Manufacturing       2.8            3665.0   \n",
       "1780            Nonspecialized       9.2          294232.0   \n",
       "1787            Nonspecialized      10.2          306223.0   \n",
       "1790            Nonspecialized       8.5          286806.0   \n",
       "1794            Nonspecialized      12.2          167485.0   \n",
       "1798            Nonspecialized       9.6          176059.0   \n",
       "1835            Nonspecialized      16.2          502165.0   \n",
       "1856            Nonspecialized      12.6          957522.0   \n",
       "1873            Nonspecialized      12.6         1124088.0   \n",
       "2642  Federal/State Government       8.1            1415.0   \n",
       "2716  Federal/State Government      14.8            2722.0   \n",
       "2853            Nonspecialized       5.8          351471.0   \n",
       "2941            Nonspecialized       6.6            6469.0   \n",
       "\n",
       "      pop_change_2010_2020  pct_emp_change_2010_2021  foreign_born_percentage  \\\n",
       "69               -5.916202                      -6.6                45.697272   \n",
       "113               0.525095                      -2.5                32.516316   \n",
       "191              11.394114                       9.4                32.809654   \n",
       "203               2.964567                       2.3                30.023567   \n",
       "209               1.990140                       5.3                33.576050   \n",
       "228               8.535396                      17.4                33.953247   \n",
       "231               6.401411                      14.5                35.110886   \n",
       "233               8.678343                      16.7                39.969170   \n",
       "330              11.230068                      16.9                34.699482   \n",
       "367               8.225009                      14.2                53.947117   \n",
       "1212              9.290609                       3.0                32.114040   \n",
       "1677              0.637185                       3.6                34.752513   \n",
       "1780              5.592211                       5.0                30.816926   \n",
       "1787             14.282336                       8.1                42.374715   \n",
       "1790              6.581895                      10.9                33.275709   \n",
       "1794              4.567201                       2.0                32.017779   \n",
       "1798              7.240647                       5.5                30.653662   \n",
       "1835              6.320518                       1.6                34.243862   \n",
       "1856              9.237593                       1.6                35.107592   \n",
       "1873              7.833428                       0.1                46.919285   \n",
       "2642             -7.882624                      33.8                44.274093   \n",
       "2716            -21.578409                      -9.2                44.608325   \n",
       "2853              6.340145                       2.5                30.603358   \n",
       "2941             20.640370                      20.4                37.742124   \n",
       "\n",
       "      foreign_born_pct_gt_30  \n",
       "69                      True  \n",
       "113                     True  \n",
       "191                     True  \n",
       "203                     True  \n",
       "209                     True  \n",
       "228                     True  \n",
       "231                     True  \n",
       "233                     True  \n",
       "330                     True  \n",
       "367                     True  \n",
       "1212                    True  \n",
       "1677                    True  \n",
       "1780                    True  \n",
       "1787                    True  \n",
       "1790                    True  \n",
       "1794                    True  \n",
       "1798                    True  \n",
       "1835                    True  \n",
       "1856                    True  \n",
       "1873                    True  \n",
       "2642                    True  \n",
       "2716                    True  \n",
       "2853                    True  \n",
       "2941                    True  "
      ]
     },
     "execution_count": 71,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "counties.query(\"foreign_born_pct_gt_30 == True\")\n",
    "# Query the DataFrame to show only counties where percent_30 is True"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ad46c643-a62f-49ce-a093-4b8ca1c954c8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(24, 12)"
      ]
     },
     "execution_count": 72,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "counties.query(\"foreign_born_pct_gt_30 == True\").shape\n",
    "# Query the DataFrame to show only counties where percent_30 is True"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2e77e707-32b3-4ffd-8faa-b38c703bc37f",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "pd.set_option('display.max_columns', None)\n",
    "\n",
    "# Your code here\n",
    "loan_data = pd.read_csv(\"intro_to_quarto/data/loans_full_schema.csv\")\n",
    "loan_data\n",
    "\n",
    "# Your code here\n",
    "loan_data_rowname = loan_data.drop(columns = [\"rownames\"])\n",
    "loan_data_rowname\n",
    "\n",
    "# Your code here\n",
    "demog_loan_info = loan_data_rowname[[\"emp_title\", \"emp_length\", \"state\", \"homeownership\", \"loan_amount\", \"term\", \"interest_rate\"]]\n",
    "demog_loan_info = demog_loan_info.rename(columns = {\"term\" : \"loan_term_months\"})\n",
    "demog_loan_info.to_csv('outputs/demog_loan_info.csv', index=False)\n",
    "\n",
    "# Your code here\n",
    "credit_vars = loan_data_rowname.filter(regex=\"credits\")\n",
    "credit_vars.to_csv('outputs/credit_vars.csv', index=False)\n",
    "\n",
    "# Your code here\n",
    "high_income = loan_data_rowname.query(\"annual_income > 100000\")\n",
    "high_income\n",
    "\n",
    "# Your code here\n",
    "high_risk = loan_data_rowname.query(\"interest_rate >15 | debt_to_income >30 | delinq_2y >0\")\n",
    "high_risk.to_csv('outputs/high_risk.csv', index=False)\n",
    "\n",
    "loan_data_grade = loan_data_rowname.query(\"grade == 'A' | grade == 'B'\")\n",
    "loan_data_grade\n",
    "\n",
    "# Your code here\n",
    "prime = loan_data_rowname.query(\"(grade == 'A'| grade == 'B') & debt_to_income < 20 & delinq_2y == 0\")\n",
    "prime.to_csv(\"outputs/prime.csv\", index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "42b1c5a2-3089-445a-8aca-2d6bb984d147",
   "metadata": {},
   "outputs": [],
   "source": [
    "import openpyxl # important to install this package\n",
    "import plotly.express as px\n",
    "\n",
    "# Use the ExcelWriter to export each subset to a separate sheet\n",
    "with pd.ExcelWriter('outputs/loan_data_rowname_subsets.xlsx') as writer:\n",
    "    credit_vars.to_excel(writer, sheet_name='Credit Variables', index=False)\n",
    "    demog_loan_info.to_excel(writer, sheet_name='Info of demo loan', index=False)\n",
    "    high_risk.to_excel(writer, sheet_name='High Risk', index=False)\n",
    "    prime.to_excel(writer, sheet_name='Prime Borrowers', index=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Connected to .venv (Python 3.12.6)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "82e2750c-86d3-411f-ae91-c36ca0a90dec",
   "metadata": {
    "vscode": {
     "languageId": "quarto"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       False\n",
       "1       False\n",
       "2       False\n",
       "3       False\n",
       "4       False\n",
       "        ...  \n",
       "3221    False\n",
       "3222    False\n",
       "3223    False\n",
       "3224    False\n",
       "3225    False\n",
       "Name: foreign_born_pct_gt_30, Length: 3226, dtype: bool"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "pd.options.mode.copy_on_write = True\n",
    "\n",
    "counties = pd.read_csv(\"intro_to_quarto/data/us_counties_data.csv\")\n",
    "counties\n",
    "\n",
    "area_df = counties[[\"county\", \"area_sq_miles\", \"pop_20\"]]\n",
    "area_df\n",
    "\n",
    "# New var with area in sq km - converting sq.miles to sq.km\n",
    "area_df[\"area_sq_km\"] = area_df[\"area_sq_miles\"] * 2.59\n",
    "# New var with area in hectares - 1 hectare = 100 sq.km\n",
    "area_df[\"area_hectares\"] = area_df[\"area_sq_km\"] * 100\n",
    "area_df\n",
    "\n",
    "area_df[\"area_acres\"] = area_df[\"area_sq_miles\"] * 640\n",
    "area_df\n",
    "\n",
    "area_df[\"area_sq_km\"] = area_df[\"area_sq_km\"].round(1)\n",
    "area_df\n",
    "## for this code if you want to round the decimal places to 2 .round(2) instead of 1, you need to rerun all the codes above before it will reflect 2 decimal places.\n",
    "\n",
    "area_df[\"area_acres\"] = area_df[\"area_acres\"].round(1)\n",
    "area_df\n",
    "\n",
    "area_df[\"pop_per_sq_km\"] = (area_df[\"pop_20\"] / area_df[\"area_sq_km\"]).round(1)\n",
    "area_df = area_df.sort_values(by=\"pop_per_sq_km\", ascending=False)\n",
    "area_df\n",
    "\n",
    "# Calculate the percentage of foreign-born residents\n",
    "counties['foreign_born_percentage'] = (counties['foreign_born_num'] / counties['pop_20']) * 100\n",
    "\n",
    "# Sort counties by the foreign-born percentage in descending order and select the top two\n",
    "top_two_counties = counties.sort_values(by='foreign_born_percentage', ascending=False).head(2)\n",
    "\n",
    "# Display the top two counties with the highest percentage of foreign-born residents\n",
    "top_two_counties[['county', 'foreign_born_percentage']]\n",
    "\n",
    "\n",
    "# make a subset of the counties dataframe with the following colmun\n",
    "changes_df = counties[[\"county\", \"pop_change_2010_2020\", \"pct_emp_change_2010_2021\"]]\n",
    "changes_df\n",
    "\n",
    "changes_df[\"pop_increase\"] = changes_df[\"pop_change_2010_2020\"] > 0\n",
    "changes_df[\"emp_increase\"] = changes_df[\"pct_emp_change_2010_2021\"] > 0\n",
    "changes_df\n",
    "\n",
    "changes_df.query(\"pop_increase == True & emp_increase == False\")\n",
    "## beacuse the coulmns are already in boolean,\n",
    "## the above code can also be written as \n",
    "changes_df = changes_df.query(\"pop_increase & ~(emp_increase)\")\n",
    "\n",
    "\n",
    "change = counties[[\"foreign_born_percentage\"]]\n",
    "change\n",
    "\n",
    "change[\"foreign_born_pct_gt_30\"] = counties[\"foreign_born_percentage\"] > 30\n",
    "change\n",
    "\n",
    "counties[\"foreign_born_pct_gt_30\"] = counties[\"foreign_born_percentage\"] > 30\n",
    "counties[\"foreign_born_pct_gt_30\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "65a289d0-001d-47c6-9f2b-e976ff53952b",
   "metadata": {
    "vscode": {
     "languageId": "quarto"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>state</th>\n",
       "      <th>county</th>\n",
       "      <th>pop_20</th>\n",
       "      <th>area_sq_miles</th>\n",
       "      <th>hh_inc_21</th>\n",
       "      <th>econ_type</th>\n",
       "      <th>unemp_20</th>\n",
       "      <th>foreign_born_num</th>\n",
       "      <th>pop_change_2010_2020</th>\n",
       "      <th>pct_emp_change_2010_2021</th>\n",
       "      <th>foreign_born_percentage</th>\n",
       "      <th>foreign_born_pct_gt_30</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>69</th>\n",
       "      <td>AK</td>\n",
       "      <td>Aleutians West, AK</td>\n",
       "      <td>5206.0</td>\n",
       "      <td>4393.026155</td>\n",
       "      <td>86050.0</td>\n",
       "      <td>Manufacturing</td>\n",
       "      <td>4.7</td>\n",
       "      <td>2379.0</td>\n",
       "      <td>-5.916202</td>\n",
       "      <td>-6.6</td>\n",
       "      <td>45.697272</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>113</th>\n",
       "      <td>AZ</td>\n",
       "      <td>Santa Cruz, AZ</td>\n",
       "      <td>47653.0</td>\n",
       "      <td>1236.242500</td>\n",
       "      <td>49216.0</td>\n",
       "      <td>Federal/State Government</td>\n",
       "      <td>11.2</td>\n",
       "      <td>15495.0</td>\n",
       "      <td>0.525095</td>\n",
       "      <td>-2.5</td>\n",
       "      <td>32.516316</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>191</th>\n",
       "      <td>CA</td>\n",
       "      <td>Alameda, CA</td>\n",
       "      <td>1679844.0</td>\n",
       "      <td>737.461854</td>\n",
       "      <td>108971.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>9.0</td>\n",
       "      <td>551151.0</td>\n",
       "      <td>11.394114</td>\n",
       "      <td>9.4</td>\n",
       "      <td>32.809654</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>203</th>\n",
       "      <td>CA</td>\n",
       "      <td>Imperial, CA</td>\n",
       "      <td>179489.0</td>\n",
       "      <td>4175.538752</td>\n",
       "      <td>50970.0</td>\n",
       "      <td>Federal/State Government</td>\n",
       "      <td>22.8</td>\n",
       "      <td>53889.0</td>\n",
       "      <td>2.964567</td>\n",
       "      <td>2.3</td>\n",
       "      <td>30.023567</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>209</th>\n",
       "      <td>CA</td>\n",
       "      <td>Los Angeles, CA</td>\n",
       "      <td>9989165.0</td>\n",
       "      <td>4059.281780</td>\n",
       "      <td>77356.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>12.3</td>\n",
       "      <td>3353967.0</td>\n",
       "      <td>1.990140</td>\n",
       "      <td>5.3</td>\n",
       "      <td>33.576050</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>228</th>\n",
       "      <td>CA</td>\n",
       "      <td>San Francisco, CA</td>\n",
       "      <td>870014.0</td>\n",
       "      <td>46.914151</td>\n",
       "      <td>119776.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>8.0</td>\n",
       "      <td>295398.0</td>\n",
       "      <td>8.535396</td>\n",
       "      <td>17.4</td>\n",
       "      <td>33.953247</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>231</th>\n",
       "      <td>CA</td>\n",
       "      <td>San Mateo, CA</td>\n",
       "      <td>762453.0</td>\n",
       "      <td>448.620625</td>\n",
       "      <td>131151.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>7.0</td>\n",
       "      <td>267704.0</td>\n",
       "      <td>6.401411</td>\n",
       "      <td>14.5</td>\n",
       "      <td>35.110886</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>233</th>\n",
       "      <td>CA</td>\n",
       "      <td>Santa Clara, CA</td>\n",
       "      <td>1930598.0</td>\n",
       "      <td>1291.084252</td>\n",
       "      <td>141161.0</td>\n",
       "      <td>Manufacturing</td>\n",
       "      <td>7.2</td>\n",
       "      <td>771644.0</td>\n",
       "      <td>8.678343</td>\n",
       "      <td>16.7</td>\n",
       "      <td>39.969170</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>330</th>\n",
       "      <td>FL</td>\n",
       "      <td>Broward, FL</td>\n",
       "      <td>1941516.0</td>\n",
       "      <td>1202.730697</td>\n",
       "      <td>65536.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>9.6</td>\n",
       "      <td>673696.0</td>\n",
       "      <td>11.230068</td>\n",
       "      <td>16.9</td>\n",
       "      <td>34.699482</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>367</th>\n",
       "      <td>FL</td>\n",
       "      <td>Miami-Dade, FL</td>\n",
       "      <td>2692459.0</td>\n",
       "      <td>1899.904166</td>\n",
       "      <td>58905.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>7.4</td>\n",
       "      <td>1452504.0</td>\n",
       "      <td>8.225009</td>\n",
       "      <td>14.2</td>\n",
       "      <td>53.947117</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1212</th>\n",
       "      <td>MD</td>\n",
       "      <td>Montgomery, MD</td>\n",
       "      <td>1061243.0</td>\n",
       "      <td>493.109885</td>\n",
       "      <td>112352.0</td>\n",
       "      <td>Federal/State Government</td>\n",
       "      <td>6.2</td>\n",
       "      <td>340808.0</td>\n",
       "      <td>9.290609</td>\n",
       "      <td>3.0</td>\n",
       "      <td>32.114040</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1677</th>\n",
       "      <td>NE</td>\n",
       "      <td>Colfax, NE</td>\n",
       "      <td>10546.0</td>\n",
       "      <td>411.646962</td>\n",
       "      <td>69498.0</td>\n",
       "      <td>Manufacturing</td>\n",
       "      <td>2.8</td>\n",
       "      <td>3665.0</td>\n",
       "      <td>0.637185</td>\n",
       "      <td>3.6</td>\n",
       "      <td>34.752513</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1780</th>\n",
       "      <td>NJ</td>\n",
       "      <td>Bergen, NJ</td>\n",
       "      <td>954774.0</td>\n",
       "      <td>232.788242</td>\n",
       "      <td>104777.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>9.2</td>\n",
       "      <td>294232.0</td>\n",
       "      <td>5.592211</td>\n",
       "      <td>5.0</td>\n",
       "      <td>30.816926</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1787</th>\n",
       "      <td>NJ</td>\n",
       "      <td>Hudson, NJ</td>\n",
       "      <td>722655.0</td>\n",
       "      <td>46.193582</td>\n",
       "      <td>79159.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>10.2</td>\n",
       "      <td>306223.0</td>\n",
       "      <td>14.282336</td>\n",
       "      <td>8.1</td>\n",
       "      <td>42.374715</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1790</th>\n",
       "      <td>NJ</td>\n",
       "      <td>Middlesex, NJ</td>\n",
       "      <td>861908.0</td>\n",
       "      <td>309.222015</td>\n",
       "      <td>98992.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>8.5</td>\n",
       "      <td>286806.0</td>\n",
       "      <td>6.581895</td>\n",
       "      <td>10.9</td>\n",
       "      <td>33.275709</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1794</th>\n",
       "      <td>NJ</td>\n",
       "      <td>Passaic, NJ</td>\n",
       "      <td>523100.0</td>\n",
       "      <td>186.013333</td>\n",
       "      <td>74016.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>12.2</td>\n",
       "      <td>167485.0</td>\n",
       "      <td>4.567201</td>\n",
       "      <td>2.0</td>\n",
       "      <td>32.017779</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1798</th>\n",
       "      <td>NJ</td>\n",
       "      <td>Union, NJ</td>\n",
       "      <td>574349.0</td>\n",
       "      <td>102.766332</td>\n",
       "      <td>85926.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>9.6</td>\n",
       "      <td>176059.0</td>\n",
       "      <td>7.240647</td>\n",
       "      <td>5.5</td>\n",
       "      <td>30.653662</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1835</th>\n",
       "      <td>NY</td>\n",
       "      <td>Bronx, NY</td>\n",
       "      <td>1466438.0</td>\n",
       "      <td>42.171860</td>\n",
       "      <td>43143.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>16.2</td>\n",
       "      <td>502165.0</td>\n",
       "      <td>6.320518</td>\n",
       "      <td>1.6</td>\n",
       "      <td>34.243862</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1856</th>\n",
       "      <td>NY</td>\n",
       "      <td>Kings, NY</td>\n",
       "      <td>2727393.0</td>\n",
       "      <td>69.376570</td>\n",
       "      <td>66943.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>12.6</td>\n",
       "      <td>957522.0</td>\n",
       "      <td>9.237593</td>\n",
       "      <td>1.6</td>\n",
       "      <td>35.107592</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1873</th>\n",
       "      <td>NY</td>\n",
       "      <td>Queens, NY</td>\n",
       "      <td>2395791.0</td>\n",
       "      <td>108.724075</td>\n",
       "      <td>72807.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>12.6</td>\n",
       "      <td>1124088.0</td>\n",
       "      <td>7.833428</td>\n",
       "      <td>0.1</td>\n",
       "      <td>46.919285</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2642</th>\n",
       "      <td>TX</td>\n",
       "      <td>Hudspeth, TX</td>\n",
       "      <td>3196.0</td>\n",
       "      <td>4570.525168</td>\n",
       "      <td>38904.0</td>\n",
       "      <td>Federal/State Government</td>\n",
       "      <td>8.1</td>\n",
       "      <td>1415.0</td>\n",
       "      <td>-7.882624</td>\n",
       "      <td>33.8</td>\n",
       "      <td>44.274093</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2716</th>\n",
       "      <td>TX</td>\n",
       "      <td>Presidio, TX</td>\n",
       "      <td>6102.0</td>\n",
       "      <td>3855.252398</td>\n",
       "      <td>39791.0</td>\n",
       "      <td>Federal/State Government</td>\n",
       "      <td>14.8</td>\n",
       "      <td>2722.0</td>\n",
       "      <td>-21.578409</td>\n",
       "      <td>-9.2</td>\n",
       "      <td>44.608325</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2853</th>\n",
       "      <td>VA</td>\n",
       "      <td>Fairfax, VA</td>\n",
       "      <td>1148472.0</td>\n",
       "      <td>391.020925</td>\n",
       "      <td>133845.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>5.8</td>\n",
       "      <td>351471.0</td>\n",
       "      <td>6.340145</td>\n",
       "      <td>2.5</td>\n",
       "      <td>30.603358</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2941</th>\n",
       "      <td>VA</td>\n",
       "      <td>Manassas Park, VA</td>\n",
       "      <td>17140.0</td>\n",
       "      <td>3.033816</td>\n",
       "      <td>87255.0</td>\n",
       "      <td>Nonspecialized</td>\n",
       "      <td>6.6</td>\n",
       "      <td>6469.0</td>\n",
       "      <td>20.640370</td>\n",
       "      <td>20.4</td>\n",
       "      <td>37.742124</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     state              county     pop_20  area_sq_miles  hh_inc_21  \\\n",
       "69      AK  Aleutians West, AK     5206.0    4393.026155    86050.0   \n",
       "113     AZ      Santa Cruz, AZ    47653.0    1236.242500    49216.0   \n",
       "191     CA         Alameda, CA  1679844.0     737.461854   108971.0   \n",
       "203     CA        Imperial, CA   179489.0    4175.538752    50970.0   \n",
       "209     CA     Los Angeles, CA  9989165.0    4059.281780    77356.0   \n",
       "228     CA   San Francisco, CA   870014.0      46.914151   119776.0   \n",
       "231     CA       San Mateo, CA   762453.0     448.620625   131151.0   \n",
       "233     CA     Santa Clara, CA  1930598.0    1291.084252   141161.0   \n",
       "330     FL         Broward, FL  1941516.0    1202.730697    65536.0   \n",
       "367     FL      Miami-Dade, FL  2692459.0    1899.904166    58905.0   \n",
       "1212    MD      Montgomery, MD  1061243.0     493.109885   112352.0   \n",
       "1677    NE          Colfax, NE    10546.0     411.646962    69498.0   \n",
       "1780    NJ          Bergen, NJ   954774.0     232.788242   104777.0   \n",
       "1787    NJ          Hudson, NJ   722655.0      46.193582    79159.0   \n",
       "1790    NJ       Middlesex, NJ   861908.0     309.222015    98992.0   \n",
       "1794    NJ         Passaic, NJ   523100.0     186.013333    74016.0   \n",
       "1798    NJ           Union, NJ   574349.0     102.766332    85926.0   \n",
       "1835    NY           Bronx, NY  1466438.0      42.171860    43143.0   \n",
       "1856    NY           Kings, NY  2727393.0      69.376570    66943.0   \n",
       "1873    NY          Queens, NY  2395791.0     108.724075    72807.0   \n",
       "2642    TX        Hudspeth, TX     3196.0    4570.525168    38904.0   \n",
       "2716    TX        Presidio, TX     6102.0    3855.252398    39791.0   \n",
       "2853    VA         Fairfax, VA  1148472.0     391.020925   133845.0   \n",
       "2941    VA   Manassas Park, VA    17140.0       3.033816    87255.0   \n",
       "\n",
       "                     econ_type  unemp_20  foreign_born_num  \\\n",
       "69               Manufacturing       4.7            2379.0   \n",
       "113   Federal/State Government      11.2           15495.0   \n",
       "191             Nonspecialized       9.0          551151.0   \n",
       "203   Federal/State Government      22.8           53889.0   \n",
       "209             Nonspecialized      12.3         3353967.0   \n",
       "228             Nonspecialized       8.0          295398.0   \n",
       "231             Nonspecialized       7.0          267704.0   \n",
       "233              Manufacturing       7.2          771644.0   \n",
       "330             Nonspecialized       9.6          673696.0   \n",
       "367             Nonspecialized       7.4         1452504.0   \n",
       "1212  Federal/State Government       6.2          340808.0   \n",
       "1677             Manufacturing       2.8            3665.0   \n",
       "1780            Nonspecialized       9.2          294232.0   \n",
       "1787            Nonspecialized      10.2          306223.0   \n",
       "1790            Nonspecialized       8.5          286806.0   \n",
       "1794            Nonspecialized      12.2          167485.0   \n",
       "1798            Nonspecialized       9.6          176059.0   \n",
       "1835            Nonspecialized      16.2          502165.0   \n",
       "1856            Nonspecialized      12.6          957522.0   \n",
       "1873            Nonspecialized      12.6         1124088.0   \n",
       "2642  Federal/State Government       8.1            1415.0   \n",
       "2716  Federal/State Government      14.8            2722.0   \n",
       "2853            Nonspecialized       5.8          351471.0   \n",
       "2941            Nonspecialized       6.6            6469.0   \n",
       "\n",
       "      pop_change_2010_2020  pct_emp_change_2010_2021  foreign_born_percentage  \\\n",
       "69               -5.916202                      -6.6                45.697272   \n",
       "113               0.525095                      -2.5                32.516316   \n",
       "191              11.394114                       9.4                32.809654   \n",
       "203               2.964567                       2.3                30.023567   \n",
       "209               1.990140                       5.3                33.576050   \n",
       "228               8.535396                      17.4                33.953247   \n",
       "231               6.401411                      14.5                35.110886   \n",
       "233               8.678343                      16.7                39.969170   \n",
       "330              11.230068                      16.9                34.699482   \n",
       "367               8.225009                      14.2                53.947117   \n",
       "1212              9.290609                       3.0                32.114040   \n",
       "1677              0.637185                       3.6                34.752513   \n",
       "1780              5.592211                       5.0                30.816926   \n",
       "1787             14.282336                       8.1                42.374715   \n",
       "1790              6.581895                      10.9                33.275709   \n",
       "1794              4.567201                       2.0                32.017779   \n",
       "1798              7.240647                       5.5                30.653662   \n",
       "1835              6.320518                       1.6                34.243862   \n",
       "1856              9.237593                       1.6                35.107592   \n",
       "1873              7.833428                       0.1                46.919285   \n",
       "2642             -7.882624                      33.8                44.274093   \n",
       "2716            -21.578409                      -9.2                44.608325   \n",
       "2853              6.340145                       2.5                30.603358   \n",
       "2941             20.640370                      20.4                37.742124   \n",
       "\n",
       "      foreign_born_pct_gt_30  \n",
       "69                      True  \n",
       "113                     True  \n",
       "191                     True  \n",
       "203                     True  \n",
       "209                     True  \n",
       "228                     True  \n",
       "231                     True  \n",
       "233                     True  \n",
       "330                     True  \n",
       "367                     True  \n",
       "1212                    True  \n",
       "1677                    True  \n",
       "1780                    True  \n",
       "1787                    True  \n",
       "1790                    True  \n",
       "1794                    True  \n",
       "1798                    True  \n",
       "1835                    True  \n",
       "1856                    True  \n",
       "1873                    True  \n",
       "2642                    True  \n",
       "2716                    True  \n",
       "2853                    True  \n",
       "2941                    True  "
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "counties.query(\"foreign_born_pct_gt_30 == True\")\n",
    "# Query the DataFrame to show only counties where percent_30 is True"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "952e3ed6-acd0-438f-9d6c-3b5cd4f91cdd",
   "metadata": {
    "vscode": {
     "languageId": "quarto"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>area_sq_miles</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Autauga, AL</td>\n",
       "      <td>594.456107</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Baldwin, AL</td>\n",
       "      <td>1589.836014</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Barbour, AL</td>\n",
       "      <td>885.008019</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bibb, AL</td>\n",
       "      <td>622.469570</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Blount, AL</td>\n",
       "      <td>644.890667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3221</th>\n",
       "      <td>Vega Baja, PR</td>\n",
       "      <td>45.847734</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3222</th>\n",
       "      <td>Vieques, PR</td>\n",
       "      <td>50.788416</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3223</th>\n",
       "      <td>Villalba, PR</td>\n",
       "      <td>35.636678</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3224</th>\n",
       "      <td>Yabucoa, PR</td>\n",
       "      <td>55.214614</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3225</th>\n",
       "      <td>Yauco, PR</td>\n",
       "      <td>67.711484</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3226 rows Ã— 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             county  area_sq_miles\n",
       "0       Autauga, AL     594.456107\n",
       "1       Baldwin, AL    1589.836014\n",
       "2       Barbour, AL     885.008019\n",
       "3          Bibb, AL     622.469570\n",
       "4        Blount, AL     644.890667\n",
       "...             ...            ...\n",
       "3221  Vega Baja, PR      45.847734\n",
       "3222    Vieques, PR      50.788416\n",
       "3223   Villalba, PR      35.636678\n",
       "3224    Yabucoa, PR      55.214614\n",
       "3225      Yauco, PR      67.711484\n",
       "\n",
       "[3226 rows x 2 columns]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.options.mode.copy_on_write = True\n",
    "\n",
    "counties_mini = counties[[\"county\", \"area_sq_miles\"]]\n",
    "\n",
    "counties_mini"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c198787a-1d84-4e80-9566-376231605e1e",
   "metadata": {
    "vscode": {
     "languageId": "quarto"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0        594.46\n",
       "1       1589.84\n",
       "2        885.01\n",
       "3        622.47\n",
       "4        644.89\n",
       "         ...   \n",
       "3221      45.85\n",
       "3222      50.79\n",
       "3223      35.64\n",
       "3224      55.21\n",
       "3225      67.71\n",
       "Name: area_sq_miles, Length: 3226, dtype: float64"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.options.mode.copy_on_write = True\n",
    "\n",
    "counties_mini = counties[[\"county\", \"area_sq_miles\"]]\n",
    "\n",
    "counties_mini[\"area_sq_miles\"].round(2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8783d5d4-8e1f-4c2d-a47c-679f0a1f04a1",
   "metadata": {
    "vscode": {
     "languageId": "quarto"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>area_sq_miles</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Autauga, AL</td>\n",
       "      <td>594.46</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Baldwin, AL</td>\n",
       "      <td>1589.84</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Barbour, AL</td>\n",
       "      <td>885.01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bibb, AL</td>\n",
       "      <td>622.47</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Blount, AL</td>\n",
       "      <td>644.89</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3221</th>\n",
       "      <td>Vega Baja, PR</td>\n",
       "      <td>45.85</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3222</th>\n",
       "      <td>Vieques, PR</td>\n",
       "      <td>50.79</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3223</th>\n",
       "      <td>Villalba, PR</td>\n",
       "      <td>35.64</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3224</th>\n",
       "      <td>Yabucoa, PR</td>\n",
       "      <td>55.21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3225</th>\n",
       "      <td>Yauco, PR</td>\n",
       "      <td>67.71</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3226 rows Ã— 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             county  area_sq_miles\n",
       "0       Autauga, AL         594.46\n",
       "1       Baldwin, AL        1589.84\n",
       "2       Barbour, AL         885.01\n",
       "3          Bibb, AL         622.47\n",
       "4        Blount, AL         644.89\n",
       "...             ...            ...\n",
       "3221  Vega Baja, PR          45.85\n",
       "3222    Vieques, PR          50.79\n",
       "3223   Villalba, PR          35.64\n",
       "3224    Yabucoa, PR          55.21\n",
       "3225      Yauco, PR          67.71\n",
       "\n",
       "[3226 rows x 2 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.options.mode.copy_on_write = True\n",
    "\n",
    "counties_mini = counties[[\"county\", \"area_sq_miles\"]]\n",
    "\n",
    "counties_mini[\"area_sq_miles\"] = counties_mini[\"area_sq_miles\"].round(2)\n",
    "counties_mini"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "590e2710-8a5b-41b0-a76f-0803298e93d1",
   "metadata": {
    "vscode": {
     "languageId": "quarto"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<ipython-input-6-15fd4d8c5745>:5: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  counties_mini[\"area_sq_miles\"] = counties_mini[\"area_sq_miles\"].round(2)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>area_sq_miles</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Autauga, AL</td>\n",
       "      <td>594.46</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Baldwin, AL</td>\n",
       "      <td>1589.84</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Barbour, AL</td>\n",
       "      <td>885.01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bibb, AL</td>\n",
       "      <td>622.47</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Blount, AL</td>\n",
       "      <td>644.89</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3221</th>\n",
       "      <td>Vega Baja, PR</td>\n",
       "      <td>45.85</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3222</th>\n",
       "      <td>Vieques, PR</td>\n",
       "      <td>50.79</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3223</th>\n",
       "      <td>Villalba, PR</td>\n",
       "      <td>35.64</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3224</th>\n",
       "      <td>Yabucoa, PR</td>\n",
       "      <td>55.21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3225</th>\n",
       "      <td>Yauco, PR</td>\n",
       "      <td>67.71</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3226 rows Ã— 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             county  area_sq_miles\n",
       "0       Autauga, AL         594.46\n",
       "1       Baldwin, AL        1589.84\n",
       "2       Barbour, AL         885.01\n",
       "3          Bibb, AL         622.47\n",
       "4        Blount, AL         644.89\n",
       "...             ...            ...\n",
       "3221  Vega Baja, PR          45.85\n",
       "3222    Vieques, PR          50.79\n",
       "3223   Villalba, PR          35.64\n",
       "3224    Yabucoa, PR          55.21\n",
       "3225      Yauco, PR          67.71\n",
       "\n",
       "[3226 rows x 2 columns]"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.options.mode.copy_on_write = False\n",
    "\n",
    "counties_mini = counties[[\"county\", \"area_sq_miles\"]]\n",
    "\n",
    "counties_mini[\"area_sq_miles\"] = counties_mini[\"area_sq_miles\"].round(2)\n",
    "counties_mini"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": ".venv",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
